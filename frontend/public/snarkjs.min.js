var snarkjs=function(t){"use strict";const e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function i(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const n=i;function a(t,e){return BigInt(t)<<BigInt(e)}function o(t,e){return BigInt(t)>>BigInt(e)}const r=a,s=o;var c=Object.freeze({__proto__:null,fromString:i,e:n,fromArray:function(t,e){let i=BigInt(0);e=BigInt(e);for(let n=0;n<t.length;n++)i=i*e+BigInt(t[n]);return i},bitLength:function(t){const i=t.toString(16);return 4*(i.length-1)+e[parseInt(i[0],16)]},isNegative:function(t){return BigInt(t)<BigInt(0)},isZero:function(t){return!t},shiftLeft:a,shiftRight:o,shl:r,shr:s,isOdd:function(t){return(BigInt(t)&BigInt(1))==BigInt(1)},naf:function(t){let e=BigInt(t);const i=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));i.push(t),e-=BigInt(t)}else i.push(0);e>>=BigInt(1)}return i},bits:function(t){let e=BigInt(t);const i=[];for(;e;)e&BigInt(1)?i.push(1):i.push(0),e>>=BigInt(1);return i},toNumber:function(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)},toArray:function(t,e){const i=[];let n=BigInt(t);for(e=BigInt(e);n;)i.unshift(Number(n%e)),n/=e;return i},add:function(t,e){return BigInt(t)+BigInt(e)},sub:function(t,e){return BigInt(t)-BigInt(e)},neg:function(t){return-BigInt(t)},mul:function(t,e){return BigInt(t)*BigInt(e)},square:function(t){return BigInt(t)*BigInt(t)},pow:function(t,e){return BigInt(t)**BigInt(e)},exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:function(t,e){return BigInt(t)/BigInt(e)},mod:function(t,e){return BigInt(t)%BigInt(e)},eq:function(t,e){return BigInt(t)==BigInt(e)},neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:function(t,e){return BigInt(t)>BigInt(e)},leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:function(t,e){return BigInt(t)>=BigInt(e)},band:function(t,e){return BigInt(t)&BigInt(e)},bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)}}),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){var e={exports:{}};return t(e,e.exports),e.exports}var d=u((function(t){var e=function(t){var i=1e7,n=9007199254740992,a=f(n),o="0123456789abcdefghijklmnopqrstuvwxyz",r="function"==typeof BigInt;function s(t,e,i,n){return void 0===t?s[0]:void 0!==e&&(10!=+e||i)?j(t,e,i,n):Z(t)}function c(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function u(t){this.value=t}function d(t){return-n<t&&t<n}function f(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function h(t){g(t);var e=t.length;if(e<4&&S(t,a)<0)switch(e){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*i;default:return t[0]+(t[1]+t[2]*i)*i}return t}function g(t){for(var e=t.length;0===t[--e];);t.length=e+1}function p(t){for(var e=new Array(t),i=-1;++i<t;)e[i]=0;return e}function _(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,e){var n,a,o=t.length,r=e.length,s=new Array(o),c=0,l=i;for(a=0;a<r;a++)c=(n=t[a]+e[a]+c)>=l?1:0,s[a]=n-c*l;for(;a<o;)c=(n=t[a]+c)===l?1:0,s[a++]=n-c*l;return c>0&&s.push(c),s}function L(t,e){return t.length>=e.length?m(t,e):m(e,t)}function w(t,e){var n,a,o=t.length,r=new Array(o),s=i;for(a=0;a<o;a++)n=t[a]-s+e,e=Math.floor(n/s),r[a]=n-e*s,e+=1;for(;e>0;)r[a++]=e%s,e=Math.floor(e/s);return r}function b(t,e){var n,a,o=t.length,r=e.length,s=new Array(o),c=0,l=i;for(n=0;n<r;n++)(a=t[n]-c-e[n])<0?(a+=l,c=1):c=0,s[n]=a;for(n=r;n<o;n++){if(!((a=t[n]-c)<0)){s[n++]=a;break}a+=l,s[n]=a}for(;n<o;n++)s[n]=t[n];return g(s),s}function y(t,e,n){var a,o,r=t.length,s=new Array(r),u=-e,d=i;for(a=0;a<r;a++)o=t[a]+u,u=Math.floor(o/d),o%=d,s[a]=o<0?o+d:o;return"number"==typeof(s=h(s))?(n&&(s=-s),new l(s)):new c(s,n)}function A(t,e){var n,a,o,r,s=t.length,c=e.length,l=p(s+c),u=i;for(o=0;o<s;++o){r=t[o];for(var d=0;d<c;++d)n=r*e[d]+l[o+d],a=Math.floor(n/u),l[o+d]=n-a*u,l[o+d+1]+=a}return g(l),l}function I(t,e){var n,a,o=t.length,r=new Array(o),s=i,c=0;for(a=0;a<o;a++)n=t[a]*e+c,c=Math.floor(n/s),r[a]=n-c*s;for(;c>0;)r[a++]=c%s,c=Math.floor(c/s);return r}function C(t,e){for(var i=[];e-- >0;)i.push(0);return i.concat(t)}function v(t,e){var i=Math.max(t.length,e.length);if(i<=30)return A(t,e);i=Math.ceil(i/2);var n=t.slice(i),a=t.slice(0,i),o=e.slice(i),r=e.slice(0,i),s=v(a,r),c=v(n,o),l=v(L(a,n),L(r,o)),u=L(L(s,C(b(b(l,s),c),i)),C(c,2*i));return g(u),u}function F(t,e,n){return new c(t<i?I(e,t):A(e,f(t)),n)}function x(t){var e,n,a,o,r=t.length,s=p(r+r),c=i;for(a=0;a<r;a++){n=0-(o=t[a])*o;for(var l=a;l<r;l++)e=o*t[l]*2+s[a+l]+n,n=Math.floor(e/c),s[a+l]=e-n*c;s[a+r]=n}return g(s),s}function B(t,e){var i,n,a,o,r=t.length,s=p(r);for(a=0,i=r-1;i>=0;--i)a=(o=1e7*a+t[i])-(n=_(o/e))*e,s[i]=0|n;return[s,0|a]}function E(t,e){var n,a=Z(e);if(r)return[new u(t.value/a.value),new u(t.value%a.value)];var o,d=t.value,m=a.value;if(0===m)throw new Error("Cannot divide by zero");if(t.isSmall)return a.isSmall?[new l(_(d/m)),new l(d%m)]:[s[0],t];if(a.isSmall){if(1===m)return[t,s[0]];if(-1==m)return[t.negate(),s[0]];var L=Math.abs(m);if(L<i){o=h((n=B(d,L))[0]);var w=n[1];return t.sign&&(w=-w),"number"==typeof o?(t.sign!==a.sign&&(o=-o),[new l(o),new l(w)]):[new c(o,t.sign!==a.sign),new l(w)]}m=f(L)}var y=S(d,m);if(-1===y)return[s[0],t];if(0===y)return[s[t.sign===a.sign?1:-1],s[0]];n=d.length+m.length<=200?function(t,e){var n,a,o,r,s,c,l,u=t.length,d=e.length,f=i,g=p(e.length),_=e[d-1],m=Math.ceil(f/(2*_)),L=I(t,m),w=I(e,m);for(L.length<=u&&L.push(0),w.push(0),_=w[d-1],a=u-d;a>=0;a--){for(n=f-1,L[a+d]!==_&&(n=Math.floor((L[a+d]*f+L[a+d-1])/_)),o=0,r=0,c=w.length,s=0;s<c;s++)o+=n*w[s],l=Math.floor(o/f),r+=L[a+s]-(o-l*f),o=l,r<0?(L[a+s]=r+f,r=-1):(L[a+s]=r,r=0);for(;0!==r;){for(n-=1,o=0,s=0;s<c;s++)(o+=L[a+s]-f+w[s])<0?(L[a+s]=o+f,o=0):(L[a+s]=o,o=1);r+=o}g[a]=n}return L=B(L,m)[0],[h(g),h(L)]}(d,m):function(t,e){for(var n,a,o,r,s,c=t.length,l=e.length,u=[],d=[],f=i;c;)if(d.unshift(t[--c]),g(d),S(d,e)<0)u.push(0);else{o=d[(a=d.length)-1]*f+d[a-2],r=e[l-1]*f+e[l-2],a>l&&(o=(o+1)*f),n=Math.ceil(o/r);do{if(S(s=I(e,n),d)<=0)break;n--}while(n);u.push(n),d=b(d,s)}return u.reverse(),[h(u),h(d)]}(d,m),o=n[0];var A=t.sign!==a.sign,C=n[1],v=t.sign;return"number"==typeof o?(A&&(o=-o),o=new l(o)):o=new c(o,A),"number"==typeof C?(v&&(C=-C),C=new l(C)):C=new c(C,v),[o,C]}function S(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var i=t.length-1;i>=0;i--)if(t[i]!==e[i])return t[i]>e[i]?1:-1;return 0}function O(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function q(t,i){for(var n,a,o,r=t.prev(),s=r,c=0;s.isEven();)s=s.divide(2),c++;t:for(a=0;a<i.length;a++)if(!t.lesser(i[a])&&!(o=e(i[a]).modPow(s,t)).isUnit()&&!o.equals(r)){for(n=c-1;0!=n;n--){if((o=o.square().mod(t)).isUnit())return!1;if(o.equals(r))continue t}return!1}return!0}c.prototype=Object.create(s.prototype),l.prototype=Object.create(s.prototype),u.prototype=Object.create(s.prototype),c.prototype.add=function(t){var e=Z(t);if(this.sign!==e.sign)return this.subtract(e.negate());var i=this.value,n=e.value;return e.isSmall?new c(w(i,Math.abs(n)),this.sign):new c(L(i,n),this.sign)},c.prototype.plus=c.prototype.add,l.prototype.add=function(t){var e=Z(t),i=this.value;if(i<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(d(i+n))return new l(i+n);n=f(Math.abs(n))}return new c(w(n,Math.abs(i)),i<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(t){return new u(this.value+Z(t).value)},u.prototype.plus=u.prototype.add,c.prototype.subtract=function(t){var e=Z(t);if(this.sign!==e.sign)return this.add(e.negate());var i=this.value,n=e.value;return e.isSmall?y(i,Math.abs(n),this.sign):function(t,e,i){var n;return S(t,e)>=0?n=b(t,e):(n=b(e,t),i=!i),"number"==typeof(n=h(n))?(i&&(n=-n),new l(n)):new c(n,i)}(i,n,this.sign)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(t){var e=Z(t),i=this.value;if(i<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new l(i-n):y(n,Math.abs(i),i>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(t){return new u(this.value-Z(t).value)},u.prototype.minus=u.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},u.prototype.negate=function(){return new u(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(t){var e,n,a,o=Z(t),r=this.value,l=o.value,u=this.sign!==o.sign;if(o.isSmall){if(0===l)return s[0];if(1===l)return this;if(-1===l)return this.negate();if((e=Math.abs(l))<i)return new c(I(r,e),u);l=f(e)}return n=r.length,a=l.length,new c(-.012*n-.012*a+15e-6*n*a>0?v(r,l):A(r,l),u)},c.prototype.times=c.prototype.multiply,l.prototype._multiplyBySmall=function(t){return d(t.value*this.value)?new l(t.value*this.value):F(Math.abs(t.value),f(Math.abs(this.value)),this.sign!==t.sign)},c.prototype._multiplyBySmall=function(t){return 0===t.value?s[0]:1===t.value?this:-1===t.value?this.negate():F(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return Z(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(t){return new u(this.value*Z(t).value)},u.prototype.times=u.prototype.multiply,c.prototype.square=function(){return new c(x(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return d(t)?new l(t):new c(x(f(Math.abs(this.value))),!1)},u.prototype.square=function(t){return new u(this.value*this.value)},c.prototype.divmod=function(t){var e=E(this,t);return{quotient:e[0],remainder:e[1]}},u.prototype.divmod=l.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(t){return E(this,t)[0]},u.prototype.over=u.prototype.divide=function(t){return new u(this.value/Z(t).value)},l.prototype.over=l.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(t){return E(this,t)[1]},u.prototype.mod=u.prototype.remainder=function(t){return new u(this.value%Z(t).value)},l.prototype.remainder=l.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(t){var e,i,n,a=Z(t),o=this.value,r=a.value;if(0===r)return s[1];if(0===o)return s[0];if(1===o)return s[1];if(-1===o)return a.isEven()?s[1]:s[-1];if(a.sign)return s[0];if(!a.isSmall)throw new Error("The exponent "+a.toString()+" is too large.");if(this.isSmall&&d(e=Math.pow(o,r)))return new l(_(e));for(i=this,n=s[1];!0&r&&(n=n.times(i),--r),0!==r;)r/=2,i=i.square();return n},l.prototype.pow=c.prototype.pow,u.prototype.pow=function(t){var e=Z(t),i=this.value,n=e.value,a=BigInt(0),o=BigInt(1),r=BigInt(2);if(n===a)return s[1];if(i===a)return s[0];if(i===o)return s[1];if(i===BigInt(-1))return e.isEven()?s[1]:s[-1];if(e.isNegative())return new u(a);for(var c=this,l=s[1];(n&o)===o&&(l=l.times(c),--n),n!==a;)n/=r,c=c.square();return l},c.prototype.modPow=function(t,e){if(t=Z(t),(e=Z(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var i=s[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(s[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return s[0];t.isOdd()&&(i=i.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return i},u.prototype.modPow=l.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(t){var e=Z(t),i=this.value,n=e.value;return e.isSmall?1:S(i,n)},l.prototype.compareAbs=function(t){var e=Z(t),i=Math.abs(this.value),n=e.value;return e.isSmall?i===(n=Math.abs(n))?0:i>n?1:-1:-1},u.prototype.compareAbs=function(t){var e=this.value,i=Z(t).value;return(e=e>=0?e:-e)===(i=i>=0?i:-i)?0:e>i?1:-1},c.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Z(t),i=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:S(i,n)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Z(t),i=this.value,n=e.value;return e.isSmall?i==n?0:i>n?1:-1:i<0!==e.sign?i<0?-1:1:i<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,i=Z(t).value;return e===i?0:e>i?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.equals=function(t){return 0===this.compare(t)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(t){return 0!==this.compare(t)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(t){return this.compare(t)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(t){return this.compare(t)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,c.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},u.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(t){var e=Z(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(i){var n=O(this);if(n!==t)return n;var a=this.abs(),o=a.bitLength();if(o<=64)return q(a,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var r=Math.log(2)*o.toJSNumber(),s=Math.ceil(!0===i?2*Math.pow(r,2):r),c=[],l=0;l<s;l++)c.push(e(l+2));return q(a,c)},u.prototype.isPrime=l.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(i,n){var a=O(this);if(a!==t)return a;for(var o=this.abs(),r=i===t?5:i,s=[],c=0;c<r;c++)s.push(e.randBetween(2,o.minus(2),n));return q(o,s)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(t){for(var i,n,a,o=e.zero,r=e.one,s=Z(t),c=this.abs();!c.isZero();)i=s.divide(c),n=o,a=s,o=r,s=c,r=n.subtract(i.multiply(r)),c=a.subtract(i.multiply(c));if(!s.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},u.prototype.modInv=l.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var t=this.value;return this.sign?y(t,1,this.sign):new c(w(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<n?new l(t+1):new c(a,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},c.prototype.prev=function(){var t=this.value;return this.sign?new c(w(t,1),!0):y(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-n?new l(t-1):new c(a,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var G=[1];2*G[G.length-1]<=i;)G.push(2*G[G.length-1]);var U=G.length,z=G[U-1];function P(t){return Math.abs(t)<=i}function M(t,i,n){i=Z(i);for(var a=t.isNegative(),o=i.isNegative(),r=a?t.not():t,s=o?i.not():i,c=0,l=0,u=null,d=null,f=[];!r.isZero()||!s.isZero();)c=(u=E(r,z))[1].toJSNumber(),a&&(c=z-1-c),l=(d=E(s,z))[1].toJSNumber(),o&&(l=z-1-l),r=u[0],s=d[0],f.push(n(c,l));for(var h=0!==n(a?1:0,o?1:0)?e(-1):e(0),g=f.length-1;g>=0;g-=1)h=h.multiply(z).add(e(f[g]));return h}c.prototype.shiftLeft=function(t){var e=Z(t).toJSNumber();if(!P(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var i=this;if(i.isZero())return i;for(;e>=U;)i=i.multiply(z),e-=U-1;return i.multiply(G[e])},u.prototype.shiftLeft=l.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(t){var e,i=Z(t).toJSNumber();if(!P(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var n=this;i>=U;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=E(n,z))[1].isNegative()?e[0].prev():e[0],i-=U-1}return(e=E(n,G[i]))[1].isNegative()?e[0].prev():e[0]},u.prototype.shiftRight=l.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=c.prototype.not,c.prototype.and=function(t){return M(this,t,(function(t,e){return t&e}))},u.prototype.and=l.prototype.and=c.prototype.and,c.prototype.or=function(t){return M(this,t,(function(t,e){return t|e}))},u.prototype.or=l.prototype.or=c.prototype.or,c.prototype.xor=function(t){return M(this,t,(function(t,e){return t^e}))},u.prototype.xor=l.prototype.xor=c.prototype.xor;var Q=1<<30;function T(t){var e=t.value,n="number"==typeof e?e|Q:"bigint"==typeof e?e|BigInt(Q):e[0]+e[1]*i|1073758208;return n&-n}function R(t,i){if(i.compareTo(t)<=0){var n=R(t,i.square(i)),a=n.p,o=n.e,r=a.multiply(i);return r.compareTo(t)<=0?{p:r,e:2*o+1}:{p:a,e:2*o}}return{p:e(1),e:0}}function k(t,e){return t=Z(t),e=Z(e),t.greater(e)?t:e}function N(t,e){return t=Z(t),e=Z(e),t.lesser(e)?t:e}function D(t,e){if(t=Z(t).abs(),e=Z(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var i,n,a=s[1];t.isEven()&&e.isEven();)i=N(T(t),T(e)),t=t.divide(i),e=e.divide(i),a=a.multiply(i);for(;t.isEven();)t=t.divide(T(t));do{for(;e.isEven();)e=e.divide(T(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return a.isUnit()?t:t.multiply(a)}c.prototype.bitLength=function(){var t=this;return t.compareTo(e(0))<0&&(t=t.negate().subtract(e(1))),0===t.compareTo(e(0))?e(0):e(R(t,e(2)).e).add(e(1))},u.prototype.bitLength=l.prototype.bitLength=c.prototype.bitLength;var j=function(t,e,i,n){i=i||o,t=String(t),n||(t=t.toLowerCase(),i=i.toLowerCase());var a,r=t.length,s=Math.abs(e),c={};for(a=0;a<i.length;a++)c[i[a]]=a;for(a=0;a<r;a++){if("-"!==(d=t[a])&&(d in c&&c[d]>=s)){if("1"===d&&1===s)continue;throw new Error(d+" is not a valid digit in base "+e+".")}}e=Z(e);var l=[],u="-"===t[0];for(a=u?1:0;a<t.length;a++){var d;if((d=t[a])in c)l.push(Z(c[d]));else{if("<"!==d)throw new Error(d+" is not a valid character");var f=a;do{a++}while(">"!==t[a]&&a<t.length);l.push(Z(t.slice(f+1,a)))}}return V(l,e,u)};function V(t,e,i){var n,a=s[0],o=s[1];for(n=t.length-1;n>=0;n--)a=a.add(t[n].times(o)),o=o.times(e);return i?a.negate():a}function K(t,i){if((i=e(i)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(i.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var a=!1;if(t.isNegative()&&i.isPositive()&&(a=!0,t=t.abs()),i.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:a};for(var o,r=[],s=t;s.isNegative()||s.compareAbs(i)>=0;){o=s.divmod(i),s=o.quotient;var c=o.remainder;c.isNegative()&&(c=i.minus(c).abs(),s=s.next()),r.push(c.toJSNumber())}return r.push(s.toJSNumber()),{value:r.reverse(),isNegative:a}}function $(t,e,i){var n=K(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||o).length?e[t]:"<"+t+">"}(t,i)})).join("")}function H(t){if(d(+t)){var e=+t;if(e===_(e))return r?new u(BigInt(e)):new l(e);throw new Error("Invalid integer: "+t)}var i="-"===t[0];i&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var a=n[1];if("+"===a[0]&&(a=a.slice(1)),(a=+a)!==_(a)||!d(a))throw new Error("Invalid integer: "+a+" is not a valid exponent.");var o=n[0],s=o.indexOf(".");if(s>=0&&(a-=o.length-s-1,o=o.slice(0,s)+o.slice(s+1)),a<0)throw new Error("Cannot include negative exponent part for integers");t=o+=new Array(a+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(r)return new u(BigInt(i?"-"+t:t));for(var f=[],h=t.length,p=h-7;h>0;)f.push(+t.slice(p,h)),(p-=7)<0&&(p=0),h-=7;return g(f),new c(f,i)}function Z(t){return"number"==typeof t?function(t){if(r)return new u(BigInt(t));if(d(t)){if(t!==_(t))throw new Error(t+" is not an integer.");return new l(t)}return H(t.toString())}(t):"string"==typeof t?H(t):"bigint"==typeof t?new u(t):t}c.prototype.toArray=function(t){return K(this,t)},l.prototype.toArray=function(t){return K(this,t)},u.prototype.toArray=function(t){return K(this,t)},c.prototype.toString=function(e,i){if(e===t&&(e=10),10!==e)return $(this,e,i);for(var n,a=this.value,o=a.length,r=String(a[--o]);--o>=0;)n=String(a[o]),r+="0000000".slice(n.length)+n;return(this.sign?"-":"")+r},l.prototype.toString=function(e,i){return e===t&&(e=10),10!=e?$(this,e,i):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=c.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var J=0;J<1e3;J++)s[J]=Z(J),J>0&&(s[-J]=Z(-J));return s.one=s[1],s.zero=s[0],s.minusOne=s[-1],s.max=k,s.min=N,s.gcd=D,s.lcm=function(t,e){return t=Z(t).abs(),e=Z(e).abs(),t.divide(D(t,e)).multiply(e)},s.isInstance=function(t){return t instanceof c||t instanceof l||t instanceof u},s.randBetween=function(t,e,n){t=Z(t),e=Z(e);var a=n||Math.random,o=N(t,e),r=k(t,e).subtract(o).add(1);if(r.isSmall)return o.add(Math.floor(a()*r));for(var c=K(r,i).value,l=[],u=!0,d=0;d<c.length;d++){var f=u?c[d]+(d+1<c.length?c[d+1]/i:0):i,h=_(a()*f);l.push(h),h<c[d]&&(u=!1)}return o.add(s.fromArray(l,i,!1))},s.fromArray=function(t,e,i){return V(t.map(Z),Z(e||10),i)},s}();t.hasOwnProperty("exports")&&(t.exports=e)}));function f(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?d(t.slice(2),16):d(t,e)}const h=f;function g(t,e){return d(t).shiftLeft(e)}function p(t,e){return d(t).shiftRight(e)}const _=g,m=p;var L=Object.freeze({__proto__:null,fromString:f,e:h,fromArray:function(t,e){return d.fromArray(t,e)},bitLength:function(t){return d(t).bitLength()},isNegative:function(t){return d(t).isNegative()},isZero:function(t){return d(t).isZero()},shiftLeft:g,shiftRight:p,shl:_,shr:m,isOdd:function(t){return d(t).isOdd()},naf:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();i.push(t),e=e.minus(t)}else i.push(0);e=e.shiftRight(1)}return i},bits:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);)e.isOdd()?i.push(1):i.push(0),e=e.shiftRight(1);return i},toNumber:function(t){if(!t.lt(d("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()},toArray:function(t,e){return d(t).toArray(e)},add:function(t,e){return d(t).add(d(e))},sub:function(t,e){return d(t).minus(d(e))},neg:function(t){return d.zero.minus(d(t))},mul:function(t,e){return d(t).times(d(e))},square:function(t){return d(t).square()},pow:function(t,e){return d(t).pow(d(e))},exp:function(t,e){return d(t).pow(d(e))},abs:function(t){return d(t).abs()},div:function(t,e){return d(t).divide(d(e))},mod:function(t,e){return d(t).mod(d(e))},eq:function(t,e){return d(t).eq(d(e))},neq:function(t,e){return d(t).neq(d(e))},lt:function(t,e){return d(t).lt(d(e))},gt:function(t,e){return d(t).gt(d(e))},leq:function(t,e){return d(t).leq(d(e))},geq:function(t,e){return d(t).geq(d(e))},band:function(t,e){return d(t).and(d(e))},bor:function(t,e){return d(t).or(d(e))},bxor:function(t,e){return d(t).xor(d(e))},land:function(t,e){return!d(t).isZero()&&!d(e).isZero()},lor:function(t,e){return!d(t).isZero()||!d(e).isZero()},lnot:function(t){return d(t).isZero()}});const w="function"==typeof BigInt;let b={};w?Object.assign(b,c):Object.assign(b,L),b.toRprLE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new Uint32Array(t.buffer,e,n/4),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o[t]=parseInt(a.substring(a.length-8*t-8,a.length-8*t),16);for(let t=r;t<o.length;t++)o[t]=0;for(let e=4*o.length;e<n;e++)t[e]=b.toNumber(b.band(b.shiftRight(i,8*e),255))},b.toRprBE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new DataView(t.buffer,t.byteOffset+e,n),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o.setUint32(n-4*t-4,parseInt(a.substring(a.length-8*t-8,a.length-8*t),16),!1);for(let t=0;t<n/4-r;t++)o[t]=0},b.fromRprLE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new Uint32Array(t.buffer,e,i/4),a=new Array(i/4);return n.forEach(((t,e)=>a[a.length-e-1]=t.toString(16).padStart(8,"0"))),b.fromString(a.join(""),16)},b.fromRprBE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new DataView(t.buffer,t.byteOffset+e,i),a=new Array(i/4);for(let t=0;t<i/4;t++)a[t]=n.getUint32(4*t,!1).toString(16).padStart(8,"0");return b.fromString(a.join(""),16)},b.toString=function(t,e){return t.toString(e)},b.toLEBuff=function(t){const e=new Uint8Array(Math.floor((b.bitLength(t)-1)/8)+1);return b.toRprLE(e,0,t,e.byteLength),e},b.zero=b.e(0),b.one=b.e(1);let{toRprLE:y,toRprBE:A,fromRprLE:I,fromRprBE:C,toString:v,toLEBuff:F,zero:x,one:B,fromString:E,e:S,fromArray:O,bitLength:q,isNegative:G,isZero:U,shiftLeft:z,shiftRight:P,shl:M,shr:Q,isOdd:T,naf:R,bits:k,toNumber:N,toArray:D,add:j,sub:V,neg:K,mul:$,square:H,pow:Z,exp:J,abs:Y,div:W,mod:X,eq:tt,neq:et,lt:it,gt:nt,leq:at,geq:ot,band:rt,bor:st,bxor:ct,land:lt,lor:ut,lnot:dt}=b;var ft=Object.freeze({__proto__:null,toRprLE:y,toRprBE:A,fromRprLE:I,fromRprBE:C,toString:v,toLEBuff:F,zero:x,one:B,fromString:E,e:S,fromArray:O,bitLength:q,isNegative:G,isZero:U,shiftLeft:z,shiftRight:P,shl:M,shr:Q,isOdd:T,naf:R,bits:k,toNumber:N,toArray:D,add:j,sub:V,neg:K,mul:$,square:H,pow:Z,exp:J,abs:Y,div:W,mod:X,eq:tt,neq:et,lt:it,gt:nt,leq:at,geq:ot,band:rt,bor:st,bxor:ct,land:lt,lor:ut,lnot:dt});function ht(t,e,i){if(U(i))return t.one;const n=k(i);if(0==n.length)return t.one;let a=e;for(let i=n.length-2;i>=0;i--)a=t.square(a),n[i]&&(a=t.mul(a,e));return a}function gt(t){if(t.m%2==1)if(tt(X(t.p,4),1))if(tt(X(t.p,8),1))if(tt(X(t.p,16),1))!function(t){t.sqrt_q=Z(t.p,t.m),t.sqrt_s=0,t.sqrt_t=V(t.sqrt_q,1);for(;!T(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=W(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const i=t.random();t.sqrt_z=t.pow(i,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=W(V(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let i=e.pow(t,e.sqrt_tm1d2);const n=e.pow(e.mul(e.square(i),t),2**(e.sqrt_s-1));if(e.eq(n,e.negone))return null;let a=e.sqrt_s,o=e.mul(t,i),r=e.mul(o,i),s=e.sqrt_z;for(;!e.eq(r,e.one);){let t=e.square(r),n=1;for(;!e.eq(t,e.one);)t=e.square(t),n++;i=s;for(let t=0;t<a-n-1;t++)i=e.square(i);s=e.square(i),r=e.mul(r,s),o=e.mul(o,i),a=n}return e.geq(o,e.zero)?o:e.neg(o)}}(t);else{if(!tt(X(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!tt(X(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else tt(X(t.p,4),3)&&function(t){t.sqrt_q=Z(t.p,t.m),t.sqrt_e1=W(V(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const i=this.pow(e,this.sqrt_e1),n=this.mul(this.square(i),e);if(this.eq(n,this.negone))return null;const a=this.mul(i,e);return t.geq(a,t.zero)?a:t.neg(a)}}(t);else{const e=X(Z(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=Z(t.p,t.m/2),t.sqrt_e34=W(V(t.sqrt_q,3),4),t.sqrt_e12=W(V(t.sqrt_q,1),2),t.frobenius=function(e,i){return e%2==1?t.conjugate(i):i},t.sqrt=function(t){const e=this,i=e.pow(t,e.sqrt_e34),n=e.mul(e.square(i),t),a=e.mul(e.frobenius(1,n),n);if(e.eq(a,e.negone))return null;const o=e.mul(i,t);let r;if(e.eq(n,e.negone))r=e.mul(o,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,n),e.sqrt_e12);r=e.mul(t,o)}return e.geq(r,e.zero)?r:e.neg(r)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function pt(t,e,i,n,a){t[e]=t[e]+t[i]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<16|t[a]>>>16&65535)>>>0,t[n]=t[n]+t[a]>>>0,t[i]=(t[i]^t[n])>>>0,t[i]=(t[i]<<12|t[i]>>>20&4095)>>>0,t[e]=t[e]+t[i]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<8|t[a]>>>24&255)>>>0,t[n]=t[n]+t[a]>>>0,t[i]=(t[i]^t[n])>>>0,t[i]=(t[i]<<7|t[i]>>>25&127)>>>0}class _t{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return j($(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++)pt(t=this.buff,0,4,8,12),pt(t,1,5,9,13),pt(t,2,6,10,14),pt(t,3,7,11,15),pt(t,0,5,10,15),pt(t,1,6,11,12),pt(t,2,7,8,13),pt(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var mt={};function Lt(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let i=0;i<t;i++)e[i]=4294967296*Math.random()>>>0;return e}let wt=null;function bt(){return wt||(wt=new _t(function(){const t=Lt(32),e=new Uint32Array(t.buffer),i=[];for(let t=0;t<8;t++)i.push(e[t]);return i}()),wt)}class yt{constructor(t,e,i){this.F=e,this.G=t,this.opMulGF=i;let n=e.sqrt_t||e.t,a=e.sqrt_s||e.s,o=e.one;for(;e.eq(e.pow(o,e.half),e.one);)o=e.add(o,e.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,n),this.wi[a]=this.F.inv(this.w[a]);let r=a-1;for(;r>=0;)this.w[r]=this.F.square(this.w[r+1]),this.wi[r]=this.F.square(this.wi[r+1]),r--;this.roots=[],this._setRoots(Math.min(a,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one;const i=1<<e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=n}}fft(t){if(t.length<=1)return t;const e=At(t.length-1)+1;this._setRoots(e);const i=1<<e;if(t.length!=i)throw new Error("Size must be multiple of 2");return It(this,t,e,0,1)}ifft(t){if(t.length<=1)return t;const e=At(t.length-1)+1;this._setRoots(e);const i=1<<e;if(t.length!=i)throw new Error("Size must be multiple of 2");const n=It(this,t,e,0,1),a=this.F.inv(this.F.mulScalar(this.F.one,i)),o=new Array(i);for(let t=0;t<i;t++)o[t]=this.opMulGF(n[(i-t)%i],a);return o}}function At(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function It(t,e,i,n,a){const o=1<<i;if(1==o)return[e[n]];if(2==o)return[t.G.add(e[n],e[n+a]),t.G.sub(e[n],e[n+a])];const r=o>>1,s=It(t,e,i-1,n,2*a),c=It(t,e,i-1,n+a,2*a),l=new Array(o);for(let e=0;e<r;e++)l[e]=t.G.add(s[e],t.opMulGF(c[e],t.roots[i][e])),l[e+r]=t.G.sub(s[e],t.opMulGF(c[e],t.roots[i][e]));return l}var Ct=Object.freeze({__proto__:null,default:yt});class vt{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=q(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let i=this.pow(this.nqr,e);for(;!this.eq(i,this.negone);)this.nqr=this.nqr+this.one,i=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),gt(this),this.FFT=new yt(this,this,this.mul.bind(this)),this.shift=this.square(this.nqr)}e(t,e){let i;if(e?16==e&&(i=BigInt("0x"+t)):i=BigInt(t),i<0){let t=-i;return t>=this.p&&(t%=this.p),this.p-t}return i>=this.p?i%this.p:i}add(t,e){const i=t+e;return i>=this.p?i-this.p:i}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,i=this.p,n=this.one,a=t%this.p;for(;a;){let t=i/a;[e,n]=[n,e-t*n],[i,a]=[a,i-t*a]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return ht(this,t,e)}exp(t,e){return ht(this,t,e)}band(t,e){const i=t&e&this.mask;return i>=this.p?i-this.p:i}bor(t,e){const i=(t|e)&this.mask;return i>=this.p?i-this.p:i}bxor(t,e){const i=(t^e)&this.mask;return i>=this.p?i-this.p:i}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const i=t<<e&this.mask;return i>=this.p?i-this.p:i}{const i=this.p-e;return Number(i)<this.bitLength?t>>i:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const i=this.p-e;if(Number(i)<this.bitLength){const e=t<<i&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,i=this.nqr_to_t,n=this.pow(t,this.t),a=this.pow(t,this.add(this.t,this.one)>>this.one);for(;n!=this.one;){let t=this.square(n),o=1;for(;t!=this.one;)o++,t=this.square(t);let r=i;for(let t=0;t<e-o-1;t++)r=this.square(r);e=o,i=this.square(r),n=this.mul(n,i),a=this.mul(a,r)}return a>this.p>>this.one&&(a=this.neg(a)),a}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let i=0;i<t;i++)e=(e<<BigInt(8))+BigInt(Lt(1)[0]);return e%this.p}toString(t,e){let i;if(e=e||10,t>this.half&&10==e){i="-"+(this.p-t).toString(e)}else i=t.toString(e);return i}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let i=0;i<this.n64;i++)e+=t.nextU64()<<BigInt(64*i);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}}class Ft{constructor(t){this.type="F1",this.one=d.one,this.zero=d.zero,this.p=d(t),this.m=1,this.negone=this.p.minus(d.one),this.two=d(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=d.one.shiftLeft(this.bitLength).minus(d.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=d.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);const e=this.negone.shiftRight(this.one);this.nqr=this.two;let i=this.pow(this.nqr,e);for(;!i.equals(this.negone);)this.nqr=this.nqr.add(this.one),i=this.pow(this.nqr,e);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),gt(this),this.FFT=new Ct(this,this,this.mul.bind(this)),this.shift=this.square(this.nqr)}e(t,e){const i=d(t,e);return this.normalize(i)}add(t,e){let i=t.add(e);return i.geq(this.p)&&(i=i.minus(this.p)),i}sub(t,e){return t.geq(e)?t.minus(e):this.p.minus(e.minus(t))}neg(t){return t.isZero()?t:this.p.minus(t)}mul(t,e){return t.times(e).mod(this.p)}mulScalar(t,e){return t.times(d(e)).mod(this.p)}square(t){return t.square().mod(this.p)}eq(t,e){return t.eq(e)}neq(t,e){return t.neq(e)}lt(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.lt(n)}gt(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.gt(n)}leq(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.leq(n)}geq(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.geq(n)}div(t,e){if(e.isZero())throw new Error("Division by zero");return t.times(e.modInv(this.p)).mod(this.p)}idiv(t,e){if(e.isZero())throw new Error("Division by zero");return t.divide(e)}inv(t){if(t.isZero())throw new Error("Division by zero");return t.modInv(this.p)}mod(t,e){return t.mod(e)}pow(t,e){return t.modPow(e,this.p)}exp(t,e){return t.modPow(e,this.p)}band(t,e){return t.and(e).and(this.mask).mod(this.p)}bor(t,e){return t.or(e).and(this.mask).mod(this.p)}bxor(t,e){return t.xor(e).and(this.mask).mod(this.p)}bnot(t){return t.xor(this.mask).mod(this.p)}shl(t,e){if(e.lt(this.bitLength))return t.shiftLeft(e).and(this.mask).mod(this.p);{const i=this.p.minus(e);return i.lt(this.bitLength)?this.shr(t,i):d.zero}}shr(t,e){if(e.lt(this.bitLength))return t.shiftRight(e);{const i=this.p.minus(e);return i.lt(this.bitLength)?this.shl(t,i):d.zero}}land(t,e){return t.isZero()||e.isZero()?d.zero:d.one}lor(t,e){return t.isZero()&&e.isZero()?d.zero:d.one}lnot(t){return t.isZero()?d.one:d.zero}sqrt_old(t){if(t.equals(this.zero))return this.zero;if(!this.pow(t,this.negone.shiftRight(this.one)).equals(this.one))return null;let e=parseInt(this.s),i=this.nqr_to_t,n=this.pow(t,this.t),a=this.pow(t,this.add(this.t,this.one).shiftRight(this.one));for(;!n.equals(this.one);){let t=this.square(n),o=1;for(;!t.equals(this.one);)o++,t=this.square(t);let r=i;for(let t=0;t<e-o-1;t++)r=this.square(r);e=o,i=this.square(r),n=this.mul(n,i),a=this.mul(a,r)}return a.greater(this.p.shiftRight(this.one))&&(a=this.neg(a)),a}normalize(t){return(t=d(t)).isNegative()?this.p.minus(t.abs().mod(this.p)):t.mod(this.p)}random(){let t=d(0),e=d(this.p.square());for(;!e.isZero();)t=t.shiftLeft(8).add(d(Lt(1)[0])),e=e.shiftRight(8);return t.mod(this.p)}toString(t,e){let i;if(e=e||10,t.lesserOrEquals(this.p.shiftRight(d(1)))||10!=e)i=t.toString(e);else{i="-"+this.p.minus(t).toString(e)}return i}isZero(t){return t.isZero()}fromRng(t){let e;do{e=d(0);for(let i=0;i<this.n64;i++)e=e.add(e,t.nextU64().shiftLeft(64*i));e=e.and(this.mask)}while(e.geq(this.p));return e=e.times(this.Ri).mod(this.q),e}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}}const xt="function"==typeof BigInt;let Bt;Bt=xt?vt:Ft;class Et extends Bt{toRprLE(t,e,i){y(t,e,i,8*this.n64)}toRprBE(t,e,i){A(t,e,i,8*this.n64)}toRprBEM(t,e,i){return this.toRprBE(t,e,this.mul(this.R,i))}toRprLEM(t,e,i){return this.toRprLE(t,e,this.mul(this.R,i))}fromRprLE(t,e){return I(t,e,this.n8)}fromRprBE(t,e){return C(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}var St=function(t,e){const i=Array(e);let n=d(t);for(let t=0;t<e;t++)i[t]=n.and(255).toJSNumber(),n=n.shiftRight(8);return i},Ot=function(t,e,i){const n=i||"int";if(t.modules[n])return n;t.modules[n]={};const a=2*e,o=8*e;return t.alloc(o,St(1,o)),function(){const i=t.addFunction(n+"_copy");i.addParam("px","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder();for(let t=0;t<e;t++)i.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_load(a.getLocal("px"),8*t)))}(),function(){const i=t.addFunction(n+"_zero");i.addParam("pr","i32");const a=i.getCodeBuilder();for(let t=0;t<e;t++)i.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_const(0)))}(),function(){const i=t.addFunction(n+"_isZero");i.addParam("px","i32"),i.setReturnType("i32");const a=i.getCodeBuilder();i.addCode(function t(e){return 0==e?a.ret(a.i64_eqz(a.i64_load(a.getLocal("px")))):a.if(a.i64_eqz(a.i64_load(a.getLocal("px"),8*e)),t(e-1),a.ret(a.i32_const(0)))}(e-1)),i.addCode(a.ret(a.i32_const(0)))}(),function(){const i=t.addFunction(n+"_one");i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.i64_store(a.getLocal("pr"),0,a.i64_const(1)));for(let t=1;t<e;t++)i.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_const(0)))}(),function(){const i=t.addFunction(n+"_eq");i.addParam("px","i32"),i.addParam("py","i32"),i.setReturnType("i32");const a=i.getCodeBuilder();i.addCode(function t(e){return 0==e?a.ret(a.i64_eq(a.i64_load(a.getLocal("px")),a.i64_load(a.getLocal("py")))):a.if(a.i64_eq(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),t(e-1),a.ret(a.i32_const(0)))}(e-1)),i.addCode(a.ret(a.i32_const(0)))}(),function(){const i=t.addFunction(n+"_gte");i.addParam("px","i32"),i.addParam("py","i32"),i.setReturnType("i32");const a=i.getCodeBuilder();i.addCode(function t(e){return 0==e?a.ret(a.i64_ge_u(a.i64_load(a.getLocal("px")),a.i64_load(a.getLocal("py")))):a.if(a.i64_lt_u(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),a.ret(a.i32_const(0)),a.if(a.i64_gt_u(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),a.ret(a.i32_const(1)),t(e-1)))}(e-1)),i.addCode(a.ret(a.i32_const(0)))}(),function(){const e=t.addFunction(n+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const i=e.getCodeBuilder();e.addCode(i.setLocal("c",i.i64_add(i.i64_load32_u(i.getLocal("x")),i.i64_load32_u(i.getLocal("y"))))),e.addCode(i.i64_store32(i.getLocal("r"),i.getLocal("c")));for(let t=1;t<a;t++)e.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("x"),4*t),i.i64_load32_u(i.getLocal("y"),4*t)),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))),e.addCode(i.i64_store32(i.getLocal("r"),4*t,i.getLocal("c")));e.addCode(i.i32_wrap_i64(i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}(),function(){const e=t.addFunction(n+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const i=e.getCodeBuilder();e.addCode(i.setLocal("c",i.i64_sub(i.i64_load32_u(i.getLocal("x")),i.i64_load32_u(i.getLocal("y"))))),e.addCode(i.i64_store32(i.getLocal("r"),i.i64_and(i.getLocal("c"),i.i64_const("0xFFFFFFFF"))));for(let t=1;t<a;t++)e.addCode(i.setLocal("c",i.i64_add(i.i64_sub(i.i64_load32_u(i.getLocal("x"),4*t),i.i64_load32_u(i.getLocal("y"),4*t)),i.i64_shr_s(i.getLocal("c"),i.i64_const(32))))),e.addCode(i.i64_store32(i.getLocal("r"),4*t,i.i64_and(i.getLocal("c"),i.i64_const("0xFFFFFFFF"))));e.addCode(i.i32_wrap_i64(i.i64_shr_s(i.getLocal("c"),i.i64_const(32))))}(),function(){const e=t.addFunction(n+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64");for(let t=0;t<a;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64");const i=e.getCodeBuilder(),o=[],r=[];function s(t,e){let n,a;return o[t]?n=i.getLocal("x"+t):(n=i.teeLocal("x"+t,i.i64_load32_u(i.getLocal("x"),4*t)),o[t]=!0),r[e]?a=i.getLocal("y"+e):(a=i.teeLocal("y"+e,i.i64_load32_u(i.getLocal("y"),4*e)),r[e]=!0),i.i64_mul(n,a)}let c="c0",l="c1";for(let t=0;t<2*a-1;t++){for(let n=Math.max(0,t-a+1);n<=t&&n<a;n++){const a=t-n;e.addCode(i.setLocal(c,i.i64_add(i.i64_and(i.getLocal(c),i.i64_const(4294967295)),s(n,a)))),e.addCode(i.setLocal(l,i.i64_add(i.getLocal(l),i.i64_shr_u(i.getLocal(c),i.i64_const(32)))))}e.addCode(i.i64_store32(i.getLocal("r"),4*t,i.getLocal(c))),[c,l]=[l,c],e.addCode(i.setLocal(l,i.i64_shr_u(i.getLocal(c),i.i64_const(32))))}e.addCode(i.i64_store32(i.getLocal("r"),4*a*2-4,i.getLocal(c)))}(),function(){const e=t.addFunction(n+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64");for(let t=0;t<a;t++)e.addLocal("x"+t,"i64");const i=e.getCodeBuilder(),o=[];function r(t,e){let n,a;return o[t]?n=i.getLocal("x"+t):(n=i.teeLocal("x"+t,i.i64_load32_u(i.getLocal("x"),4*t)),o[t]=!0),o[e]?a=i.getLocal("x"+e):(a=i.teeLocal("x"+e,i.i64_load32_u(i.getLocal("x"),4*e)),o[e]=!0),i.i64_mul(n,a)}let s="c0",c="c1",l="c0_old",u="c1_old";for(let t=0;t<2*a-1;t++){e.addCode(i.setLocal(s,i.i64_const(0)),i.setLocal(c,i.i64_const(0)));for(let n=Math.max(0,t-a+1);n<t+1>>1&&n<a;n++){const a=t-n;e.addCode(i.setLocal(s,i.i64_add(i.i64_and(i.getLocal(s),i.i64_const(4294967295)),r(n,a)))),e.addCode(i.setLocal(c,i.i64_add(i.getLocal(c),i.i64_shr_u(i.getLocal(s),i.i64_const(32)))))}e.addCode(i.setLocal(s,i.i64_shl(i.i64_and(i.getLocal(s),i.i64_const(4294967295)),i.i64_const(1)))),e.addCode(i.setLocal(c,i.i64_add(i.i64_shl(i.getLocal(c),i.i64_const(1)),i.i64_shr_u(i.getLocal(s),i.i64_const(32))))),t%2==0&&(e.addCode(i.setLocal(s,i.i64_add(i.i64_and(i.getLocal(s),i.i64_const(4294967295)),r(t>>1,t>>1)))),e.addCode(i.setLocal(c,i.i64_add(i.getLocal(c),i.i64_shr_u(i.getLocal(s),i.i64_const(32)))))),t>0&&(e.addCode(i.setLocal(s,i.i64_add(i.i64_and(i.getLocal(s),i.i64_const(4294967295)),i.i64_and(i.getLocal(l),i.i64_const(4294967295))))),e.addCode(i.setLocal(c,i.i64_add(i.i64_add(i.getLocal(c),i.i64_shr_u(i.getLocal(s),i.i64_const(32))),i.getLocal(u))))),e.addCode(i.i64_store32(i.getLocal("r"),4*t,i.getLocal(s))),e.addCode(i.setLocal(l,i.getLocal(c)),i.setLocal(u,i.i64_shr_u(i.getLocal(l),i.i64_const(32))))}e.addCode(i.i64_store32(i.getLocal("r"),4*a*2-4,i.getLocal(l)))}(),function(){const e=t.addFunction(n+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(n+"_mul",i.getLocal("x"),i.getLocal("x"),i.getLocal("r")))}(),function(){!function(){const e=t.addFunction(n+"__mul1");e.addParam("px","i32"),e.addParam("y","i64"),e.addParam("pr","i32"),e.addLocal("c","i64");const i=e.getCodeBuilder();e.addCode(i.setLocal("c",i.i64_mul(i.i64_load32_u(i.getLocal("px"),0,0),i.getLocal("y")))),e.addCode(i.i64_store32(i.getLocal("pr"),0,0,i.getLocal("c")));for(let t=1;t<a;t++)e.addCode(i.setLocal("c",i.i64_add(i.i64_mul(i.i64_load32_u(i.getLocal("px"),4*t,0),i.getLocal("y")),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))),e.addCode(i.i64_store32(i.getLocal("pr"),4*t,0,i.getLocal("c")))}(),function(){const e=t.addFunction(n+"__add1");e.addParam("x","i32"),e.addParam("y","i64"),e.addLocal("c","i64"),e.addLocal("px","i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("px",i.getLocal("x"))),e.addCode(i.setLocal("c",i.i64_add(i.i64_load32_u(i.getLocal("px"),0,0),i.getLocal("y")))),e.addCode(i.i64_store32(i.getLocal("px"),0,0,i.getLocal("c"))),e.addCode(i.setLocal("c",i.i64_shr_u(i.getLocal("c"),i.i64_const(32)))),e.addCode(i.block(i.loop(i.br_if(1,i.i64_eqz(i.getLocal("c"))),i.setLocal("px",i.i32_add(i.getLocal("px"),i.i32_const(4))),i.setLocal("c",i.i64_add(i.i64_load32_u(i.getLocal("px"),0,0),i.getLocal("c"))),i.i64_store32(i.getLocal("px"),0,0,i.getLocal("c")),i.setLocal("c",i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.br(0))))}();const e=t.addFunction(n+"_div");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("c","i32"),e.addParam("r","i32"),e.addLocal("rr","i32"),e.addLocal("cc","i32"),e.addLocal("eX","i32"),e.addLocal("eY","i32"),e.addLocal("sy","i64"),e.addLocal("sx","i64"),e.addLocal("ec","i32");const i=e.getCodeBuilder(),r=i.i32_const(t.alloc(o)),s=i.i32_const(t.alloc(o)),c=i.i32_const(t.alloc(o)),l=i.getLocal("cc"),u=i.getLocal("rr"),d=t.alloc(2*o),f=i.i32_const(d),h=i.i32_const(d+o);e.addCode(i.if(i.getLocal("c"),i.setLocal("cc",i.getLocal("c")),i.setLocal("cc",s))),e.addCode(i.if(i.getLocal("r"),i.setLocal("rr",i.getLocal("r")),i.setLocal("rr",c))),e.addCode(i.call(n+"_copy",i.getLocal("x"),u)),e.addCode(i.call(n+"_copy",i.getLocal("y"),r)),e.addCode(i.call(n+"_zero",l)),e.addCode(i.call(n+"_zero",f)),e.addCode(i.setLocal("eX",i.i32_const(o-1))),e.addCode(i.setLocal("eY",i.i32_const(o-1))),e.addCode(i.block(i.loop(i.br_if(1,i.i32_or(i.i32_load8_u(i.i32_add(r,i.getLocal("eY")),0,0),i.i32_eq(i.getLocal("eY"),i.i32_const(3)))),i.setLocal("eY",i.i32_sub(i.getLocal("eY"),i.i32_const(1))),i.br(0)))),e.addCode(i.setLocal("sy",i.i64_add(i.i64_load32_u(i.i32_sub(i.i32_add(r,i.getLocal("eY")),i.i32_const(3)),0,0),i.i64_const(1)))),e.addCode(i.if(i.i64_eq(i.getLocal("sy"),i.i64_const(1)),i.drop(i.i64_div_u(i.i64_const(0),i.i64_const(0))))),e.addCode(i.block(i.loop(i.block(i.loop(i.br_if(1,i.i32_or(i.i32_load8_u(i.i32_add(u,i.getLocal("eX")),0,0),i.i32_eq(i.getLocal("eX"),i.i32_const(7)))),i.setLocal("eX",i.i32_sub(i.getLocal("eX"),i.i32_const(1))),i.br(0))),i.setLocal("sx",i.i64_load(i.i32_sub(i.i32_add(u,i.getLocal("eX")),i.i32_const(7)),0,0)),i.setLocal("sx",i.i64_div_u(i.getLocal("sx"),i.getLocal("sy"))),i.setLocal("ec",i.i32_sub(i.i32_sub(i.getLocal("eX"),i.getLocal("eY")),i.i32_const(4))),i.block(i.loop(i.br_if(1,i.i32_and(i.i64_eqz(i.i64_and(i.getLocal("sx"),i.i64_const("0xFFFFFFFF00000000"))),i.i32_ge_s(i.getLocal("ec"),i.i32_const(0)))),i.setLocal("sx",i.i64_shr_u(i.getLocal("sx"),i.i64_const(8))),i.setLocal("ec",i.i32_add(i.getLocal("ec"),i.i32_const(1))),i.br(0))),i.if(i.i64_eqz(i.getLocal("sx")),[...i.br_if(2,i.i32_eqz(i.call(n+"_gte",u,r))),...i.setLocal("sx",i.i64_const(1)),...i.setLocal("ec",i.i32_const(0))]),i.call(n+"__mul1",r,i.getLocal("sx"),h),i.drop(i.call(n+"_sub",u,i.i32_sub(h,i.getLocal("ec")),u)),i.call(n+"__add1",i.i32_add(l,i.getLocal("ec")),i.getLocal("sx")),i.br(0))))}(),function(){const e=t.addFunction(n+"_inverseMod");e.addParam("px","i32"),e.addParam("pm","i32"),e.addParam("pr","i32"),e.addLocal("t","i32"),e.addLocal("newt","i32"),e.addLocal("r","i32"),e.addLocal("qq","i32"),e.addLocal("qr","i32"),e.addLocal("newr","i32"),e.addLocal("swp","i32"),e.addLocal("x","i32"),e.addLocal("signt","i32"),e.addLocal("signnewt","i32"),e.addLocal("signx","i32");const i=e.getCodeBuilder(),a=i.i32_const(t.alloc(o)),r=i.i32_const(t.alloc(o)),s=i.i32_const(t.alloc(o)),c=i.i32_const(t.alloc(o)),l=i.i32_const(t.alloc(o)),u=i.i32_const(t.alloc(o)),d=i.i32_const(t.alloc(2*o)),f=i.i32_const(t.alloc(o));e.addCode(i.setLocal("t",a),i.call(n+"_zero",a),i.setLocal("signt",i.i32_const(0))),e.addCode(i.setLocal("r",r),i.call(n+"_copy",i.getLocal("pm"),r)),e.addCode(i.setLocal("newt",s),i.call(n+"_one",s),i.setLocal("signnewt",i.i32_const(0))),e.addCode(i.setLocal("newr",c),i.call(n+"_copy",i.getLocal("px"),c)),e.addCode(i.setLocal("qq",l)),e.addCode(i.setLocal("qr",u)),e.addCode(i.setLocal("x",f)),e.addCode(i.block(i.loop(i.br_if(1,i.call(n+"_isZero",i.getLocal("newr"))),i.call(n+"_div",i.getLocal("r"),i.getLocal("newr"),i.getLocal("qq"),i.getLocal("qr")),i.call(n+"_mul",i.getLocal("qq"),i.getLocal("newt"),d),i.if(i.getLocal("signt"),i.if(i.getLocal("signnewt"),i.if(i.call(n+"_gte",d,i.getLocal("t")),[...i.drop(i.call(n+"_sub",d,i.getLocal("t"),i.getLocal("x"))),...i.setLocal("signx",i.i32_const(0))],[...i.drop(i.call(n+"_sub",i.getLocal("t"),d,i.getLocal("x"))),...i.setLocal("signx",i.i32_const(1))]),[...i.drop(i.call(n+"_add",d,i.getLocal("t"),i.getLocal("x"))),...i.setLocal("signx",i.i32_const(1))]),i.if(i.getLocal("signnewt"),[...i.drop(i.call(n+"_add",d,i.getLocal("t"),i.getLocal("x"))),...i.setLocal("signx",i.i32_const(0))],i.if(i.call(n+"_gte",i.getLocal("t"),d),[...i.drop(i.call(n+"_sub",i.getLocal("t"),d,i.getLocal("x"))),...i.setLocal("signx",i.i32_const(0))],[...i.drop(i.call(n+"_sub",d,i.getLocal("t"),i.getLocal("x"))),...i.setLocal("signx",i.i32_const(1))]))),i.setLocal("swp",i.getLocal("t")),i.setLocal("t",i.getLocal("newt")),i.setLocal("newt",i.getLocal("x")),i.setLocal("x",i.getLocal("swp")),i.setLocal("signt",i.getLocal("signnewt")),i.setLocal("signnewt",i.getLocal("signx")),i.setLocal("swp",i.getLocal("r")),i.setLocal("r",i.getLocal("newr")),i.setLocal("newr",i.getLocal("qr")),i.setLocal("qr",i.getLocal("swp")),i.br(0)))),e.addCode(i.if(i.getLocal("signt"),i.drop(i.call(n+"_sub",i.getLocal("pm"),i.getLocal("t"),i.getLocal("pr"))),i.call(n+"_copy",i.getLocal("t"),i.getLocal("pr"))))}(),t.exportFunction(n+"_copy"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_one"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_gte"),t.exportFunction(n+"_add"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_mul"),t.exportFunction(n+"_square"),t.exportFunction(n+"_squareOld"),t.exportFunction(n+"_div"),t.exportFunction(n+"_inverseMod"),n},qt=function(t,e,i,n,a,o,r){const s=t.addFunction(e);s.addParam("base","i32"),s.addParam("scalar","i32"),s.addParam("scalarLength","i32"),s.addParam("r","i32"),s.addLocal("i","i32"),s.addLocal("b","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(i));s.addCode(c.if(c.i32_eqz(c.getLocal("scalarLength")),[...c.call(r,c.getLocal("r")),...c.ret([])])),s.addCode(c.call(o,c.getLocal("base"),l)),s.addCode(c.call(r,c.getLocal("r"))),s.addCode(c.setLocal("i",c.getLocal("scalarLength"))),s.addCode(c.block(c.loop(c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.setLocal("b",c.i32_load8_u(c.i32_add(c.getLocal("scalar"),c.getLocal("i")))),...function(){const t=[];for(let e=0;e<8;e++)t.push(...c.call(a,c.getLocal("r"),c.getLocal("r")),...c.if(c.i32_ge_u(c.getLocal("b"),c.i32_const(128>>e)),[...c.setLocal("b",c.i32_sub(c.getLocal("b"),c.i32_const(128>>e))),...c.call(n,c.getLocal("r"),l,c.getLocal("r"))]));return t}(),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.br(0))))},Gt=function(t,e){const i=8*t.modules[e].n64,n=t.addFunction(e+"_batchInverse");n.addParam("pIn","i32"),n.addParam("inStep","i32"),n.addParam("n","i32"),n.addParam("pOut","i32"),n.addParam("outStep","i32"),n.addLocal("itAux","i32"),n.addLocal("itIn","i32"),n.addLocal("itOut","i32"),n.addLocal("i","i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(i));n.addCode(a.setLocal("itAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("itAux"),a.i32_mul(a.i32_add(a.getLocal("n"),a.i32_const(1)),a.i32_const(i))))),n.addCode(a.call(e+"_one",a.getLocal("itAux")),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(i))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(i)),a.getLocal("itAux")),a.call(e+"_mul",a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(i)),a.getLocal("itAux"))),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(i))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(i))),a.setLocal("itOut",a.i32_add(a.getLocal("pOut"),a.i32_mul(a.i32_sub(a.getLocal("n"),a.i32_const(1)),a.getLocal("outStep")))),a.call(e+"_inverse",a.getLocal("itAux"),a.getLocal("itAux")),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("i"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),[...a.call(e+"_copy",a.getLocal("itAux"),a.i32_sub(a.getLocal("itAux"),a.i32_const(i))),...a.call(e+"_zero",a.getLocal("itOut"))],[...a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(i)),o),...a.call(e+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(i))),...a.call(e+"_mul",a.getLocal("itAux"),o,a.getLocal("itOut"))]),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itOut",a.i32_sub(a.getLocal("itOut"),a.getLocal("outStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(i))),a.setLocal("i",a.i32_sub(a.getLocal("i"),a.i32_const(1))),a.br(0)))),n.addCode(a.i32_store(a.i32_const(0),a.getLocal("itAux")))};var Ut=function(t,e,i,n,a,o){void 0===o&&(o=n<a);const r=t.addFunction(e);r.addParam("pIn","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn","i32"),r.addLocal("itOut","i32");const s=r.getCodeBuilder();o?r.addCode(s.setLocal("itIn",s.i32_add(s.getLocal("pIn"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(n)))),s.setLocal("itOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(a)))),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(i,s.getLocal("itIn"),s.getLocal("itOut")),s.setLocal("itIn",s.i32_sub(s.getLocal("itIn"),s.i32_const(n))),s.setLocal("itOut",s.i32_sub(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))):r.addCode(s.setLocal("itIn",s.getLocal("pIn")),s.setLocal("itOut",s.getLocal("pOut")),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(i,s.getLocal("itIn"),s.getLocal("itOut")),s.setLocal("itIn",s.i32_add(s.getLocal("itIn"),s.i32_const(n))),s.setLocal("itOut",s.i32_add(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))};var zt=function(t,e,i,n,a,o){void 0===o&&(o=n<a);const r=t.addFunction(e);r.addParam("pIn1","i32"),r.addParam("pIn2","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn1","i32"),r.addLocal("itIn2","i32"),r.addLocal("itOut","i32");const s=r.getCodeBuilder();o?r.addCode(s.setLocal("itIn1",s.i32_add(s.getLocal("pIn1"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(n)))),s.setLocal("itIn2",s.i32_add(s.getLocal("pIn2"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(n)))),s.setLocal("itOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(a)))),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(i,s.getLocal("itIn1"),s.getLocal("itIn2"),s.getLocal("itOut")),s.setLocal("itIn1",s.i32_sub(s.getLocal("itIn1"),s.i32_const(n))),s.setLocal("itIn2",s.i32_sub(s.getLocal("itIn2"),s.i32_const(n))),s.setLocal("itOut",s.i32_sub(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))):r.addCode(s.setLocal("itIn1",s.getLocal("pIn1")),s.setLocal("itIn2",s.getLocal("pIn2")),s.setLocal("itOut",s.getLocal("pOut")),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(i,s.getLocal("itIn1"),s.getLocal("itIn2"),s.getLocal("itOut")),s.setLocal("itIn1",s.i32_add(s.getLocal("itIn1"),s.i32_const(n))),s.setLocal("itIn2",s.i32_add(s.getLocal("itIn2"),s.i32_const(n))),s.setLocal("itOut",s.i32_add(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))};var Pt=function(t,e,i,n){const a=d(e),o=Math.floor((a.minus(1).bitLength()-1)/64)+1,r=2*o,s=8*o,c=i||"f1m";if(t.modules[c])return c;const l=Ot(t,o,n),u=t.alloc(s,St(a,s));t.alloc(St(d.one.shiftLeft(64*o).mod(a),s));const f=t.alloc(St(d.one.shiftLeft(64*o).square().mod(a),s)),h=t.alloc(St(d.one.shiftLeft(64*o).mod(a),s)),g=t.alloc(St(d.zero,s)),p=a.minus(d.one),_=p.shiftRight(1),m=t.alloc(s,St(_,s)),L=_.add(d.one),w=t.alloc(s,St(L,s));t.modules[c]={pq:u,pR2:f,n64:o,q:a,pOne:h,pZero:g,pePlusOne:w};let b=d(2);if(a.isPrime())for(;!b.modPow(_,a).equals(p);)b=b.add(d.one);t.alloc(St(b.shiftLeft(64*o).mod(a),s));let y=0,A=p;for(;!A.isOdd()&&!A.isZero();)y++,A=A.shiftRight(1);const I=t.alloc(s,St(A,s)),C=b.modPow(A,a),v=t.alloc(St(C.shiftLeft(64*o).mod(a),s)),F=A.add(1).shiftRight(1),x=t.alloc(s,St(F,s));return t.exportFunction(l+"_copy",c+"_copy"),t.exportFunction(l+"_zero",c+"_zero"),t.exportFunction(l+"_isZero",c+"_isZero"),t.exportFunction(l+"_eq",c+"_eq"),function(){const e=t.addFunction(c+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.ret(i.call(l+"_eq",i.getLocal("x"),i.i32_const(h))))}(),function(){const e=t.addFunction(c+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.if(i.call(l+"_add",i.getLocal("x"),i.getLocal("y"),i.getLocal("r")),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))),i.if(i.call(l+"_gte",i.getLocal("r"),i.i32_const(u)),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.if(i.call(l+"_sub",i.getLocal("x"),i.getLocal("y"),i.getLocal("r")),i.drop(i.call(l+"_add",i.getLocal("r"),i.i32_const(u),i.getLocal("r")))))}(),function(){const e=t.addFunction(c+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(c+"_sub",i.i32_const(g),i.getLocal("x"),i.getLocal("r")))}(),function(){const e=t.alloc(r*r*8),i=t.addFunction(c+"_mReduct");i.addParam("t","i32"),i.addParam("r","i32"),i.addLocal("np32","i64"),i.addLocal("c","i64"),i.addLocal("m","i64");const n=i.getCodeBuilder(),o=d("100000000",16).minus(a.modInv(d("100000000",16))).toJSNumber();i.addCode(n.setLocal("np32",n.i64_const(o)));for(let t=0;t<r;t++){i.addCode(n.setLocal("c",n.i64_const(0))),i.addCode(n.setLocal("m",n.i64_and(n.i64_mul(n.i64_load32_u(n.getLocal("t"),4*t),n.getLocal("np32")),n.i64_const("0xFFFFFFFF"))));for(let e=0;e<r;e++)i.addCode(n.setLocal("c",n.i64_add(n.i64_add(n.i64_load32_u(n.getLocal("t"),4*(t+e)),n.i64_shr_u(n.getLocal("c"),n.i64_const(32))),n.i64_mul(n.i64_load32_u(n.i32_const(u),4*e),n.getLocal("m"))))),i.addCode(n.i64_store32(n.getLocal("t"),4*(t+e),n.getLocal("c")));i.addCode(n.i64_store32(n.i32_const(e),4*t,n.i64_shr_u(n.getLocal("c"),n.i64_const(32))))}i.addCode(n.call(c+"_add",n.i32_const(e),n.i32_add(n.getLocal("t"),n.i32_const(4*r)),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const i=e.getCodeBuilder(),n=d("100000000",16).minus(a.modInv(d("100000000",16))).toJSNumber();e.addCode(i.setLocal("np32",i.i64_const(n)));const o=[],s=[],f=[];function h(t,e){let n,a;return o[t]?n=i.getLocal("x"+t):(n=i.teeLocal("x"+t,i.i64_load32_u(i.getLocal("x"),4*t)),o[t]=!0),s[e]?a=i.getLocal("y"+e):(a=i.teeLocal("y"+e,i.i64_load32_u(i.getLocal("y"),4*e)),s[e]=!0),i.i64_mul(n,a)}function g(t,e){let n,a;return f[t]?n=i.getLocal("q"+t):(n=i.teeLocal("q"+t,i.i64_load32_u(i.i32_const(0),u+4*t)),f[t]=!0),a=i.getLocal("m"+e),i.i64_mul(n,a)}let p="c0",_="c1";for(let t=0;t<2*r-1;t++){for(let n=Math.max(0,t-r+1);n<=t&&n<r;n++){const a=t-n;e.addCode(i.setLocal(p,i.i64_add(i.i64_and(i.getLocal(p),i.i64_const(4294967295)),h(n,a)))),e.addCode(i.setLocal(_,i.i64_add(i.getLocal(_),i.i64_shr_u(i.getLocal(p),i.i64_const(32)))))}for(let n=Math.max(1,t-r+1);n<=t&&n<r;n++){const a=t-n;e.addCode(i.setLocal(p,i.i64_add(i.i64_and(i.getLocal(p),i.i64_const(4294967295)),g(n,a)))),e.addCode(i.setLocal(_,i.i64_add(i.getLocal(_),i.i64_shr_u(i.getLocal(p),i.i64_const(32)))))}t<r&&(e.addCode(i.setLocal("m"+t,i.i64_and(i.i64_mul(i.i64_and(i.getLocal(p),i.i64_const(4294967295)),i.getLocal("np32")),i.i64_const("0xFFFFFFFF")))),e.addCode(i.setLocal(p,i.i64_add(i.i64_and(i.getLocal(p),i.i64_const(4294967295)),g(0,t)))),e.addCode(i.setLocal(_,i.i64_add(i.getLocal(_),i.i64_shr_u(i.getLocal(p),i.i64_const(32)))))),t>=r&&e.addCode(i.i64_store32(i.getLocal("r"),4*(t-r),i.getLocal(p))),[p,_]=[_,p],e.addCode(i.setLocal(_,i.i64_shr_u(i.getLocal(p),i.i64_const(32))))}e.addCode(i.i64_store32(i.getLocal("r"),4*r-4,i.getLocal(p))),e.addCode(i.if(i.i32_wrap_i64(i.getLocal(_)),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))),i.if(i.call(l+"_gte",i.getLocal("r"),i.i32_const(u)),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const i=e.getCodeBuilder(),n=d("100000000",16).minus(a.modInv(d("100000000",16))).toJSNumber();e.addCode(i.setLocal("np32",i.i64_const(n)));const o=[],s=[];function f(t,e){let n,a;return o[t]?n=i.getLocal("x"+t):(n=i.teeLocal("x"+t,i.i64_load32_u(i.getLocal("x"),4*t)),o[t]=!0),o[e]?a=i.getLocal("x"+e):(a=i.teeLocal("x"+e,i.i64_load32_u(i.getLocal("x"),4*e)),o[e]=!0),i.i64_mul(n,a)}function h(t,e){let n,a;return s[t]?n=i.getLocal("q"+t):(n=i.teeLocal("q"+t,i.i64_load32_u(i.i32_const(0),u+4*t)),s[t]=!0),a=i.getLocal("m"+e),i.i64_mul(n,a)}let g="c0",p="c1",_="c0_old",m="c1_old";for(let t=0;t<2*r-1;t++){e.addCode(i.setLocal(g,i.i64_const(0)),i.setLocal(p,i.i64_const(0)));for(let n=Math.max(0,t-r+1);n<t+1>>1&&n<r;n++){const a=t-n;e.addCode(i.setLocal(g,i.i64_add(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),f(n,a)))),e.addCode(i.setLocal(p,i.i64_add(i.getLocal(p),i.i64_shr_u(i.getLocal(g),i.i64_const(32)))))}e.addCode(i.setLocal(g,i.i64_shl(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),i.i64_const(1)))),e.addCode(i.setLocal(p,i.i64_add(i.i64_shl(i.getLocal(p),i.i64_const(1)),i.i64_shr_u(i.getLocal(g),i.i64_const(32))))),t%2==0&&(e.addCode(i.setLocal(g,i.i64_add(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),f(t>>1,t>>1)))),e.addCode(i.setLocal(p,i.i64_add(i.getLocal(p),i.i64_shr_u(i.getLocal(g),i.i64_const(32)))))),t>0&&(e.addCode(i.setLocal(g,i.i64_add(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),i.i64_and(i.getLocal(_),i.i64_const(4294967295))))),e.addCode(i.setLocal(p,i.i64_add(i.i64_add(i.getLocal(p),i.i64_shr_u(i.getLocal(g),i.i64_const(32))),i.getLocal(m)))));for(let n=Math.max(1,t-r+1);n<=t&&n<r;n++){const a=t-n;e.addCode(i.setLocal(g,i.i64_add(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),h(n,a)))),e.addCode(i.setLocal(p,i.i64_add(i.getLocal(p),i.i64_shr_u(i.getLocal(g),i.i64_const(32)))))}t<r&&(e.addCode(i.setLocal("m"+t,i.i64_and(i.i64_mul(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),i.getLocal("np32")),i.i64_const("0xFFFFFFFF")))),e.addCode(i.setLocal(g,i.i64_add(i.i64_and(i.getLocal(g),i.i64_const(4294967295)),h(0,t)))),e.addCode(i.setLocal(p,i.i64_add(i.getLocal(p),i.i64_shr_u(i.getLocal(g),i.i64_const(32)))))),t>=r&&e.addCode(i.i64_store32(i.getLocal("r"),4*(t-r),i.getLocal(g))),e.addCode(i.setLocal(_,i.getLocal(p)),i.setLocal(m,i.i64_shr_u(i.getLocal(_),i.i64_const(32))))}e.addCode(i.i64_store32(i.getLocal("r"),4*r-4,i.getLocal(_))),e.addCode(i.if(i.i32_wrap_i64(i.getLocal(m)),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))),i.if(i.call(l+"_gte",i.getLocal("r"),i.i32_const(u)),i.drop(i.call(l+"_sub",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(c+"_mul",i.getLocal("x"),i.getLocal("x"),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(c+"_mul",i.getLocal("x"),i.i32_const(f),i.getLocal("r")))}(),function(){const e=t.alloc(2*s),i=t.addFunction(c+"_fromMontgomery");i.addParam("x","i32"),i.addParam("r","i32");const n=i.getCodeBuilder();i.addCode(n.call(l+"_copy",n.getLocal("x"),n.i32_const(e))),i.addCode(n.call(l+"_zero",n.i32_const(e+s))),i.addCode(n.call(c+"_mReduct",n.i32_const(e),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(s));e.addCode(i.call(c+"_fromMontgomery",i.getLocal("x"),n),i.call(l+"_gte",n,i.i32_const(w)))}(),function(){const e=t.addFunction(c+"_sign");e.addParam("x","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(s));e.addCode(i.if(i.call(l+"_isZero",i.getLocal("x")),i.ret(i.i32_const(0))),i.call(c+"_fromMontgomery",i.getLocal("x"),n),i.if(i.call(l+"_gte",n,i.i32_const(w)),i.ret(i.i32_const(-1))),i.ret(i.i32_const(1)))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(c+"_fromMontgomery",i.getLocal("x"),i.getLocal("r"))),e.addCode(i.call(l+"_inverseMod",i.getLocal("r"),i.i32_const(u),i.getLocal("r"))),e.addCode(i.call(c+"_toMontgomery",i.getLocal("r"),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_one");e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(l+"_copy",i.i32_const(h),i.getLocal("pr")))}(),function(){const e=t.addFunction(c+"_load");e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32"),e.addLocal("p","i32"),e.addLocal("l","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(s)),a=t.alloc(s),o=i.i32_const(a);e.addCode(i.call(l+"_zero",i.getLocal("r")),i.setLocal("i",i.i32_const(s)),i.setLocal("p",i.getLocal("scalar")),i.block(i.loop(i.br_if(1,i.i32_gt_u(i.getLocal("i"),i.getLocal("scalarLen"))),i.if(i.i32_eq(i.getLocal("i"),i.i32_const(s)),i.call(c+"_one",n),i.call(c+"_mul",n,i.i32_const(f),n)),i.call(c+"_mul",i.getLocal("p"),n,o),i.call(c+"_add",i.getLocal("r"),o,i.getLocal("r")),i.setLocal("p",i.i32_add(i.getLocal("p"),i.i32_const(s))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(s))),i.br(0))),i.setLocal("l",i.i32_rem_u(i.getLocal("scalarLen"),i.i32_const(s))),i.if(i.i32_eqz(i.getLocal("l")),i.ret([])),i.call(l+"_zero",o),i.setLocal("j",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("j"),i.getLocal("l"))),i.i32_store8(i.getLocal("j"),a,i.i32_load8_u(i.getLocal("p"))),i.setLocal("p",i.i32_add(i.getLocal("p"),i.i32_const(1))),i.setLocal("j",i.i32_add(i.getLocal("j"),i.i32_const(1))),i.br(0))),i.if(i.i32_eq(i.getLocal("i"),i.i32_const(s)),i.call(c+"_one",n),i.call(c+"_mul",n,i.i32_const(f),n)),i.call(c+"_mul",o,n,o),i.call(c+"_add",i.getLocal("r"),o,i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(s));e.addCode(i.call(c+"_load",i.getLocal("scalar"),i.getLocal("scalarLen"),n),i.call(c+"_toMontgomery",n,n),i.call(c+"_mul",i.getLocal("x"),n,i.getLocal("r")))}(),Gt(t,c),Ut(t,c+"_batchToMontgomery",c+"_toMontgomery",s,s),Ut(t,c+"_batchFromMontgomery",c+"_fromMontgomery",s,s),Ut(t,c+"_batchNeg",c+"_neg",s,s),zt(t,c+"_batchAdd",c+"_add",s,s),zt(t,c+"_batchSub",c+"_sub",s,s),zt(t,c+"_batchMul",c+"_mul",s,s),t.exportFunction(c+"_add"),t.exportFunction(c+"_sub"),t.exportFunction(c+"_neg"),t.exportFunction(c+"_isNegative"),t.exportFunction(c+"_isOne"),t.exportFunction(c+"_sign"),t.exportFunction(c+"_mReduct"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_squareOld"),t.exportFunction(c+"_fromMontgomery"),t.exportFunction(c+"_toMontgomery"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_one"),t.exportFunction(c+"_load"),t.exportFunction(c+"_timesScalar"),qt(t,c+"_exp",s,c+"_mul",c+"_square",l+"_copy",c+"_one"),t.exportFunction(c+"_exp"),t.exportFunction(c+"_batchInverse"),a.isPrime()&&(!function(){const e=t.addFunction(c+"_sqrt");e.addParam("n","i32"),e.addParam("r","i32"),e.addLocal("m","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const i=e.getCodeBuilder(),n=i.i32_const(h),a=i.i32_const(t.alloc(s)),o=i.i32_const(t.alloc(s)),r=i.i32_const(t.alloc(s)),l=i.i32_const(t.alloc(s)),u=i.i32_const(t.alloc(s));e.addCode(i.if(i.call(c+"_isZero",i.getLocal("n")),i.ret(i.call(c+"_zero",i.getLocal("r")))),i.setLocal("m",i.i32_const(y)),i.call(c+"_copy",i.i32_const(v),a),i.call(c+"_exp",i.getLocal("n"),i.i32_const(I),i.i32_const(s),o),i.call(c+"_exp",i.getLocal("n"),i.i32_const(x),i.i32_const(s),r),i.block(i.loop(i.br_if(1,i.call(c+"_eq",o,n)),i.call(c+"_square",o,l),i.setLocal("i",i.i32_const(1)),i.block(i.loop(i.br_if(1,i.call(c+"_eq",l,n)),i.call(c+"_square",l,l),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(c+"_copy",a,u),i.setLocal("j",i.i32_sub(i.i32_sub(i.getLocal("m"),i.getLocal("i")),i.i32_const(1))),i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("j"))),i.call(c+"_square",u,u),i.setLocal("j",i.i32_sub(i.getLocal("j"),i.i32_const(1))),i.br(0))),i.setLocal("m",i.getLocal("i")),i.call(c+"_square",u,a),i.call(c+"_mul",o,a,o),i.call(c+"_mul",r,u,r),i.br(0))),i.if(i.call(c+"_isNegative",r),i.call(c+"_neg",r,i.getLocal("r")),i.call(c+"_copy",r,i.getLocal("r"))))}(),function(){const e=t.addFunction(c+"_isSquare");e.addParam("n","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=i.i32_const(h),a=i.i32_const(t.alloc(s));e.addCode(i.if(i.call(c+"_isZero",i.getLocal("n")),i.ret(i.i32_const(1))),i.call(c+"_exp",i.getLocal("n"),i.i32_const(m),i.i32_const(s),a),i.call(c+"_eq",a,n))}(),t.exportFunction(c+"_sqrt"),t.exportFunction(c+"_isSquare")),t.exportFunction(c+"_batchToMontgomery"),t.exportFunction(c+"_batchFromMontgomery"),c},Mt=function(t,e,i,n,a){const o=d(e),r=Math.floor((o.minus(1).bitLength()-1)/64)+1,s=8*r,c=i||"f1";if(t.modules[c])return c;t.modules[c]={n64:r};const l=a||"int",u=Pt(t,o,n,l),f=t.modules[u].pR2,h=t.modules[u].pq,g=t.modules[u].pePlusOne;return function(){const e=t.alloc(s),i=t.addFunction(c+"_mul");i.addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32");const n=i.getCodeBuilder();i.addCode(n.call(u+"_mul",n.getLocal("x"),n.getLocal("y"),n.i32_const(e))),i.addCode(n.call(u+"_mul",n.i32_const(e),n.i32_const(f),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(c+"_mul",i.getLocal("x"),i.getLocal("x"),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(l+"_inverseMod",i.getLocal("x"),i.i32_const(h),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.call(l+"_gte",i.getLocal("x"),i.i32_const(g)))}(),t.exportFunction(u+"_add",c+"_add"),t.exportFunction(u+"_sub",c+"_sub"),t.exportFunction(u+"_neg",c+"_neg"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_isNegative"),t.exportFunction(u+"_copy",c+"_copy"),t.exportFunction(u+"_zero",c+"_zero"),t.exportFunction(u+"_one",c+"_one"),t.exportFunction(u+"_isZero",c+"_isZero"),t.exportFunction(u+"_eq",c+"_eq"),c},Qt=function(t,e,i,n){if(t.modules[i])return i;const a=8*t.modules[n].n64,o=t.modules[n].q;return t.modules[i]={n64:2*t.modules[n].n64},function(){const e=t.addFunction(i+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.i32_and(o.call(n+"_isZero",r),o.call(n+"_isZero",s)))}(),function(){const e=t.addFunction(i+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.ret(o.i32_and(o.call(n+"_isOne",r),o.call(n+"_isZero",s))))}(),function(){const e=t.addFunction(i+"_zero");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.call(n+"_zero",r),o.call(n+"_zero",s))}(),function(){const e=t.addFunction(i+"_one");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.call(n+"_one",r),o.call(n+"_zero",s))}(),function(){const e=t.addFunction(i+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_copy",r,c),o.call(n+"_copy",s,l))}(),function(){const o=t.addFunction(i+"_mul");o.addParam("x","i32"),o.addParam("y","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("y"),u=r.i32_add(r.getLocal("y"),r.i32_const(a)),d=r.getLocal("r"),f=r.i32_add(r.getLocal("r"),r.i32_const(a)),h=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_mul",s,l,h),r.call(n+"_mul",c,u,g),r.call(n+"_add",s,c,p),r.call(n+"_add",l,u,_),r.call(n+"_mul",p,_,p),r.call(e,g,d),r.call(n+"_add",h,d,d),r.call(n+"_add",h,g,f),r.call(n+"_sub",p,f,f))}(),function(){const e=t.addFunction(i+"_mul1");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_mul",r,c,l),o.call(n+"_mul",s,c,u))}(),function(){const o=t.addFunction(i+"_square");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(a)),d=r.i32_const(t.alloc(a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_mul",s,c,d),r.call(n+"_add",s,c,f),r.call(e,c,h),r.call(n+"_add",s,h,h),r.call(e,d,g),r.call(n+"_add",g,d,g),r.call(n+"_mul",f,h,l),r.call(n+"_sub",l,g,l),r.call(n+"_add",d,d,u))}(),function(){const e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a)),u=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_add",r,c,u),o.call(n+"_add",s,l,d))}(),function(){const e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a)),u=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_sub",r,c,u),o.call(n+"_sub",s,l,d))}(),function(){const e=t.addFunction(i+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_neg",r,c),o.call(n+"_neg",s,l))}(),function(){const e=t.addFunction(i+"_conjugate");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_copy",r,c),o.call(n+"_neg",s,l))}(),function(){const e=t.addFunction(i+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_toMontgomery",r,c),o.call(n+"_toMontgomery",s,l))}(),function(){const e=t.addFunction(i+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_fromMontgomery",r,c),o.call(n+"_fromMontgomery",s,l))}(),function(){const e=t.addFunction(i+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a));e.addCode(o.i32_and(o.call(n+"_eq",r,c),o.call(n+"_eq",s,l)))}(),function(){const o=t.addFunction(i+"_inverse");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(a)),d=r.i32_const(t.alloc(a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_square",s,d),r.call(n+"_square",c,f),r.call(e,f,h),r.call(n+"_sub",d,h,h),r.call(n+"_inverse",h,g),r.call(n+"_mul",s,g,l),r.call(n+"_mul",c,g,u),r.call(n+"_neg",u,u))}(),function(){const e=t.addFunction(i+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(n+"_timesScalar",r,o.getLocal("scalar"),o.getLocal("scalarLen"),c),o.call(n+"_timesScalar",s,o.getLocal("scalar"),o.getLocal("scalarLen"),l))}(),function(){const e=t.addFunction(i+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.setLocal("s",o.call(n+"_sign",s)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.ret(o.call(n+"_sign",r)))}(),function(){const e=t.addFunction(i+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.if(o.call(n+"_isZero",s),o.ret(o.call(n+"_isNegative",r))),o.ret(o.call(n+"_isNegative",s)))}(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_mul1"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_conjugate"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),Gt(t,i),qt(t,i+"_exp",2*a,i+"_mul",i+"_square",i+"_copy",i+"_one"),function(){const e=t.addFunction(i+"_sqrt");e.addParam("a","i32"),e.addParam("pr","i32");const r=e.getCodeBuilder(),s=r.i32_const(t.alloc(St(d(o).minus(d(3)).divide(4),a))),c=r.i32_const(t.alloc(St(d(o).minus(d(1)).divide(2),a))),l=r.getLocal("a"),u=r.i32_const(t.alloc(2*a)),f=r.i32_const(t.alloc(2*a)),h=r.i32_const(t.alloc(2*a)),g=t.alloc(2*a),p=r.i32_const(g),_=r.i32_const(g),m=r.i32_const(g+a),L=r.i32_const(t.alloc(2*a)),w=r.i32_const(t.alloc(2*a));e.addCode(r.call(i+"_one",p),r.call(i+"_neg",p,p),r.call(i+"_exp",l,s,r.i32_const(a),u),r.call(i+"_square",u,f),r.call(i+"_mul",l,f,f),r.call(i+"_conjugate",f,h),r.call(i+"_mul",h,f,h),r.if(r.call(i+"_eq",h,p),r.unreachable()),r.call(i+"_mul",u,l,L),r.if(r.call(i+"_eq",f,p),[...r.call(n+"_zero",_),...r.call(n+"_one",m),...r.call(i+"_mul",p,L,r.getLocal("pr"))],[...r.call(i+"_one",w),...r.call(i+"_add",w,f,w),...r.call(i+"_exp",w,c,r.i32_const(a),w),...r.call(i+"_mul",w,L,r.getLocal("pr"))]))}(),function(){const e=t.addFunction(i+"_isSquare");e.addParam("a","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.i32_const(t.alloc(St(d(o).minus(d(3)).divide(4),a))),s=n.getLocal("a"),c=n.i32_const(t.alloc(2*a)),l=n.i32_const(t.alloc(2*a)),u=n.i32_const(t.alloc(2*a)),f=t.alloc(2*a),h=n.i32_const(f);e.addCode(n.call(i+"_one",h),n.call(i+"_neg",h,h),n.call(i+"_exp",s,r,n.i32_const(a),c),n.call(i+"_square",c,l),n.call(i+"_mul",s,l,l),n.call(i+"_conjugate",l,u),n.call(i+"_mul",u,l,u),n.if(n.call(i+"_eq",u,h),n.ret(n.i32_const(0))),n.ret(n.i32_const(1)))}(),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_sqrt"),t.exportFunction(i+"_isSquare"),t.exportFunction(i+"_isNegative"),i},Tt=function(t,e,i,n){if(t.modules[i])return i;const a=8*t.modules[n].n64;return t.modules[i]={n64:3*t.modules[n].n64},function(){const e=t.addFunction(i+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.i32_and(o.i32_and(o.call(n+"_isZero",r),o.call(n+"_isZero",s)),o.call(n+"_isZero",c)))}(),function(){const e=t.addFunction(i+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.ret(o.i32_and(o.i32_and(o.call(n+"_isOne",r),o.call(n+"_isZero",s)),o.call(n+"_isZero",c))))}(),function(){const e=t.addFunction(i+"_zero");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.call(n+"_zero",r),o.call(n+"_zero",s),o.call(n+"_zero",c))}(),function(){const e=t.addFunction(i+"_one");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.call(n+"_one",r),o.call(n+"_zero",s),o.call(n+"_zero",c))}(),function(){const e=t.addFunction(i+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a)),d=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_copy",r,l),o.call(n+"_copy",s,u),o.call(n+"_copy",c,d))}(),function(){const o=t.addFunction(i+"_mul");o.addParam("x","i32"),o.addParam("y","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),u=r.getLocal("y"),d=r.i32_add(r.getLocal("y"),r.i32_const(a)),f=r.i32_add(r.getLocal("y"),r.i32_const(2*a)),h=r.getLocal("r"),g=r.i32_add(r.getLocal("r"),r.i32_const(a)),p=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),_=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),w=r.i32_const(t.alloc(a)),b=r.i32_const(t.alloc(a)),y=r.i32_const(t.alloc(a)),A=r.i32_const(t.alloc(a)),I=r.i32_const(t.alloc(a)),C=r.i32_const(t.alloc(a)),v=r.i32_const(t.alloc(a)),F=r.i32_const(t.alloc(a)),x=r.i32_const(t.alloc(a)),B=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_mul",s,u,_),r.call(n+"_mul",c,d,m),r.call(n+"_mul",l,f,L),r.call(n+"_add",s,c,w),r.call(n+"_add",u,d,b),r.call(n+"_add",s,l,y),r.call(n+"_add",u,f,A),r.call(n+"_add",c,l,I),r.call(n+"_add",d,f,C),r.call(n+"_add",_,m,v),r.call(n+"_add",_,L,F),r.call(n+"_add",m,L,x),r.call(n+"_mul",I,C,h),r.call(n+"_sub",h,x,h),r.call(e,h,h),r.call(n+"_add",_,h,h),r.call(n+"_mul",w,b,g),r.call(n+"_sub",g,v,g),r.call(e,L,B),r.call(n+"_add",g,B,g),r.call(n+"_mul",y,A,p),r.call(n+"_sub",p,F,p),r.call(n+"_add",p,m,p))}(),function(){const o=t.addFunction(i+"_square");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),u=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(a)),f=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),h=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),w=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_square",s,h),r.call(n+"_mul",s,c,g),r.call(n+"_add",g,g,p),r.call(n+"_sub",s,c,_),r.call(n+"_add",_,l,_),r.call(n+"_square",_,_),r.call(n+"_mul",c,l,m),r.call(n+"_add",m,m,L),r.call(n+"_square",l,w),r.call(e,L,u),r.call(n+"_add",h,u,u),r.call(e,w,d),r.call(n+"_add",p,d,d),r.call(n+"_add",h,w,f),r.call(n+"_sub",L,f,f),r.call(n+"_add",_,f,f),r.call(n+"_add",p,f,f))}(),function(){const e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),u=o.i32_add(o.getLocal("y"),o.i32_const(a)),d=o.i32_add(o.getLocal("y"),o.i32_const(2*a)),f=o.getLocal("r"),h=o.i32_add(o.getLocal("r"),o.i32_const(a)),g=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_add",r,l,f),o.call(n+"_add",s,u,h),o.call(n+"_add",c,d,g))}(),function(){const e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),u=o.i32_add(o.getLocal("y"),o.i32_const(a)),d=o.i32_add(o.getLocal("y"),o.i32_const(2*a)),f=o.getLocal("r"),h=o.i32_add(o.getLocal("r"),o.i32_const(a)),g=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_sub",r,l,f),o.call(n+"_sub",s,u,h),o.call(n+"_sub",c,d,g))}(),function(){const e=t.addFunction(i+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a)),d=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_neg",r,l),o.call(n+"_neg",s,u),o.call(n+"_neg",c,d))}(),function(){const e=t.addFunction(i+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.setLocal("s",o.call(n+"_sign",c)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.setLocal("s",o.call(n+"_sign",s)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.ret(o.call(n+"_sign",r)))}(),function(){const e=t.addFunction(i+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a)),d=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_toMontgomery",r,l),o.call(n+"_toMontgomery",s,u),o.call(n+"_toMontgomery",c,d))}(),function(){const e=t.addFunction(i+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a)),d=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_fromMontgomery",r,l),o.call(n+"_fromMontgomery",s,u),o.call(n+"_fromMontgomery",c,d))}(),function(){const e=t.addFunction(i+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),u=o.i32_add(o.getLocal("y"),o.i32_const(a)),d=o.i32_add(o.getLocal("y"),o.i32_const(2*a));e.addCode(o.i32_and(o.i32_and(o.call(n+"_eq",r,l),o.call(n+"_eq",s,u)),o.call(n+"_eq",c,d)))}(),function(){const o=t.addFunction(i+"_inverse");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),u=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(a)),f=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),h=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),w=r.i32_const(t.alloc(a)),b=r.i32_const(t.alloc(a)),y=r.i32_const(t.alloc(a)),A=r.i32_const(t.alloc(a)),I=r.i32_const(t.alloc(a));o.addCode(r.call(n+"_square",s,h),r.call(n+"_square",c,g),r.call(n+"_square",l,p),r.call(n+"_mul",s,c,_),r.call(n+"_mul",s,l,m),r.call(n+"_mul",c,l,L),r.call(e,L,w),r.call(n+"_sub",h,w,w),r.call(e,p,b),r.call(n+"_sub",b,_,b),r.call(n+"_sub",g,m,y),r.call(n+"_mul",l,b,A),r.call(n+"_mul",c,y,I),r.call(n+"_add",A,I,A),r.call(e,A,A),r.call(n+"_mul",s,w,I),r.call(n+"_add",I,A,A),r.call(n+"_inverse",A,A),r.call(n+"_mul",A,w,u),r.call(n+"_mul",A,b,d),r.call(n+"_mul",A,y,f))}(),function(){const e=t.addFunction(i+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a)),d=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(n+"_timesScalar",r,o.getLocal("scalar"),o.getLocal("scalarLen"),l),o.call(n+"_timesScalar",s,o.getLocal("scalar"),o.getLocal("scalarLen"),u),o.call(n+"_timesScalar",c,o.getLocal("scalar"),o.getLocal("scalarLen"),d))}(),function(){const e=t.addFunction(i+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.if(o.call(n+"_isZero",c),o.if(o.call(n+"_isZero",s),o.ret(o.call(n+"_isNegative",r)),o.ret(o.call(n+"_isNegative",s)))),o.ret(o.call(n+"_isNegative",c)))}(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),Gt(t,i),qt(t,i+"_exp",3*a,i+"_mul",i+"_square",i+"_copy",i+"_one"),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_isNegative"),i},Rt=function(t,e,i,n,a,o,r,s){const c=t.addFunction(e);c.addParam("base","i32"),c.addParam("scalar","i32"),c.addParam("scalarLength","i32"),c.addParam("r","i32"),c.addLocal("old0","i32"),c.addLocal("nbits","i32"),c.addLocal("i","i32"),c.addLocal("last","i32"),c.addLocal("cur","i32"),c.addLocal("carry","i32"),c.addLocal("p","i32");const l=c.getCodeBuilder(),u=l.i32_const(t.alloc(i));function d(t){return l.i32_and(l.i32_shr_u(l.i32_load(l.i32_add(l.getLocal("scalar"),l.i32_and(l.i32_shr_u(t,l.i32_const(3)),l.i32_const(4294967292)))),l.i32_and(t,l.i32_const(31))),l.i32_const(1))}function f(t){return[...l.i32_store8(l.getLocal("p"),l.i32_const(t)),...l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(1)))]}c.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(s,l.getLocal("r")),...l.ret([])]),l.setLocal("nbits",l.i32_shl(l.getLocal("scalarLength"),l.i32_const(3))),l.setLocal("old0",l.i32_load(l.i32_const(0))),l.setLocal("p",l.getLocal("old0")),l.i32_store(l.i32_const(0),l.i32_and(l.i32_add(l.i32_add(l.getLocal("old0"),l.i32_const(32)),l.getLocal("nbits")),l.i32_const(4294967288))),l.setLocal("i",l.i32_const(1)),l.setLocal("last",d(l.i32_const(0))),l.setLocal("carry",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nbits"))),l.setLocal("cur",d(l.getLocal("i"))),l.if(l.getLocal("last"),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...f(1)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...f(255)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...f(255)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...f(1)])),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...f(0)],[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...f(0)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...f(0)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...f(0)]))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.getLocal("last"),l.if(l.getLocal("carry"),[...f(255),...f(0),...f(1)],[...f(1)]),l.if(l.getLocal("carry"),[...f(0),...f(1)])),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.call(r,l.getLocal("base"),u),l.call(s,l.getLocal("r")),l.block(l.loop(l.call(a,l.getLocal("r"),l.getLocal("r")),l.setLocal("cur",l.i32_load8_u(l.getLocal("p"))),l.if(l.getLocal("cur"),l.if(l.i32_eq(l.getLocal("cur"),l.i32_const(1)),l.call(n,l.getLocal("r"),u,l.getLocal("r")),l.call(o,l.getLocal("r"),u,l.getLocal("r")))),l.br_if(1,l.i32_eq(l.getLocal("old0"),l.getLocal("p"))),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.br(0))),l.i32_store(l.i32_const(0),l.getLocal("old0")))},kt=function(t,e,i,n,a){const o=8*t.modules[e].n64;function r(){const n=t.addFunction(i);n.addParam("pBases","i32"),n.addParam("pScalars","i32"),n.addParam("scalarSize","i32"),n.addParam("n","i32"),n.addParam("pr","i32"),n.addLocal("chunkSize","i32"),n.addLocal("nChunks","i32"),n.addLocal("itScalar","i32"),n.addLocal("endScalar","i32"),n.addLocal("itBase","i32"),n.addLocal("itBit","i32"),n.addLocal("i","i32"),n.addLocal("j","i32"),n.addLocal("nTable","i32"),n.addLocal("pTable","i32"),n.addLocal("idx","i32"),n.addLocal("pIdxTable","i32");const a=n.getCodeBuilder(),r=a.i32_const(t.alloc(o)),s=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);n.addCode(a.call(e+"_zero",a.getLocal("pr")),a.if(a.i32_eqz(a.getLocal("n")),a.ret([])),a.setLocal("chunkSize",a.i32_load8_u(a.i32_clz(a.getLocal("n")),s)),a.setLocal("nChunks",a.i32_add(a.i32_div_u(a.i32_sub(a.i32_shl(a.getLocal("scalarSize"),a.i32_const(3)),a.i32_const(1)),a.getLocal("chunkSize")),a.i32_const(1))),a.setLocal("itBit",a.i32_mul(a.i32_sub(a.getLocal("nChunks"),a.i32_const(1)),a.getLocal("chunkSize"))),a.block(a.loop(a.br_if(1,a.i32_lt_s(a.getLocal("itBit"),a.i32_const(0))),a.if(a.i32_eqz(a.call(e+"_isZero",a.getLocal("pr"))),[...a.setLocal("j",a.i32_const(0)),...a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("j"),a.getLocal("chunkSize"))),a.call(e+"_double",a.getLocal("pr"),a.getLocal("pr")),a.setLocal("j",a.i32_add(a.getLocal("j"),a.i32_const(1))),a.br(0)))]),a.call(i+"_chunk",a.getLocal("pBases"),a.getLocal("pScalars"),a.getLocal("scalarSize"),a.getLocal("n"),a.getLocal("itBit"),a.getLocal("chunkSize"),r),a.call(e+"_add",a.getLocal("pr"),r,a.getLocal("pr")),a.setLocal("itBit",a.i32_sub(a.getLocal("itBit"),a.getLocal("chunkSize"))),a.br(0))))}!function(){const e=t.addFunction(i+"_getChunk");e.addParam("pScalar","i32"),e.addParam("scalarSize","i32"),e.addParam("startBit","i32"),e.addParam("chunkSize","i32"),e.addLocal("bitsToEnd","i32"),e.addLocal("mask","i32"),e.setReturnType("i32");const n=e.getCodeBuilder();e.addCode(n.setLocal("bitsToEnd",n.i32_sub(n.i32_mul(n.getLocal("scalarSize"),n.i32_const(8)),n.getLocal("startBit"))),n.if(n.i32_gt_s(n.getLocal("chunkSize"),n.getLocal("bitsToEnd")),n.setLocal("mask",n.i32_sub(n.i32_shl(n.i32_const(1),n.getLocal("bitsToEnd")),n.i32_const(1))),n.setLocal("mask",n.i32_sub(n.i32_shl(n.i32_const(1),n.getLocal("chunkSize")),n.i32_const(1)))),n.i32_and(n.i32_shr_u(n.i32_load(n.i32_add(n.getLocal("pScalar"),n.i32_shr_u(n.getLocal("startBit"),n.i32_const(3))),0,0),n.i32_and(n.getLocal("startBit"),n.i32_const(7))),n.getLocal("mask")))}(),function(){const n=t.addFunction(i+"_reduceTable");n.addParam("pTable","i32"),n.addParam("p","i32"),n.addLocal("half","i32"),n.addLocal("it1","i32"),n.addLocal("it2","i32"),n.addLocal("pAcc","i32");const a=n.getCodeBuilder();n.addCode(a.if(a.i32_eq(a.getLocal("p"),a.i32_const(1)),a.ret([])),a.setLocal("half",a.i32_shl(a.i32_const(1),a.i32_sub(a.getLocal("p"),a.i32_const(1)))),a.setLocal("it1",a.getLocal("pTable")),a.setLocal("it2",a.i32_add(a.getLocal("pTable"),a.i32_mul(a.getLocal("half"),a.i32_const(o)))),a.setLocal("pAcc",a.i32_sub(a.getLocal("it2"),a.i32_const(o))),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("it1"),a.getLocal("pAcc"))),a.call(e+"_add",a.getLocal("it1"),a.getLocal("it2"),a.getLocal("it1")),a.call(e+"_add",a.getLocal("pAcc"),a.getLocal("it2"),a.getLocal("pAcc")),a.setLocal("it1",a.i32_add(a.getLocal("it1"),a.i32_const(o))),a.setLocal("it2",a.i32_add(a.getLocal("it2"),a.i32_const(o))),a.br(0))),a.call(i+"_reduceTable",a.getLocal("pTable"),a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.setLocal("p",a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("p"))),a.call(e+"_double",a.getLocal("pAcc"),a.getLocal("pAcc")),a.setLocal("p",a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.br(0))),a.call(e+"_add",a.getLocal("pTable"),a.getLocal("pAcc"),a.getLocal("pTable")))}(),function(){const r=t.addFunction(i+"_chunk");r.addParam("pBases","i32"),r.addParam("pScalars","i32"),r.addParam("scalarSize","i32"),r.addParam("n","i32"),r.addParam("startBit","i32"),r.addParam("chunkSize","i32"),r.addParam("pr","i32"),r.addLocal("nChunks","i32"),r.addLocal("itScalar","i32"),r.addLocal("endScalar","i32"),r.addLocal("itBase","i32"),r.addLocal("i","i32"),r.addLocal("j","i32"),r.addLocal("nTable","i32"),r.addLocal("pTable","i32"),r.addLocal("idx","i32"),r.addLocal("pIdxTable","i32");const s=r.getCodeBuilder();r.addCode(s.if(s.i32_eqz(s.getLocal("n")),[...s.call(e+"_zero",s.getLocal("pr")),...s.ret([])]),s.setLocal("nTable",s.i32_shl(s.i32_const(1),s.getLocal("chunkSize"))),s.setLocal("pTable",s.i32_load(s.i32_const(0))),s.i32_store(s.i32_const(0),s.i32_add(s.getLocal("pTable"),s.i32_mul(s.getLocal("nTable"),s.i32_const(o)))),s.setLocal("j",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("j"),s.getLocal("nTable"))),s.call(e+"_zero",s.i32_add(s.getLocal("pTable"),s.i32_mul(s.getLocal("j"),s.i32_const(o)))),s.setLocal("j",s.i32_add(s.getLocal("j"),s.i32_const(1))),s.br(0))),s.setLocal("itBase",s.getLocal("pBases")),s.setLocal("itScalar",s.getLocal("pScalars")),s.setLocal("endScalar",s.i32_add(s.getLocal("pScalars"),s.i32_mul(s.getLocal("n"),s.getLocal("scalarSize")))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("itScalar"),s.getLocal("endScalar"))),s.setLocal("idx",s.call(i+"_getChunk",s.getLocal("itScalar"),s.getLocal("scalarSize"),s.getLocal("startBit"),s.getLocal("chunkSize"))),s.if(s.getLocal("idx"),[...s.setLocal("pIdxTable",s.i32_add(s.getLocal("pTable"),s.i32_mul(s.i32_sub(s.getLocal("idx"),s.i32_const(1)),s.i32_const(o)))),...s.call(n,s.getLocal("pIdxTable"),s.getLocal("itBase"),s.getLocal("pIdxTable"))]),s.setLocal("itScalar",s.i32_add(s.getLocal("itScalar"),s.getLocal("scalarSize"))),s.setLocal("itBase",s.i32_add(s.getLocal("itBase"),s.i32_const(a))),s.br(0))),s.call(i+"_reduceTable",s.getLocal("pTable"),s.getLocal("chunkSize")),s.call(e+"_copy",s.getLocal("pTable"),s.getLocal("pr")),s.i32_store(s.i32_const(0),s.getLocal("pTable")))}(),r(),t.exportFunction(i),t.exportFunction(i+"_chunk")},Nt=function(t,e,i,n){const a=t.modules[i].n64,o=8*a;if(t.modules[e])return e;return t.modules[e]={n64:3*a},function(){const n=t.addFunction(e+"_isZeroAffine");n.addParam("p1","i32"),n.setReturnType("i32");const a=n.getCodeBuilder();n.addCode(a.i32_and(a.call(i+"_isZero",a.getLocal("p1")),a.call(i+"_isZero",a.i32_add(a.getLocal("p1"),a.i32_const(o)))))}(),function(){const n=t.addFunction(e+"_isZero");n.addParam("p1","i32"),n.setReturnType("i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_isZero",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))))}(),function(){const n=t.addFunction(e+"_zeroAffine");n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_zero",a.getLocal("pr"))),n.addCode(a.call(i+"_zero",a.i32_add(a.getLocal("pr"),a.i32_const(o))))}(),function(){const n=t.addFunction(e+"_zero");n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_zero",a.getLocal("pr"))),n.addCode(a.call(i+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(o)))),n.addCode(a.call(i+"_zero",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))))}(),function(){const i=t.addFunction(e+"_copyAffine");i.addParam("ps","i32"),i.addParam("pd","i32");const n=i.getCodeBuilder();for(let t=0;t<2*a;t++)i.addCode(n.i64_store(n.getLocal("pd"),8*t,n.i64_load(n.getLocal("ps"),8*t)))}(),function(){const i=t.addFunction(e+"_copy");i.addParam("ps","i32"),i.addParam("pd","i32");const n=i.getCodeBuilder();for(let t=0;t<3*a;t++)i.addCode(n.i64_store(n.getLocal("pd"),8*t,n.i64_load(n.getLocal("ps"),8*t)))}(),function(){const n=t.addFunction(e+"_toJacobian");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_add(a.getLocal("pr"),a.i32_const(2*o));n.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),a.call(e+"_zero",a.getLocal("pr")),[...a.call(i+"_one",u),...a.call(i+"_copy",s,l),...a.call(i+"_copy",r,c)]))}(),function(){const n=t.addFunction(e+"_eqAffine");n.addParam("p1","i32"),n.addParam("p2","i32"),n.setReturnType("i32"),n.addLocal("z1","i32");const a=n.getCodeBuilder();n.addCode(a.ret(a.i32_and(a.call(i+"_eq",a.getLocal("p1"),a.getLocal("p2")),a.call(i+"_eq",a.i32_add(a.getLocal("p1"),a.i32_const(o)),a.i32_add(a.getLocal("p2"),a.i32_const(o))))))}(),function(){const n=t.addFunction(e+"_eqMixed");n.addParam("p1","i32"),n.addParam("p2","i32"),n.setReturnType("i32"),n.addLocal("z1","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));n.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),u=a.i32_add(a.getLocal("p2"),a.i32_const(o)),d=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.ret(a.call(e+"_isZeroAffine",a.getLocal("p2")))),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),a.ret(a.i32_const(0))),a.if(a.call(i+"_isOne",c),a.ret(a.call(e+"_eqAffine",a.getLocal("p1"),a.getLocal("p2")))),a.call(i+"_square",c,d),a.call(i+"_mul",l,d,f),a.call(i+"_mul",c,d,h),a.call(i+"_mul",u,h,g),a.if(a.call(i+"_eq",r,f),a.if(a.call(i+"_eq",s,g),a.ret(a.i32_const(1)))),a.ret(a.i32_const(0)))}(),function(){const n=t.addFunction(e+"_eq");n.addParam("p1","i32"),n.addParam("p2","i32"),n.setReturnType("i32"),n.addLocal("z1","i32"),n.addLocal("z2","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));n.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),u=a.i32_add(a.getLocal("p2"),a.i32_const(o));n.addCode(a.setLocal("z2",a.i32_add(a.getLocal("p2"),a.i32_const(2*o))));const d=a.getLocal("z2"),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.ret(a.call(e+"_isZero",a.getLocal("p2")))),a.if(a.call(e+"_isZero",a.getLocal("p2")),a.ret(a.i32_const(0))),a.if(a.call(i+"_isOne",c),a.ret(a.call(e+"_eqMixed",a.getLocal("p2"),a.getLocal("p1")))),a.if(a.call(i+"_isOne",d),a.ret(a.call(e+"_eqMixed",a.getLocal("p1"),a.getLocal("p2")))),a.call(i+"_square",c,f),a.call(i+"_square",d,h),a.call(i+"_mul",r,h,g),a.call(i+"_mul",l,f,p),a.call(i+"_mul",c,f,_),a.call(i+"_mul",d,h,m),a.call(i+"_mul",s,m,L),a.call(i+"_mul",u,_,w),a.if(a.call(i+"_eq",g,p),a.if(a.call(i+"_eq",L,w),a.ret(a.i32_const(1)))),a.ret(a.i32_const(0)))}(),function(){const n=t.addFunction(e+"_doubleAffine");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),d=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),[...a.call(e+"_toJacobian",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.call(i+"_square",r,d),a.call(i+"_square",s,f),a.call(i+"_square",f,h),a.call(i+"_add",r,f,g),a.call(i+"_square",g,g),a.call(i+"_sub",g,d,g),a.call(i+"_sub",g,h,g),a.call(i+"_add",g,g,g),a.call(i+"_add",d,d,p),a.call(i+"_add",p,d,p),a.call(i+"_add",s,s,u),a.call(i+"_square",p,c),a.call(i+"_sub",c,g,c),a.call(i+"_sub",c,g,c),a.call(i+"_add",h,h,_),a.call(i+"_add",_,_,_),a.call(i+"_add",_,_,_),a.call(i+"_sub",g,c,l),a.call(i+"_mul",l,p,l),a.call(i+"_sub",l,_,l))}(),function(){const n=t.addFunction(e+"_double");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),u=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(i+"_isOne",c),[...a.ret(a.call(e+"_doubleAffine",a.getLocal("p1"),a.getLocal("pr"))),...a.ret([])]),a.call(i+"_square",r,f),a.call(i+"_square",s,h),a.call(i+"_square",h,g),a.call(i+"_add",r,h,p),a.call(i+"_square",p,p),a.call(i+"_sub",p,f,p),a.call(i+"_sub",p,g,p),a.call(i+"_add",p,p,p),a.call(i+"_add",f,f,_),a.call(i+"_add",_,f,_),a.call(i+"_square",_,m),a.call(i+"_mul",s,c,L),a.call(i+"_add",p,p,l),a.call(i+"_sub",m,l,l),a.call(i+"_add",g,g,w),a.call(i+"_add",w,w,w),a.call(i+"_add",w,w,w),a.call(i+"_sub",p,l,u),a.call(i+"_mul",u,_,u),a.call(i+"_sub",u,w,u),a.call(i+"_add",L,L,d))}(),function(){const n=t.addFunction(e+"_addAffine");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32"),n.addLocal("z1","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));n.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("p2"),l=a.i32_add(a.getLocal("p2"),a.i32_const(o)),u=a.getLocal("pr"),d=a.i32_add(a.getLocal("pr"),a.i32_const(o)),f=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),[...a.call(e+"_copyAffine",a.getLocal("p2"),a.getLocal("pr")),...a.call(i+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),[...a.call(e+"_copyAffine",a.getLocal("p1"),a.getLocal("pr")),...a.call(i+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(i+"_eq",r,c),a.if(a.call(i+"_eq",s,l),[...a.call(e+"_doubleAffine",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])])),a.call(i+"_sub",c,r,h),a.call(i+"_sub",l,s,p),a.call(i+"_square",h,g),a.call(i+"_add",g,g,_),a.call(i+"_add",_,_,_),a.call(i+"_mul",h,_,m),a.call(i+"_add",p,p,L),a.call(i+"_mul",r,_,b),a.call(i+"_square",L,w),a.call(i+"_add",b,b,y),a.call(i+"_sub",w,m,u),a.call(i+"_sub",u,y,u),a.call(i+"_mul",s,m,A),a.call(i+"_add",A,A,A),a.call(i+"_sub",b,u,d),a.call(i+"_mul",d,L,d),a.call(i+"_sub",d,A,d),a.call(i+"_add",h,h,f))}(),function(){const n=t.addFunction(e+"_addMixed");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32"),n.addLocal("z1","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));n.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),u=a.i32_add(a.getLocal("p2"),a.i32_const(o)),d=a.getLocal("pr"),f=a.i32_add(a.getLocal("pr"),a.i32_const(o)),h=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),g=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o)),I=a.i32_const(t.alloc(o)),C=a.i32_const(t.alloc(o)),v=a.i32_const(t.alloc(o)),F=a.i32_const(t.alloc(o)),x=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copyAffine",a.getLocal("p2"),a.getLocal("pr")),...a.call(i+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(i+"_isOne",c),[...a.call(e+"_addAffine",r,l,d),...a.ret([])]),a.call(i+"_square",c,g),a.call(i+"_mul",l,g,p),a.call(i+"_mul",c,g,_),a.call(i+"_mul",u,_,m),a.if(a.call(i+"_eq",r,p),a.if(a.call(i+"_eq",s,m),[...a.call(e+"_doubleAffine",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])])),a.call(i+"_sub",p,r,L),a.call(i+"_sub",m,s,b),a.call(i+"_square",L,w),a.call(i+"_add",w,w,y),a.call(i+"_add",y,y,y),a.call(i+"_mul",L,y,A),a.call(i+"_add",b,b,I),a.call(i+"_mul",r,y,v),a.call(i+"_square",I,C),a.call(i+"_add",v,v,F),a.call(i+"_sub",C,A,d),a.call(i+"_sub",d,F,d),a.call(i+"_mul",s,A,x),a.call(i+"_add",x,x,x),a.call(i+"_sub",v,d,f),a.call(i+"_mul",f,I,f),a.call(i+"_sub",f,x,f),a.call(i+"_add",c,L,h),a.call(i+"_square",h,h),a.call(i+"_sub",h,g,h),a.call(i+"_sub",h,w,h))}(),function(){const n=t.addFunction(e+"_add");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32"),n.addLocal("z1","i32"),n.addLocal("z2","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));n.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),u=a.i32_add(a.getLocal("p2"),a.i32_const(o));n.addCode(a.setLocal("z2",a.i32_add(a.getLocal("p2"),a.i32_const(2*o))));const d=a.getLocal("z2"),f=a.getLocal("pr"),h=a.i32_add(a.getLocal("pr"),a.i32_const(o)),g=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),p=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o)),I=a.i32_const(t.alloc(o)),C=a.i32_const(t.alloc(o)),v=a.i32_const(t.alloc(o)),F=a.i32_const(t.alloc(o)),x=a.i32_const(t.alloc(o)),B=a.i32_const(t.alloc(o)),E=a.i32_const(t.alloc(o)),S=a.i32_const(t.alloc(o)),O=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copy",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(e+"_isZero",a.getLocal("p2")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(i+"_isOne",c),[...a.call(e+"_addMixed",l,r,f),...a.ret([])]),a.if(a.call(i+"_isOne",d),[...a.call(e+"_addMixed",r,l,f),...a.ret([])]),a.call(i+"_square",c,p),a.call(i+"_square",d,_),a.call(i+"_mul",r,_,m),a.call(i+"_mul",l,p,L),a.call(i+"_mul",c,p,w),a.call(i+"_mul",d,_,b),a.call(i+"_mul",s,b,y),a.call(i+"_mul",u,w,A),a.if(a.call(i+"_eq",m,L),a.if(a.call(i+"_eq",y,A),[...a.call(e+"_double",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])])),a.call(i+"_sub",L,m,I),a.call(i+"_sub",A,y,C),a.call(i+"_add",I,I,v),a.call(i+"_square",v,v),a.call(i+"_mul",I,v,F),a.call(i+"_add",C,C,x),a.call(i+"_mul",m,v,E),a.call(i+"_square",x,B),a.call(i+"_add",E,E,S),a.call(i+"_sub",B,F,f),a.call(i+"_sub",f,S,f),a.call(i+"_mul",y,F,O),a.call(i+"_add",O,O,O),a.call(i+"_sub",E,f,h),a.call(i+"_mul",h,x,h),a.call(i+"_sub",h,O,h),a.call(i+"_add",c,d,g),a.call(i+"_square",g,g),a.call(i+"_sub",g,p,g),a.call(i+"_sub",g,_,g),a.call(i+"_mul",g,I,g))}(),function(){const n=t.addFunction(e+"_negAffine");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o));n.addCode(a.call(i+"_copy",r,c),a.call(i+"_neg",s,l))}(),function(){const n=t.addFunction(e+"_neg");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),u=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_add(a.getLocal("pr"),a.i32_const(2*o));n.addCode(a.call(i+"_copy",r,l),a.call(i+"_neg",s,u),a.call(i+"_copy",c,d))}(),function(){const i=t.addFunction(e+"_subAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32");const n=i.getCodeBuilder(),a=n.i32_const(t.alloc(3*o));i.addCode(n.call(e+"_negAffine",n.getLocal("p2"),a),n.call(e+"_addAffine",n.getLocal("p1"),a,n.getLocal("pr")))}(),function(){const i=t.addFunction(e+"_subMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32");const n=i.getCodeBuilder(),a=n.i32_const(t.alloc(3*o));i.addCode(n.call(e+"_negAffine",n.getLocal("p2"),a),n.call(e+"_addMixed",n.getLocal("p1"),a,n.getLocal("pr")))}(),function(){const i=t.addFunction(e+"_sub");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32");const n=i.getCodeBuilder(),a=n.i32_const(t.alloc(3*o));i.addCode(n.call(e+"_neg",n.getLocal("p2"),a),n.call(e+"_add",n.getLocal("p1"),a,n.getLocal("pr")))}(),function(){const n=t.addFunction(e+"_fromMontgomeryAffine");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_fromMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<2;t++)n.addCode(a.call(i+"_fromMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const n=t.addFunction(e+"_fromMontgomery");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_fromMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<3;t++)n.addCode(a.call(i+"_fromMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const n=t.addFunction(e+"_toMontgomeryAffine");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_toMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<2;t++)n.addCode(a.call(i+"_toMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const n=t.addFunction(e+"_toMontgomery");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.call(i+"_toMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<3;t++)n.addCode(a.call(i+"_toMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const n=t.addFunction(e+"_toAffine");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),u=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(i+"_zero",l),...a.call(i+"_zero",u)],[...a.call(i+"_inverse",c,d),...a.call(i+"_square",d,f),...a.call(i+"_mul",d,f,h),...a.call(i+"_mul",r,f,l),...a.call(i+"_mul",s,h,u)]))}(),function(){const a=t.addFunction(e+"_inCurveAffine");a.addParam("pIn","i32"),a.setReturnType("i32");const r=a.getCodeBuilder(),s=r.getLocal("pIn"),c=r.i32_add(r.getLocal("pIn"),r.i32_const(o)),l=r.i32_const(t.alloc(o)),u=r.i32_const(t.alloc(o));a.addCode(r.call(i+"_square",c,l),r.call(i+"_square",s,u),r.call(i+"_mul",s,u,u),r.call(i+"_add",u,r.i32_const(n),u),r.ret(r.call(i+"_eq",l,u)))}(),function(){const i=t.addFunction(e+"_inCurve");i.addParam("pIn","i32"),i.setReturnType("i32");const n=i.getCodeBuilder(),a=n.i32_const(t.alloc(2*o));i.addCode(n.call(e+"_toAffine",n.getLocal("pIn"),a),n.ret(n.call(e+"_inCurveAffine",a)))}(),function(){const n=t.addFunction(e+"_batchToAffine");n.addParam("pIn","i32"),n.addParam("n","i32"),n.addParam("pOut","i32"),n.addLocal("pAux","i32"),n.addLocal("itIn","i32"),n.addLocal("itAux","i32"),n.addLocal("itOut","i32"),n.addLocal("i","i32");const a=n.getCodeBuilder(),r=a.i32_const(t.alloc(o));n.addCode(a.setLocal("pAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("pAux"),a.i32_mul(a.getLocal("n"),a.i32_const(o)))),a.call(i+"_batchInverse",a.i32_add(a.getLocal("pIn"),a.i32_const(2*o)),a.i32_const(3*o),a.getLocal("n"),a.getLocal("pAux"),a.i32_const(o)),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.getLocal("pAux")),a.setLocal("itOut",a.getLocal("pOut")),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(i+"_isZero",a.getLocal("itAux")),[...a.call(i+"_zero",a.getLocal("itOut")),...a.call(i+"_zero",a.i32_add(a.getLocal("itOut"),a.i32_const(o)))],[...a.call(i+"_mul",a.getLocal("itAux"),a.i32_add(a.getLocal("itIn"),a.i32_const(o)),r),...a.call(i+"_square",a.getLocal("itAux"),a.getLocal("itAux")),...a.call(i+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.getLocal("itOut")),...a.call(i+"_mul",a.getLocal("itAux"),r,a.i32_add(a.getLocal("itOut"),a.i32_const(o)))]),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.i32_const(3*o))),a.setLocal("itOut",a.i32_add(a.getLocal("itOut"),a.i32_const(2*o))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(o))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.i32_store(a.i32_const(0),a.getLocal("pAux")))}(),function(){const n=t.addFunction(e+"_normalize");n.addParam("p1","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),u=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.call(e+"_zero",a.getLocal("pr")),[...a.call(i+"_inverse",c,f),...a.call(i+"_square",f,h),...a.call(i+"_mul",f,h,g),...a.call(i+"_mul",r,h,l),...a.call(i+"_mul",s,g,u),...a.call(i+"_one",d)]))}(),function(){const i=t.addFunction(e+"__reverseBytes");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("itOut","i32"),i.addLocal("itIn","i32");const n=i.getCodeBuilder();i.addCode(n.setLocal("itOut",n.i32_sub(n.i32_add(n.getLocal("pOut"),n.getLocal("n")),n.i32_const(1))),n.setLocal("itIn",n.getLocal("pIn")),n.block(n.loop(n.br_if(1,n.i32_lt_s(n.getLocal("itOut"),n.getLocal("pOut"))),n.i32_store8(n.getLocal("itOut"),n.i32_load8_u(n.getLocal("itIn"))),n.setLocal("itOut",n.i32_sub(n.getLocal("itOut"),n.i32_const(1))),n.setLocal("itIn",n.i32_add(n.getLocal("itIn"),n.i32_const(1))),n.br(0))))}(),function(){const i=t.addFunction(e+"_LEMtoU");i.addParam("pIn","i32"),i.addParam("pOut","i32");const n=i.getCodeBuilder(),a=t.alloc(2*o),r=n.i32_const(a),s=n.i32_const(a),c=n.i32_const(a+o);i.addCode(n.if(n.call(e+"_isZeroAffine",n.getLocal("pIn")),[...n.call(e+"_zeroAffine",n.getLocal("pOut")),...n.i32_store8(n.getLocal("pOut"),n.i32_const(64)),...n.ret([])]),n.call(e+"_fromMontgomeryAffine",n.getLocal("pIn"),r),n.call(e+"__reverseBytes",s,n.i32_const(o),n.getLocal("pOut")),n.call(e+"__reverseBytes",c,n.i32_const(o),n.i32_add(n.getLocal("pOut"),n.i32_const(o))))}(),function(){const n=t.addFunction(e+"_LEMtoC");n.addParam("pIn","i32"),n.addParam("pOut","i32");const a=n.getCodeBuilder(),r=a.i32_const(t.alloc(o));n.addCode(a.if(a.call(e+"_isZero",a.getLocal("pIn")),[...a.call(i+"_zero",a.getLocal("pOut")),...a.i32_store8(a.getLocal("pOut"),a.i32_const(64)),...a.ret([])]),a.call(i+"_fromMontgomery",a.getLocal("pIn"),r),a.call(e+"__reverseBytes",r,a.i32_const(o),a.getLocal("pOut")),a.if(a.i32_eq(a.call(i+"_sign",a.i32_add(a.getLocal("pIn"),a.i32_const(o))),a.i32_const(-1)),a.i32_store8(a.getLocal("pOut"),a.i32_or(a.i32_load8_u(a.getLocal("pOut")),a.i32_const(128)))))}(),function(){const i=t.addFunction(e+"_UtoLEM");i.addParam("pIn","i32"),i.addParam("pOut","i32");const n=i.getCodeBuilder(),a=t.alloc(2*o),r=n.i32_const(a),s=n.i32_const(a),c=n.i32_const(a+o);i.addCode(n.if(n.i32_and(n.i32_load8_u(n.getLocal("pIn")),n.i32_const(64)),[...n.call(e+"_zeroAffine",n.getLocal("pOut")),...n.ret([])]),n.call(e+"__reverseBytes",n.getLocal("pIn"),n.i32_const(o),s),n.call(e+"__reverseBytes",n.i32_add(n.getLocal("pIn"),n.i32_const(o)),n.i32_const(o),c),n.call(e+"_toMontgomeryAffine",r,n.getLocal("pOut")))}(),function(){const a=t.addFunction(e+"_CtoLEM");a.addParam("pIn","i32"),a.addParam("pOut","i32"),a.addLocal("firstByte","i32"),a.addLocal("greatest","i32");const r=a.getCodeBuilder(),s=t.alloc(2*o),c=r.i32_const(s),l=r.i32_const(s+o);a.addCode(r.setLocal("firstByte",r.i32_load8_u(r.getLocal("pIn"))),r.if(r.i32_and(r.getLocal("firstByte"),r.i32_const(64)),[...r.call(e+"_zeroAffine",r.getLocal("pOut")),...r.ret([])]),r.setLocal("greatest",r.i32_and(r.getLocal("firstByte"),r.i32_const(128))),r.call(i+"_copy",r.getLocal("pIn"),l),r.i32_store8(l,r.i32_and(r.getLocal("firstByte"),r.i32_const(63))),r.call(e+"__reverseBytes",l,r.i32_const(o),c),r.call(i+"_toMontgomery",c,r.getLocal("pOut")),r.call(i+"_square",r.getLocal("pOut"),l),r.call(i+"_mul",r.getLocal("pOut"),l,l),r.call(i+"_add",l,r.i32_const(n),l),r.call(i+"_sqrt",l,l),r.call(i+"_neg",l,c),r.if(r.i32_eq(r.call(i+"_sign",l),r.i32_const(-1)),r.if(r.getLocal("greatest"),r.call(i+"_copy",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))),r.call(i+"_neg",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o)))),r.if(r.getLocal("greatest"),r.call(i+"_neg",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))),r.call(i+"_copy",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))))))}(),Ut(t,e+"_batchLEMtoU",e+"_LEMtoU",2*o,2*o),Ut(t,e+"_batchLEMtoC",e+"_LEMtoC",2*o,o),Ut(t,e+"_batchUtoLEM",e+"_UtoLEM",2*o,2*o),Ut(t,e+"_batchCtoLEM",e+"_CtoLEM",o,2*o,!0),Ut(t,e+"_batchToJacobian",e+"_toJacobian",2*o,3*o,!0),kt(t,e,e+"_multiexp",e+"_add",3*o),kt(t,e,e+"_multiexpAffine",e+"_addMixed",2*o),Rt(t,e+"_timesScalar",3*o,e+"_add",e+"_double",e+"_sub",e+"_copy",e+"_zero"),Rt(t,e+"_timesScalarAffine",2*o,e+"_addMixed",e+"_double",e+"_subMixed",e+"_copyAffine",e+"_zero"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isZeroAffine"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_eqMixed"),t.exportFunction(e+"_eqAffine"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_copyAffine"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_zeroAffine"),t.exportFunction(e+"_double"),t.exportFunction(e+"_doubleAffine"),t.exportFunction(e+"_add"),t.exportFunction(e+"_addMixed"),t.exportFunction(e+"_addAffine"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_negAffine"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_subMixed"),t.exportFunction(e+"_subAffine"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_fromMontgomeryAffine"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_toMontgomeryAffine"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_timesScalarAffine"),t.exportFunction(e+"_normalize"),t.exportFunction(e+"_LEMtoU"),t.exportFunction(e+"_LEMtoC"),t.exportFunction(e+"_UtoLEM"),t.exportFunction(e+"_CtoLEM"),t.exportFunction(e+"_batchLEMtoU"),t.exportFunction(e+"_batchLEMtoC"),t.exportFunction(e+"_batchUtoLEM"),t.exportFunction(e+"_batchCtoLEM"),t.exportFunction(e+"_toAffine"),t.exportFunction(e+"_toJacobian"),t.exportFunction(e+"_batchToAffine"),t.exportFunction(e+"_batchToJacobian"),t.exportFunction(e+"_inCurve"),t.exportFunction(e+"_inCurveAffine"),e},Dt=function(t,e,i,n,a){const o=8*t.modules[n].n64,r=8*t.modules[i].n64,s=t.modules[n].q;let c=s.minus(d(1)),l=0;for(;!c.isOdd();)l++,c=c.shiftRight(1);let u=d(2);for(;u.modPow(s.shiftRight(1),s).equals(1);)u=u.add(1);const f=new Array(l+1);f[l]=u.modPow(c,s);let h=l-1;for(;h>=0;)f[h]=f[h+1].modPow(2,s),h--;const g=[],p=d(1).shiftLeft(8*o).mod(s);for(let t=0;t<f.length;t++){const e=f[t].times(p).mod(s);g.push(...St(e,o))}const _=t.alloc(g),m=new Array(l+1);m[0]=d(1);for(let t=1;t<=l;t++)m[t]=m[t-1].times(2);const L=[];for(let t=0;t<=l;t++){const e=m[t].modInv(s).times(p).mod(s);L.push(...St(e,o))}const w=t.alloc(L),b=u.modPow(2,s),y=[],A=[];for(let t=0;t<=l;t++){const e=b.modPow(d(2).pow(t),s),i=s.add(d.one).minus(e).modInv(s);y.push(...St(e.times(p).mod(s),o)),A.push(...St(i.times(p).mod(s),o))}const I=t.alloc(y),C=t.alloc(A);function v(t){let e=0;for(let i=0;i<8;i++)t&1<<i&&(e|=128>>i);return e}const F=Array(256);for(let t=0;t<256;t++)F[t]=v(t);const x=t.alloc(F);function B(){const i=t.addFunction(e+"_fft");i.addParam("px","i32"),i.addParam("n","i32"),i.addLocal("bits","i32");const a=i.getCodeBuilder(),r=a.i32_const(t.alloc(o));i.addCode(a.setLocal("bits",a.call(e+"__log2",a.getLocal("n"))),a.call(n+"_one",r),a.call(e+"_rawfft",a.getLocal("px"),a.getLocal("bits"),a.i32_const(0),r))}!function(){const i=t.addFunction(e+"__rev");i.addParam("x","i32"),i.addParam("bits","i32"),i.setReturnType("i32");const n=i.getCodeBuilder();i.addCode(n.i32_rotl(n.i32_add(n.i32_add(n.i32_shl(n.i32_load8_u(n.i32_and(n.getLocal("x"),n.i32_const(255)),x,0),n.i32_const(24)),n.i32_shl(n.i32_load8_u(n.i32_and(n.i32_shr_u(n.getLocal("x"),n.i32_const(8)),n.i32_const(255)),x,0),n.i32_const(16))),n.i32_add(n.i32_shl(n.i32_load8_u(n.i32_and(n.i32_shr_u(n.getLocal("x"),n.i32_const(16)),n.i32_const(255)),x,0),n.i32_const(8)),n.i32_load8_u(n.i32_and(n.i32_shr_u(n.getLocal("x"),n.i32_const(24)),n.i32_const(255)),x,0))),n.getLocal("bits")))}(),function(){const n=t.addFunction(e+"__reversePermutation");n.addParam("px","i32"),n.addParam("bits","i32"),n.addLocal("n","i32"),n.addLocal("i","i32"),n.addLocal("ri","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(r));n.addCode(a.setLocal("n",a.i32_shl(a.i32_const(1),a.getLocal("bits"))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.setLocal("idx1",a.i32_add(a.getLocal("px"),a.i32_mul(a.getLocal("i"),a.i32_const(r)))),a.setLocal("ri",a.call(e+"__rev",a.getLocal("i"),a.getLocal("bits"))),a.setLocal("idx2",a.i32_add(a.getLocal("px"),a.i32_mul(a.getLocal("ri"),a.i32_const(r)))),a.if(a.i32_lt_u(a.getLocal("i"),a.getLocal("ri")),[...a.call(i+"_copy",a.getLocal("idx1"),o),...a.call(i+"_copy",a.getLocal("idx2"),a.getLocal("idx1")),...a.call(i+"_copy",o,a.getLocal("idx2"))]),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))))}(),function(){const o=t.addFunction(e+"__fftFinal");o.addParam("px","i32"),o.addParam("bits","i32"),o.addParam("reverse","i32"),o.addParam("mulFactor","i32"),o.addLocal("n","i32"),o.addLocal("ndiv2","i32"),o.addLocal("pInv2","i32"),o.addLocal("i","i32"),o.addLocal("mask","i32"),o.addLocal("idx1","i32"),o.addLocal("idx2","i32");const s=o.getCodeBuilder(),c=s.i32_const(t.alloc(r));o.addCode(s.if(s.i32_and(s.i32_eqz(s.getLocal("reverse")),s.call(n+"_isOne",s.getLocal("mulFactor"))),s.ret([])),s.setLocal("n",s.i32_shl(s.i32_const(1),s.getLocal("bits"))),s.setLocal("mask",s.i32_sub(s.getLocal("n"),s.i32_const(1))),s.setLocal("i",s.i32_const(1)),s.setLocal("ndiv2",s.i32_shr_u(s.getLocal("n"),s.i32_const(1))),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("i"),s.getLocal("ndiv2"))),s.setLocal("idx1",s.i32_add(s.getLocal("px"),s.i32_mul(s.getLocal("i"),s.i32_const(r)))),s.setLocal("idx2",s.i32_add(s.getLocal("px"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.getLocal("i")),s.i32_const(r)))),s.if(s.getLocal("reverse"),s.if(s.call(n+"_isOne",s.getLocal("mulFactor")),[...s.call(i+"_copy",s.getLocal("idx1"),c),...s.call(i+"_copy",s.getLocal("idx2"),s.getLocal("idx1")),...s.call(i+"_copy",c,s.getLocal("idx2"))],[...s.call(i+"_copy",s.getLocal("idx1"),c),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx1")),...s.call(a,c,s.getLocal("mulFactor"),s.getLocal("idx2"))]),s.if(s.call(n+"_isOne",s.getLocal("mulFactor")),[],[...s.call(a,s.getLocal("idx1"),s.getLocal("mulFactor"),s.getLocal("idx1")),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx2"))])),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.call(n+"_isOne",s.getLocal("mulFactor")),[],[...s.call(a,s.getLocal("px"),s.getLocal("mulFactor"),s.getLocal("px")),...s.setLocal("idx2",s.i32_add(s.getLocal("px"),s.i32_mul(s.getLocal("ndiv2"),s.i32_const(r)))),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx2"))]))}(),function(){const s=t.addFunction(e+"_rawfft");s.addParam("px","i32"),s.addParam("bits","i32"),s.addParam("reverse","i32"),s.addParam("mulFactor","i32"),s.addLocal("s","i32"),s.addLocal("k","i32"),s.addLocal("j","i32"),s.addLocal("m","i32"),s.addLocal("mdiv2","i32"),s.addLocal("n","i32"),s.addLocal("pwm","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r)),d=c.i32_const(t.alloc(r));s.addCode(c.call(e+"__reversePermutation",c.getLocal("px"),c.getLocal("bits")),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("s",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.i32_gt_u(c.getLocal("s"),c.getLocal("bits"))),c.setLocal("m",c.i32_shl(c.i32_const(1),c.getLocal("s"))),c.setLocal("pwm",c.i32_add(c.i32_const(_),c.i32_mul(c.getLocal("s"),c.i32_const(o)))),c.setLocal("k",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("k"),c.getLocal("n"))),c.call(n+"_one",l),c.setLocal("mdiv2",c.i32_shr_u(c.getLocal("m"),c.i32_const(1))),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("j"),c.getLocal("mdiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_add(c.getLocal("k"),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.i32_mul(c.getLocal("mdiv2"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,u),c.call(i+"_copy",c.getLocal("idx1"),d),c.call(i+"_add",d,u,c.getLocal("idx1")),c.call(i+"_sub",d,u,c.getLocal("idx2")),c.call(n+"_mul",l,c.getLocal("pwm"),l),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("k",c.i32_add(c.getLocal("k"),c.getLocal("m"))),c.br(0))),c.setLocal("s",c.i32_add(c.getLocal("s"),c.i32_const(1))),c.br(0))),c.call(e+"__fftFinal",c.getLocal("px"),c.getLocal("bits"),c.getLocal("reverse"),c.getLocal("mulFactor")))}(),function(){const i=t.addFunction(e+"__log2");i.addParam("n","i32"),i.setReturnType("i32"),i.addLocal("bits","i32"),i.addLocal("aux","i32");const n=i.getCodeBuilder();i.addCode(n.setLocal("aux",n.i32_shr_u(n.getLocal("n"),n.i32_const(1)))),i.addCode(n.setLocal("bits",n.i32_const(0))),i.addCode(n.block(n.loop(n.br_if(1,n.i32_eqz(n.getLocal("aux"))),n.setLocal("aux",n.i32_shr_u(n.getLocal("aux"),n.i32_const(1))),n.setLocal("bits",n.i32_add(n.getLocal("bits"),n.i32_const(1))),n.br(0)))),i.addCode(n.if(n.i32_ne(n.getLocal("n"),n.i32_shl(n.i32_const(1),n.getLocal("bits"))),n.unreachable())),i.addCode(n.if(n.i32_gt_u(n.getLocal("bits"),n.i32_const(l)),n.unreachable())),i.addCode(n.getLocal("bits"))}(),B(),function(){const i=t.addFunction(e+"_ifft");i.addParam("px","i32"),i.addParam("n","i32"),i.addLocal("bits","i32"),i.addLocal("pInv2","i32");const n=i.getCodeBuilder();i.addCode(n.setLocal("bits",n.call(e+"__log2",n.getLocal("n"))),n.setLocal("pInv2",n.i32_add(n.i32_const(w),n.i32_mul(n.getLocal("bits"),n.i32_const(o)))),n.call(e+"_rawfft",n.getLocal("px"),n.getLocal("bits"),n.i32_const(1),n.getLocal("pInv2")))}(),function(){const s=t.addFunction(e+"_fftJoin");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r)),d=c.i32_const(t.alloc(r));s.addCode(c.call(n+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,u),c.call(i+"_copy",c.getLocal("idx1"),d),c.call(i+"_add",d,u,c.getLocal("idx1")),c.call(i+"_sub",d,u,c.getLocal("idx2")),c.call(n+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftJoinExt");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(n+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(i+"_add",c.getLocal("idx1"),c.getLocal("idx2"),u),c.call(a,c.getLocal("idx2"),c.getLocal("pShiftToM"),c.getLocal("idx2")),c.call(i+"_add",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(a,c.getLocal("idx2"),l,c.getLocal("idx2")),c.call(i+"_copy",u,c.getLocal("idx1")),c.call(n+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftJoinExtInv");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32"),s.addLocal("pSConst","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.setLocal("pSConst",c.i32_add(c.i32_const(C),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(n+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,u),c.call(i+"_sub",c.getLocal("idx1"),u,c.getLocal("idx2")),c.call(a,c.getLocal("idx2"),c.getLocal("pSConst"),c.getLocal("idx2")),c.call(a,c.getLocal("idx1"),c.getLocal("pShiftToM"),c.getLocal("idx1")),c.call(i+"_sub",u,c.getLocal("idx1"),c.getLocal("idx1")),c.call(a,c.getLocal("idx1"),c.getLocal("pSConst"),c.getLocal("idx1")),c.call(n+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftMix");s.addParam("pBuff","i32"),s.addParam("n","i32"),s.addParam("exp","i32"),s.addLocal("nGroups","i32"),s.addLocal("nPerGroup","i32"),s.addLocal("nPerGroupDiv2","i32"),s.addLocal("pairOffset","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("j","i32"),s.addLocal("pwm","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r)),d=c.i32_const(t.alloc(r));s.addCode(c.setLocal("nPerGroup",c.i32_shl(c.i32_const(1),c.getLocal("exp"))),c.setLocal("nPerGroupDiv2",c.i32_shr_u(c.getLocal("nPerGroup"),c.i32_const(1))),c.setLocal("nGroups",c.i32_shr_u(c.getLocal("n"),c.getLocal("exp"))),c.setLocal("pairOffset",c.i32_mul(c.getLocal("nPerGroupDiv2"),c.i32_const(r))),c.setLocal("pwm",c.i32_add(c.i32_const(_),c.i32_mul(c.getLocal("exp"),c.i32_const(o)))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nGroups"))),c.call(n+"_one",l),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("j"),c.getLocal("nPerGroupDiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_add(c.i32_mul(c.getLocal("i"),c.getLocal("nPerGroup")),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.getLocal("pairOffset"))),c.call(a,c.getLocal("idx2"),l,u),c.call(i+"_copy",c.getLocal("idx1"),d),c.call(i+"_add",d,u,c.getLocal("idx1")),c.call(i+"_sub",d,u,c.getLocal("idx2")),c.call(n+"_mul",l,c.getLocal("pwm"),l),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const n=t.addFunction(e+"_fftFinal");n.addParam("pBuff","i32"),n.addParam("n","i32"),n.addParam("factor","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32"),n.addLocal("i","i32"),n.addLocal("ndiv2","i32");const o=n.getCodeBuilder(),s=o.i32_const(t.alloc(r));n.addCode(o.setLocal("ndiv2",o.i32_shr_u(o.getLocal("n"),o.i32_const(1))),o.if(o.i32_and(o.getLocal("n"),o.i32_const(1)),o.call(a,o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(r))),o.getLocal("factor"),o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(r))))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("i"),o.getLocal("ndiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("i"),o.i32_const(r)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.i32_sub(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("i")),o.i32_const(r)))),o.call(a,o.getLocal("idx2"),o.getLocal("factor"),s),o.call(a,o.getLocal("idx1"),o.getLocal("factor"),o.getLocal("idx2")),o.call(i+"_copy",s,o.getLocal("idx1")),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){const s=t.addFunction(e+"_prepareLagrangeEvaluation");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32"),s.addLocal("pSConst","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.setLocal("pSConst",c.i32_add(c.i32_const(C),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(n+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx1"),c.getLocal("pShiftToM"),u),c.call(i+"_sub",c.getLocal("idx2"),u,u),c.call(i+"_sub",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(a,u,c.getLocal("pSConst"),c.getLocal("idx1")),c.call(a,c.getLocal("idx2"),l,c.getLocal("idx2")),c.call(n+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),t.exportFunction(e+"_fft"),t.exportFunction(e+"_ifft"),t.exportFunction(e+"_rawfft"),t.exportFunction(e+"_fftJoin"),t.exportFunction(e+"_fftJoinExt"),t.exportFunction(e+"_fftJoinExtInv"),t.exportFunction(e+"_fftMix"),t.exportFunction(e+"_fftFinal"),t.exportFunction(e+"_prepareLagrangeEvaluation")},jt=function(t,e,i){const n=8*t.modules[i].n64;return function(){const a=t.addFunction(e+"_zero");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("lastp","i32"),a.addLocal("p","i32");const o=a.getCodeBuilder();a.addCode(o.setLocal("p",o.getLocal("px")),o.setLocal("lastp",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("p"),o.getLocal("lastp"))),o.call(i+"_zero",o.getLocal("p")),o.setLocal("p",o.i32_add(o.getLocal("p"),o.i32_const(n))),o.br(0))))}(),function(){const a=t.addFunction(e+"_constructLC");a.addParam("ppolynomials","i32"),a.addParam("psignals","i32"),a.addParam("nSignals","i32"),a.addParam("pres","i32"),a.addLocal("i","i32"),a.addLocal("j","i32"),a.addLocal("pp","i32"),a.addLocal("ps","i32"),a.addLocal("pd","i32"),a.addLocal("ncoefs","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(n));a.addCode(o.setLocal("i",o.i32_const(0)),o.setLocal("pp",o.getLocal("ppolynomials")),o.setLocal("ps",o.getLocal("psignals")),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("nSignals"))),o.setLocal("ncoefs",o.i32_load(o.getLocal("pp"))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("ncoefs"))),o.setLocal("pd",o.i32_add(o.getLocal("pres"),o.i32_mul(o.i32_load(o.getLocal("pp")),o.i32_const(n)))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.call(i+"_mul",o.getLocal("ps"),o.getLocal("pp"),r),o.call(i+"_add",r,o.getLocal("pd"),o.getLocal("pd")),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(n))),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("ps",o.i32_add(o.getLocal("ps"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),t.exportFunction(e+"_zero"),t.exportFunction(e+"_constructLC"),e},Vt=function(t,e,i){const n=8*t.modules[i].n64;return function(){const a=t.addFunction(e+"_buildABC");a.addParam("pCoefs","i32"),a.addParam("nCoefs","i32"),a.addParam("pWitness","i32"),a.addParam("pA","i32"),a.addParam("pB","i32"),a.addParam("pC","i32"),a.addParam("offsetOut","i32"),a.addParam("nOut","i32"),a.addParam("offsetWitness","i32"),a.addParam("nWitness","i32"),a.addLocal("it","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("last","i32"),a.addLocal("m","i32"),a.addLocal("c","i32"),a.addLocal("s","i32"),a.addLocal("pOut","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(n));a.addCode(o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("nOut"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(i+"_zero",o.getLocal("ita")),o.call(i+"_zero",o.getLocal("itb")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(n))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(n))),o.br(0))),o.setLocal("it",o.getLocal("pCoefs")),o.setLocal("last",o.i32_add(o.getLocal("pCoefs"),o.i32_mul(o.getLocal("nCoefs"),o.i32_const(n+12)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it"),o.getLocal("last"))),o.setLocal("s",o.i32_load(o.getLocal("it"),8)),o.if(o.i32_or(o.i32_lt_u(o.getLocal("s"),o.getLocal("offsetWitness")),o.i32_ge_u(o.getLocal("s"),o.i32_add(o.getLocal("offsetWitness"),o.getLocal("nWitness")))),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(n+12))),...o.br(1)]),o.setLocal("m",o.i32_load(o.getLocal("it"))),o.if(o.i32_eq(o.getLocal("m"),o.i32_const(0)),o.setLocal("pOut",o.getLocal("pA")),o.if(o.i32_eq(o.getLocal("m"),o.i32_const(1)),o.setLocal("pOut",o.getLocal("pB")),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(n+12))),...o.br(1)])),o.setLocal("c",o.i32_load(o.getLocal("it"),4)),o.if(o.i32_or(o.i32_lt_u(o.getLocal("c"),o.getLocal("offsetOut")),o.i32_ge_u(o.getLocal("c"),o.i32_add(o.getLocal("offsetOut"),o.getLocal("nOut")))),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(n+12))),...o.br(1)]),o.setLocal("pOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("c"),o.getLocal("offsetOut")),o.i32_const(n)))),o.call(i+"_mul",o.i32_add(o.getLocal("pWitness"),o.i32_mul(o.i32_sub(o.getLocal("s"),o.getLocal("offsetWitness")),o.i32_const(n))),o.i32_add(o.getLocal("it"),o.i32_const(12)),r),o.call(i+"_add",o.getLocal("pOut"),r,o.getLocal("pOut")),o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(n+12))),o.br(0))),o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("it",o.getLocal("pC")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("nOut"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(i+"_mul",o.getLocal("ita"),o.getLocal("itb"),o.getLocal("it")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(n))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(n))),o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(n))),o.br(0))))}(),function(){const a=t.addFunction(e+"_joinABC");a.addParam("pA","i32"),a.addParam("pB","i32"),a.addParam("pC","i32"),a.addParam("n","i32"),a.addParam("pP","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("itc","i32"),a.addLocal("itp","i32"),a.addLocal("last","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(n));a.addCode(o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("itc",o.getLocal("pC")),o.setLocal("itp",o.getLocal("pP")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(i+"_mul",o.getLocal("ita"),o.getLocal("itb"),r),o.call(i+"_sub",r,o.getLocal("itc"),o.getLocal("itp")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(n))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(n))),o.setLocal("itc",o.i32_add(o.getLocal("itc"),o.i32_const(n))),o.setLocal("itp",o.i32_add(o.getLocal("itp"),o.i32_const(n))),o.br(0))))}(),function(){const a=t.addFunction(e+"_batchAdd");a.addParam("pa","i32"),a.addParam("pb","i32"),a.addParam("n","i32"),a.addParam("pr","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("itr","i32"),a.addLocal("last","i32");const o=a.getCodeBuilder();a.addCode(o.setLocal("ita",o.getLocal("pa")),o.setLocal("itb",o.getLocal("pb")),o.setLocal("itr",o.getLocal("pr")),o.setLocal("last",o.i32_add(o.getLocal("pa"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(i+"_add",o.getLocal("ita"),o.getLocal("itb"),o.getLocal("itr")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(n))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(n))),o.setLocal("itr",o.i32_add(o.getLocal("itr"),o.i32_const(n))),o.br(0))))}(),t.exportFunction(e+"_buildABC"),t.exportFunction(e+"_joinABC"),t.exportFunction(e+"_batchAdd"),e},Kt=function(t,e,i,n,a,o,r,s){const c=t.addFunction(e);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pFirst","i32"),c.addParam("pInc","i32"),c.addParam("pOut","i32"),c.addLocal("pOldFree","i32"),c.addLocal("i","i32"),c.addLocal("pFrom","i32"),c.addLocal("pTo","i32");const l=c.getCodeBuilder(),u=l.i32_const(t.alloc(r));c.addCode(l.setLocal("pFrom",l.getLocal("pIn")),l.setLocal("pTo",l.getLocal("pOut"))),c.addCode(l.call(n+"_copy",l.getLocal("pFirst"),u)),c.addCode(l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(s,l.getLocal("pFrom"),u,l.getLocal("pTo")),l.setLocal("pFrom",l.i32_add(l.getLocal("pFrom"),l.i32_const(a))),l.setLocal("pTo",l.i32_add(l.getLocal("pTo"),l.i32_const(o))),l.call(n+"_mul",u,l.getLocal("pInc"),u),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))),t.exportFunction(e)},$t=function(t,e){const i=e||"bn128";if(t.modules[i])return i;const n=d("21888242871839275222246405745257275088696311157297823662689037894645226208583"),a=d("21888242871839275222246405745257275088548364400416034343698204186575808495617"),o=Math.floor((n.minus(1).bitLength()-1)/64)+1,r=8*o,s=r,c=r,l=2*c,u=12*c,f=t.alloc(St(a,s)),h=Pt(t,n,"f1m");Mt(t,a,"fr","frm");const g=t.alloc(St(b(d(3)),c)),p=Nt(t,"g1m","f1m",g);Dt(t,"frm","frm","frm","frm_mul"),jt(t,"pol","frm"),Vt(t,"qap","frm");const _=Qt(t,"f1m_neg","f2m","f1m"),m=t.alloc([...St(b(d("19485874751759354771024239261021720505790618469301721065564631296452457478373")),c),...St(b(d("266929791119991161246907387137283842545076965332900288569378510910307636690")),c)]),L=Nt(t,"g2m","f2m",m);function w(e,i){const n=t.addFunction(e);n.addParam("pG","i32"),n.addParam("pFr","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(r));n.addCode(a.call("frm_fromMontgomery",a.getLocal("pFr"),o),a.call(i,a.getLocal("pG"),o,a.i32_const(r),a.getLocal("pr"))),t.exportFunction(e)}function b(t){return d(t).times(d.one.shiftLeft(8*c)).mod(n)}w("g1m_timesFr","g1m_timesScalar"),Dt(t,"g1m","g1m","frm","g1m_timesFr"),w("g2m_timesFr","g2m_timesScalar"),Dt(t,"g2m","g2m","frm","g2m_timesFr"),w("g1m_timesFrAffine","g1m_timesScalarAffine"),w("g2m_timesFrAffine","g2m_timesScalarAffine"),Kt(t,"frm_batchApplyKey",0,"frm",r,r,r,"frm_mul"),Kt(t,"g1m_batchApplyKey",0,"frm",3*r,3*r,r,"g1m_timesFr"),Kt(t,"g1m_batchApplyKeyMixed",0,"frm",2*r,3*r,r,"g1m_timesFrAffine"),Kt(t,"g2m_batchApplyKey",0,"frm",2*r*3,3*r*2,r,"g2m_timesFr"),Kt(t,"g2m_batchApplyKeyMixed",0,"frm",2*r*2,3*r*2,r,"g2m_timesFrAffine");const y=[d("1"),d("2"),d.one],A=t.alloc([...St(b(y[0]),c),...St(b(y[1]),c),...St(b(y[2]),c)]),I=[d.zero,d.one,d.zero],C=t.alloc([...St(b(I[0]),c),...St(b(I[1]),c),...St(b(I[2]),c)]),v=[[d("10857046999023057135944570762232829481370756359578518086990519993285655852781"),d("11559732032986387107991004021392285783925812861821192530917403151452391805634")],[d("8495653923123431417604973247489272438418190587263600148770280649306958101930"),d("4082367875863433681332203403145435568316851327593401208105741076214120093531")],[d.one,d.zero]],F=t.alloc([...St(b(v[0][0]),c),...St(b(v[0][1]),c),...St(b(v[1][0]),c),...St(b(v[1][1]),c),...St(b(v[2][0]),c),...St(b(v[2][1]),c)]),x=[[d.zero,d.zero],[d.one,d.zero],[d.zero,d.zero]],B=t.alloc([...St(b(x[0][0]),c),...St(b(x[0][1]),c),...St(b(x[1][0]),c),...St(b(x[1][1]),c),...St(b(x[2][0]),c),...St(b(x[2][1]),c)]),E=t.alloc([...St(b(1),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c),...St(b(0),c)]),S=t.alloc([...St(b(9),c),...St(b(1),c)]),O=t.alloc([...St(b(d(2).modInv(n)),c),...St(d(0),c)]),q=S,G=t.alloc([...St(b("19485874751759354771024239261021720505790618469301721065564631296452457478373"),c),...St(b("266929791119991161246907387137283842545076965332900288569378510910307636690"),c)]);!function(){const e=t.addFunction(i+"_mulNR6");e.addParam("x","i32"),e.addParam("pr","i32");const n=e.getCodeBuilder();e.addCode(n.call(_+"_mul",n.i32_const(S),n.getLocal("x"),n.getLocal("pr")))}();const U=Tt(t,i+"_mulNR6","f6m","f2m");!function(){const e=t.addFunction(i+"_mulNR12");e.addParam("x","i32"),e.addParam("pr","i32");const n=e.getCodeBuilder();e.addCode(n.call(_+"_mul",n.i32_const(S),n.i32_add(n.getLocal("x"),n.i32_const(4*r)),n.getLocal("pr")),n.call(_+"_copy",n.getLocal("x"),n.i32_add(n.getLocal("pr"),n.i32_const(2*r))),n.call(_+"_copy",n.i32_add(n.getLocal("x"),n.i32_const(2*r)),n.i32_add(n.getLocal("pr"),n.i32_const(4*r))))}();const z=Qt(t,i+"_mulNR12","ftm",U),P=function(t){let e=t;const i=[];for(;e.gt(d.zero);)e.isOdd()?i.push(1):i.push(0),e=e.shiftRight(1);return i}(d("29793968203157093288")),M=t.alloc(P),Q=3*l,T=P.length-1,R=P.reduce(((t,e)=>t+(0!=e?1:0)),0),k=6*r,N=3*r*2+(R+T+1)*Q;t.modules[i]={n64:o,pG1gen:A,pG1zero:C,pG1b:g,pG2gen:F,pG2zero:B,pG2b:m,pq:t.modules.f1m.pq,pr:f,pOneT:E,prePSize:k,preQSize:N,r:a.toString(),q:n.toString()};const D=d("4965661367192848881");function j(e){const a=[[[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")]],[[d("1"),d("0")],[d("8376118865763821496583973867626364092589906065868298776909617916018768340080"),d("16469823323077808223889137241176536799009286646108169935659301613961712198316")],[d("21888242871839275220042445260109153167277707414472061641714758635765020556617"),d("0")],[d("11697423496358154304825782922584725312912383441159505038794027105778954184319"),d("303847389135065887422783454877609941456349188919719272345083954437860409601")],[d("21888242871839275220042445260109153167277707414472061641714758635765020556616"),d("0")],[d("3321304630594332808241809054958361220322477375291206261884409189760185844239"),d("5722266937896532885780051958958348231143373700109372999374820235121374419868")],[d("21888242871839275222246405745257275088696311157297823662689037894645226208582"),d("0")],[d("13512124006075453725662431877630910996106405091429524885779419978626457868503"),d("5418419548761466998357268504080738289687024511189653727029736280683514010267")],[d("2203960485148121921418603742825762020974279258880205651966"),d("0")],[d("10190819375481120917420622822672549775783927716138318623895010788866272024264"),d("21584395482704209334823622290379665147239961968378104390343953940207365798982")],[d("2203960485148121921418603742825762020974279258880205651967"),d("0")],[d("18566938241244942414004596690298913868373833782006617400804628704885040364344"),d("16165975933942742336466353786298926857552937457188450663314217659523851788715")]]],o=[[[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")]],[[d("1"),d("0")],[d("21575463638280843010398324269430826099269044274347216827212613867836435027261"),d("10307601595873709700152284273816112264069230130616436755625194854815875713954")],[d("21888242871839275220042445260109153167277707414472061641714758635765020556616"),d("0")],[d("3772000881919853776433695186713858239009073593817195771773381919316419345261"),d("2236595495967245188281701248203181795121068902605861227855261137820944008926")],[d("2203960485148121921418603742825762020974279258880205651966"),d("0")],[d("18429021223477853657660792034369865839114504446431234726392080002137598044644"),d("9344045779998320333812420223237981029506012124075525679208581902008406485703")]],[[d("1"),d("0")],[d("2581911344467009335267311115468803099551665605076196740867805258568234346338"),d("19937756971775647987995932169929341994314640652964949448313374472400716661030")],[d("2203960485148121921418603742825762020974279258880205651966"),d("0")],[d("5324479202449903542726783395506214481928257762400643279780343368557297135718"),d("16208900380737693084919495127334387981393726419856888799917914180988844123039")],[d("21888242871839275220042445260109153167277707414472061641714758635765020556616"),d("0")],[d("13981852324922362344252311234282257507216387789820983642040889267519694726527"),d("7629828391165209371577384193250820201684255241773809077146787135900891633097")]]],r=t.addFunction(i+"__frobeniusMap"+e);r.addParam("x","i32"),r.addParam("r","i32");const s=r.getCodeBuilder();for(let i=0;i<6;i++){const n=0==i?s.getLocal("x"):s.i32_add(s.getLocal("x"),s.i32_const(i*l)),d=n,f=s.i32_add(s.getLocal("x"),s.i32_const(i*l+c)),g=0==i?s.getLocal("r"):s.i32_add(s.getLocal("r"),s.i32_const(i*l)),p=g,m=s.i32_add(s.getLocal("r"),s.i32_const(i*l+c)),L=u(a[Math.floor(i/3)][e%12],o[i%3][e%6]),w=t.alloc([...St(b(L[0]),32),...St(b(L[1]),32)]);e%2==1?r.addCode(s.call(h+"_copy",d,p),s.call(h+"_neg",f,m),s.call(_+"_mul",g,s.i32_const(w),g)):r.addCode(s.call(_+"_mul",n,s.i32_const(w),g))}function u(t,e){const i=d(t[0]),a=d(t[1]),o=d(e[0]),r=d(e[1]),s=[i.times(o).minus(a.times(r)).mod(n),i.times(r).add(a.times(o)).mod(n)];return s[0].isNegative()&&(s[0]=s[0].add(n)),s}}function V(e,n){const a=function(t){let e=t;const i=[];for(;e.gt(d.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();i.push(t),e=e.minus(t)}else i.push(0);e=e.shiftRight(1)}return i}(e).map((t=>-1==t?255:t)),o=t.alloc(a);t.alloc(St(e,32));const r=t.addFunction(i+"__cyclotomicExp_"+n);r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");const s=r.getCodeBuilder(),c=s.getLocal("x"),l=s.getLocal("r"),f=s.i32_const(t.alloc(u));r.addCode(s.call(z+"_conjugate",c,f),s.call(z+"_one",l),s.if(s.teeLocal("bit",s.i32_load8_s(s.i32_const(a.length-1),o)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(z+"_mul",l,c,l),s.call(z+"_mul",l,f,l))),s.setLocal("i",s.i32_const(a.length-2)),s.block(s.loop(s.call(i+"__cyclotomicSquare",l,l),s.if(s.teeLocal("bit",s.i32_load8_s(s.getLocal("i"),o)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(z+"_mul",l,c,l),s.call(z+"_mul",l,f,l))),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.br(0))))}function K(){!function(){const e=t.addFunction(i+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=n.i32_add(n.getLocal("x"),n.i32_const(l)),r=n.i32_add(n.getLocal("x"),n.i32_const(2*l)),s=n.i32_add(n.getLocal("x"),n.i32_const(3*l)),c=n.i32_add(n.getLocal("x"),n.i32_const(4*l)),u=n.i32_add(n.getLocal("x"),n.i32_const(5*l)),d=n.getLocal("r"),f=n.i32_add(n.getLocal("r"),n.i32_const(l)),h=n.i32_add(n.getLocal("r"),n.i32_const(2*l)),g=n.i32_add(n.getLocal("r"),n.i32_const(3*l)),p=n.i32_add(n.getLocal("r"),n.i32_const(4*l)),m=n.i32_add(n.getLocal("r"),n.i32_const(5*l)),L=n.i32_const(t.alloc(l)),w=n.i32_const(t.alloc(l)),b=n.i32_const(t.alloc(l)),y=n.i32_const(t.alloc(l)),A=n.i32_const(t.alloc(l)),I=n.i32_const(t.alloc(l)),C=n.i32_const(t.alloc(l)),v=n.i32_const(t.alloc(l));e.addCode(n.call(_+"_mul",a,c,C),n.call(_+"_mul",c,n.i32_const(S),L),n.call(_+"_add",a,L,L),n.call(_+"_add",a,c,v),n.call(_+"_mul",v,L,L),n.call(_+"_mul",n.i32_const(S),C,v),n.call(_+"_add",C,v,v),n.call(_+"_sub",L,v,L),n.call(_+"_add",C,C,w),n.call(_+"_mul",s,r,C),n.call(_+"_mul",r,n.i32_const(S),b),n.call(_+"_add",s,b,b),n.call(_+"_add",s,r,v),n.call(_+"_mul",v,b,b),n.call(_+"_mul",n.i32_const(S),C,v),n.call(_+"_add",C,v,v),n.call(_+"_sub",b,v,b),n.call(_+"_add",C,C,y),n.call(_+"_mul",o,u,C),n.call(_+"_mul",u,n.i32_const(S),A),n.call(_+"_add",o,A,A),n.call(_+"_add",o,u,v),n.call(_+"_mul",v,A,A),n.call(_+"_mul",n.i32_const(S),C,v),n.call(_+"_add",C,v,v),n.call(_+"_sub",A,v,A),n.call(_+"_add",C,C,I),n.call(_+"_sub",L,a,d),n.call(_+"_add",d,d,d),n.call(_+"_add",L,d,d),n.call(_+"_add",w,c,p),n.call(_+"_add",p,p,p),n.call(_+"_add",w,p,p),n.call(_+"_mul",I,n.i32_const(q),v),n.call(_+"_add",v,s,g),n.call(_+"_add",g,g,g),n.call(_+"_add",v,g,g),n.call(_+"_sub",A,r,h),n.call(_+"_add",h,h,h),n.call(_+"_add",A,h,h),n.call(_+"_sub",b,o,f),n.call(_+"_add",f,f,f),n.call(_+"_add",b,f,f),n.call(_+"_add",y,u,m),n.call(_+"_add",m,m,m),n.call(_+"_add",y,m,m))}(),V(D,"w0");const e=t.addFunction(i+"__finalExponentiationLastChunk");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=n.getLocal("r"),r=n.i32_const(t.alloc(u)),s=n.i32_const(t.alloc(u)),c=n.i32_const(t.alloc(u)),d=n.i32_const(t.alloc(u)),f=n.i32_const(t.alloc(u)),h=n.i32_const(t.alloc(u)),g=n.i32_const(t.alloc(u)),p=n.i32_const(t.alloc(u)),m=n.i32_const(t.alloc(u)),L=n.i32_const(t.alloc(u)),w=n.i32_const(t.alloc(u)),b=n.i32_const(t.alloc(u)),y=n.i32_const(t.alloc(u)),A=n.i32_const(t.alloc(u)),I=n.i32_const(t.alloc(u)),C=n.i32_const(t.alloc(u)),v=n.i32_const(t.alloc(u)),F=n.i32_const(t.alloc(u)),x=n.i32_const(t.alloc(u)),B=n.i32_const(t.alloc(u)),E=n.i32_const(t.alloc(u));e.addCode(n.call(i+"__cyclotomicExp_w0",a,r),n.call(z+"_conjugate",r,r),n.call(i+"__cyclotomicSquare",r,s),n.call(i+"__cyclotomicSquare",s,c),n.call(z+"_mul",c,s,d),n.call(i+"__cyclotomicExp_w0",d,f),n.call(z+"_conjugate",f,f),n.call(i+"__cyclotomicSquare",f,h),n.call(i+"__cyclotomicExp_w0",h,g),n.call(z+"_conjugate",g,g),n.call(z+"_conjugate",d,p),n.call(z+"_conjugate",g,m),n.call(z+"_mul",m,f,L),n.call(z+"_mul",L,p,w),n.call(z+"_mul",w,s,b),n.call(z+"_mul",w,f,y),n.call(z+"_mul",y,a,A),n.call(i+"__frobeniusMap1",b,I),n.call(z+"_mul",I,A,C),n.call(i+"__frobeniusMap2",w,v),n.call(z+"_mul",v,C,F),n.call(z+"_conjugate",a,x),n.call(z+"_mul",x,b,B),n.call(i+"__frobeniusMap3",B,E),n.call(z+"_mul",E,F,o))}const $=t.alloc(k),H=t.alloc(N);function Z(e){const n=t.addFunction(i+"_pairingEq"+e);for(let t=0;t<e;t++)n.addParam("p_"+t,"i32"),n.addParam("q_"+t,"i32");n.addParam("c","i32"),n.setReturnType("i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(u)),r=a.i32_const(t.alloc(u));n.addCode(a.call(z+"_one",o));for(let t=0;t<e;t++)n.addCode(a.call(i+"_prepareG1",a.getLocal("p_"+t),a.i32_const($))),n.addCode(a.call(i+"_prepareG2",a.getLocal("q_"+t),a.i32_const(H))),n.addCode(a.call(i+"_millerLoop",a.i32_const($),a.i32_const(H),r)),n.addCode(a.call(z+"_mul",o,r,o));n.addCode(a.call(i+"_finalExponentiation",o,o)),n.addCode(a.call(z+"_eq",o,a.getLocal("c")))}!function(){const e=t.addFunction(i+"_prepAddStep");e.addParam("pQ","i32"),e.addParam("pR","i32"),e.addParam("pCoef","i32");const n=e.getCodeBuilder(),a=n.getLocal("pQ"),o=n.i32_add(n.getLocal("pQ"),n.i32_const(l)),r=n.getLocal("pR"),s=n.i32_add(n.getLocal("pR"),n.i32_const(l)),c=n.i32_add(n.getLocal("pR"),n.i32_const(2*l)),u=n.getLocal("pCoef"),d=n.i32_add(n.getLocal("pCoef"),n.i32_const(l)),f=n.i32_add(n.getLocal("pCoef"),n.i32_const(2*l)),h=d,g=n.i32_const(t.alloc(l)),p=n.i32_const(t.alloc(l)),m=n.i32_const(t.alloc(l)),L=n.i32_const(t.alloc(l)),w=n.i32_const(t.alloc(l)),b=n.i32_const(t.alloc(l)),y=n.i32_const(t.alloc(l));e.addCode(n.call(_+"_mul",a,c,h),n.call(_+"_sub",r,h,h),n.call(_+"_mul",o,c,g),n.call(_+"_sub",s,g,g),n.call(_+"_square",h,p),n.call(_+"_square",g,m),n.call(_+"_mul",h,p,L),n.call(_+"_mul",r,p,w),n.call(_+"_add",w,w,y),n.call(_+"_mul",c,m,b),n.call(_+"_add",L,b,b),n.call(_+"_sub",b,y,b),n.call(_+"_mul",h,b,r),n.call(_+"_mul",L,s,s),n.call(_+"_sub",w,b,y),n.call(_+"_mul",g,y,y),n.call(_+"_sub",y,s,s),n.call(_+"_mul",c,L,c),n.call(_+"_mul",h,o,y),n.call(_+"_mul",g,a,u),n.call(_+"_sub",u,y,u),n.call(_+"_mul",u,n.i32_const(q),u),n.call(_+"_neg",g,f))}(),function(){const e=t.addFunction(i+"_prepDblStep");e.addParam("pR","i32"),e.addParam("pCoef","i32");const n=e.getCodeBuilder(),a=n.getLocal("pR"),o=n.i32_add(n.getLocal("pR"),n.i32_const(l)),r=n.i32_add(n.getLocal("pR"),n.i32_const(2*l)),s=n.getLocal("pCoef"),c=n.i32_add(n.getLocal("pCoef"),n.i32_const(l)),u=n.i32_add(n.getLocal("pCoef"),n.i32_const(2*l)),d=n.i32_const(t.alloc(l)),f=n.i32_const(t.alloc(l)),h=n.i32_const(t.alloc(l)),g=n.i32_const(t.alloc(l)),p=n.i32_const(t.alloc(l)),m=n.i32_const(t.alloc(l)),L=n.i32_const(t.alloc(l)),w=n.i32_const(t.alloc(l)),b=n.i32_const(t.alloc(l)),y=n.i32_const(t.alloc(l)),A=n.i32_const(t.alloc(l)),I=n.i32_const(t.alloc(l));e.addCode(n.call(_+"_mul",o,n.i32_const(O),d),n.call(_+"_mul",a,d,d),n.call(_+"_square",o,f),n.call(_+"_square",r,h),n.call(_+"_add",h,h,g),n.call(_+"_add",g,h,g),n.call(_+"_mul",n.i32_const(G),g,p),n.call(_+"_add",p,p,m),n.call(_+"_add",p,m,m),n.call(_+"_add",f,m,L),n.call(_+"_mul",L,n.i32_const(O),L),n.call(_+"_add",f,h,I),n.call(_+"_add",o,r,w),n.call(_+"_square",w,w),n.call(_+"_sub",w,I,w),n.call(_+"_sub",p,f,b),n.call(_+"_square",a,y),n.call(_+"_square",p,A),n.call(_+"_sub",f,m,I),n.call(_+"_mul",d,I,a),n.call(_+"_add",A,A,I),n.call(_+"_add",A,I,I),n.call(_+"_square",L,o),n.call(_+"_sub",o,I,o),n.call(_+"_mul",f,w,r),n.call(_+"_mul",n.i32_const(q),b,s),n.call(_+"_neg",w,c),n.call(_+"_add",y,y,u),n.call(_+"_add",y,u,u))}(),function(){const e=t.addFunction(i+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const n=e.getCodeBuilder();e.addCode(n.call(p+"_normalize",n.getLocal("pP"),n.getLocal("ppreP")))}(),function(){!function(){const e=t.addFunction(i+"_mulByQ");e.addParam("p1","i32"),e.addParam("pr","i32");const n=e.getCodeBuilder(),a=n.getLocal("p1"),o=n.i32_add(n.getLocal("p1"),n.i32_const(l)),r=n.i32_add(n.getLocal("p1"),n.i32_const(2*l)),s=n.getLocal("pr"),u=n.i32_add(n.getLocal("pr"),n.i32_const(l)),d=n.i32_add(n.getLocal("pr"),n.i32_const(2*l)),f=n.i32_const(t.alloc([...St(b("21575463638280843010398324269430826099269044274347216827212613867836435027261"),c),...St(b("10307601595873709700152284273816112264069230130616436755625194854815875713954"),c)])),h=n.i32_const(t.alloc([...St(b("2821565182194536844548159561693502659359617185244120367078079554186484126554"),c),...St(b("3505843767911556378687030309984248845540243509899259641013678093033130930403"),c)]));e.addCode(n.call(_+"_conjugate",a,s),n.call(_+"_mul",f,s,s),n.call(_+"_conjugate",o,u),n.call(_+"_mul",h,u,u),n.call(_+"_conjugate",r,d))}();const e=t.addFunction(i+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const n=e.getCodeBuilder(),a=n.getLocal("pQ");n.i32_add(n.getLocal("pQ"),n.i32_const(l)),n.i32_add(n.getLocal("pQ"),n.i32_const(2*l));const o=t.alloc(3*l),r=n.i32_const(o),s=n.i32_const(o),u=n.i32_const(o+l),d=n.i32_const(o+2*l),f=n.i32_add(n.getLocal("ppreQ"),n.i32_const(0)),h=n.i32_add(n.getLocal("ppreQ"),n.i32_const(l));n.i32_add(n.getLocal("ppreQ"),n.i32_const(2*l));const g=t.alloc(3*l),p=n.i32_const(g),m=t.alloc(3*l),w=n.i32_const(m);n.i32_const(m);const y=n.i32_const(m+l);n.i32_const(m+2*l),e.addCode(n.call(L+"_normalize",a,f),n.call(_+"_copy",f,s),n.call(_+"_copy",h,u),n.call(_+"_one",d)),e.addCode(n.setLocal("pCoef",n.i32_add(n.getLocal("ppreQ"),n.i32_const(3*l))),n.setLocal("i",n.i32_const(P.length-2)),n.block(n.loop(n.call(i+"_prepDblStep",r,n.getLocal("pCoef")),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))),n.if(n.i32_load8_s(n.getLocal("i"),M),[...n.call(i+"_prepAddStep",f,r,n.getLocal("pCoef")),...n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q)))]),n.br_if(1,n.i32_eqz(n.getLocal("i"))),n.setLocal("i",n.i32_sub(n.getLocal("i"),n.i32_const(1))),n.br(0)))),e.addCode(n.call(i+"_mulByQ",f,p),n.call(i+"_mulByQ",p,w)),e.addCode(n.call(_+"_neg",y,y),n.call(i+"_prepAddStep",p,r,n.getLocal("pCoef")),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))),n.call(i+"_prepAddStep",w,r,n.getLocal("pCoef")),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))))}(),function(){const e=t.addFunction(i+"__mulBy024");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const n=e.getCodeBuilder(),a=n.getLocal("pEll0"),o=n.getLocal("pEllVV"),s=n.getLocal("pEllVW"),c=n.getLocal("pR"),u=n.i32_add(n.getLocal("pR"),n.i32_const(2*r)),d=n.i32_add(n.getLocal("pR"),n.i32_const(4*r)),f=n.i32_add(n.getLocal("pR"),n.i32_const(6*r)),h=n.i32_add(n.getLocal("pR"),n.i32_const(8*r)),g=n.i32_add(n.getLocal("pR"),n.i32_const(10*r)),p=n.i32_const(t.alloc(l)),m=n.i32_const(t.alloc(l)),L=n.i32_const(t.alloc(l)),w=n.i32_const(t.alloc(l)),b=n.i32_const(t.alloc(l)),y=n.i32_const(t.alloc(l)),A=n.i32_const(t.alloc(l)),I=n.i32_const(t.alloc(l)),C=n.i32_const(t.alloc(l)),v=n.i32_const(t.alloc(l)),F=n.i32_const(t.alloc(l));e.addCode(n.call(_+"_mul",c,a,A),n.call(_+"_mul",d,o,I),n.call(_+"_mul",h,s,C),n.call(_+"_add",c,h,L),n.call(_+"_add",c,d,m),n.call(_+"_add",u,f,w),n.call(_+"_add",w,g,w),n.call(_+"_mul",u,o,v),n.call(_+"_add",v,C,b),n.call(_+"_mul",n.i32_const(S),b,y),n.call(_+"_add",y,A,c),n.call(_+"_mul",g,s,b),n.call(_+"_add",v,b,v),n.call(_+"_add",b,I,b),n.call(_+"_mul",n.i32_const(S),b,y),n.call(_+"_mul",u,a,b),n.call(_+"_add",v,b,v),n.call(_+"_add",y,b,u),n.call(_+"_add",a,o,p),n.call(_+"_mul",m,p,b),n.call(_+"_add",A,I,F),n.call(_+"_sub",b,F,b),n.call(_+"_mul",f,s,y),n.call(_+"_add",v,y,v),n.call(_+"_add",d,h,p),n.call(_+"_add",b,y,d),n.call(_+"_add",o,s,m),n.call(_+"_mul",m,p,b),n.call(_+"_add",I,C,F),n.call(_+"_sub",b,F,b),n.call(_+"_mul",n.i32_const(S),b,y),n.call(_+"_mul",f,a,b),n.call(_+"_add",v,b,v),n.call(_+"_add",y,b,f),n.call(_+"_mul",g,o,b),n.call(_+"_add",v,b,v),n.call(_+"_mul",n.i32_const(S),b,y),n.call(_+"_add",a,s,p),n.call(_+"_mul",L,p,b),n.call(_+"_add",A,C,F),n.call(_+"_sub",b,F,b),n.call(_+"_add",y,b,h),n.call(_+"_add",a,o,p),n.call(_+"_add",p,s,p),n.call(_+"_mul",w,p,b),n.call(_+"_sub",b,v,g))}(),function(){const e=t.addFunction(i+"__mulBy024Old");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const n=e.getCodeBuilder(),a=n.getLocal("pEll0"),o=n.getLocal("pEllVV"),r=n.getLocal("pEllVW"),s=n.getLocal("pR"),c=t.alloc(u),d=n.i32_const(c),f=n.i32_const(c),h=n.i32_const(c+l),g=n.i32_const(c+2*l),p=n.i32_const(c+3*l),m=n.i32_const(c+4*l),L=n.i32_const(c+5*l);e.addCode(n.call(_+"_copy",a,f),n.call(_+"_zero",h),n.call(_+"_copy",o,g),n.call(_+"_zero",p),n.call(_+"_copy",r,m),n.call(_+"_zero",L),n.call(z+"_mul",d,s,s))}(),function(){const e=t.addFunction(i+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const n=e.getCodeBuilder(),a=n.getLocal("ppreP"),o=n.i32_add(n.getLocal("ppreP"),n.i32_const(c)),r=n.getLocal("pCoef"),s=n.i32_add(n.getLocal("pCoef"),n.i32_const(l)),u=n.i32_add(n.getLocal("pCoef"),n.i32_const(2*l)),d=t.alloc(l),f=n.i32_const(d),h=t.alloc(l),g=n.i32_const(h),p=n.getLocal("r");e.addCode(n.call(z+"_one",p),n.setLocal("pCoef",n.i32_add(n.getLocal("ppreQ"),n.i32_const(3*l))),n.setLocal("i",n.i32_const(P.length-2)),n.block(n.loop(n.call(z+"_square",p,p),n.call(_+"_mul1",s,o,f),n.call(_+"_mul1",u,a,g),n.call(i+"__mulBy024",r,f,g,p),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))),n.if(n.i32_load8_s(n.getLocal("i"),M),[...n.call(_+"_mul1",s,o,f),...n.call(_+"_mul1",u,a,g),...n.call(i+"__mulBy024",r,f,g,p),...n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q)))]),n.br_if(1,n.i32_eqz(n.getLocal("i"))),n.setLocal("i",n.i32_sub(n.getLocal("i"),n.i32_const(1))),n.br(0)))),e.addCode(n.call(_+"_mul1",s,o,f),n.call(_+"_mul1",u,a,g),n.call(i+"__mulBy024",r,f,g,p),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))),n.call(_+"_mul1",s,o,f),n.call(_+"_mul1",u,a,g),n.call(i+"__mulBy024",r,f,g,p),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(Q))))}();for(let e=0;e<10;e++)j(e),t.exportFunction(i+"__frobeniusMap"+e);!function(){const e=t.addFunction(i+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const n=d("552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480"),a=t.alloc(St(n,352)),o=e.getCodeBuilder();e.addCode(o.call(z+"_exp",o.getLocal("x"),o.i32_const(a),o.i32_const(352),o.getLocal("r")))}(),function(){!function(){const e=t.addFunction(i+"__finalExponentiationFirstChunk");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=a,s=n.i32_add(a,n.i32_const(6*r)),c=n.getLocal("r"),l=t.alloc(u),d=n.i32_const(l),f=d,h=n.i32_const(l+6*r),g=n.i32_const(t.alloc(u)),p=n.i32_const(t.alloc(u)),_=n.i32_const(t.alloc(u));e.addCode(n.call(U+"_copy",o,f),n.call(U+"_neg",s,h),n.call(z+"_inverse",a,g),n.call(z+"_mul",d,g,p),n.call(i+"__frobeniusMap2",p,_),n.call(z+"_mul",p,_,c))}(),K();const e=t.addFunction(i+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=n.getLocal("r"),s=n.i32_const(t.alloc(u));e.addCode(n.call(i+"__finalExponentiationFirstChunk",a,s),n.call(i+"__finalExponentiationLastChunk",s,o))}();for(let e=1;e<=5;e++)Z(e),t.exportFunction(i+"_pairingEq"+e);!function(){const e=t.addFunction(i+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.i32_const(t.alloc(u));e.addCode(n.call(i+"_prepareG1",n.getLocal("p"),n.i32_const($))),e.addCode(n.call(i+"_prepareG2",n.getLocal("q"),n.i32_const(H))),e.addCode(n.call(i+"_millerLoop",n.i32_const($),n.i32_const(H),a)),e.addCode(n.call(i+"_finalExponentiation",a,n.getLocal("r")))}(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__mulBy024"),t.exportFunction(i+"__mulBy024Old"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0")},Ht=function(t,e){const i=e||"bls12381";if(t.modules[i])return i;const n=d("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),a=d("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),o=Math.floor((n.minus(1).bitLength()-1)/64)+1,r=8*o,s=r,c=2*s,l=12*s,u=Math.floor((a.minus(1).bitLength()-1)/64)+1,f=8*u,h=f,g=t.alloc(St(a,h)),p=Pt(t,n,"f1m","intq");Mt(t,a,"fr","frm","intr");const _=t.alloc(St(A(d(4)),s)),m=Nt(t,"g1m","f1m",_);Dt(t,"frm","frm","frm","frm_mul"),jt(t,"pol","frm"),Vt(t,"qap","frm");const L=Qt(t,"f1m_neg","f2m","f1m"),w=t.alloc([...St(A(d("4")),s),...St(A(d("4")),s)]),b=Nt(t,"g2m","f2m",w);function y(e,i){const n=t.addFunction(e);n.addParam("pG","i32"),n.addParam("pFr","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(f));n.addCode(a.call("frm_fromMontgomery",a.getLocal("pFr"),o),a.call(i,a.getLocal("pG"),o,a.i32_const(f),a.getLocal("pr"))),t.exportFunction(e)}function A(t){return d(t).times(d.one.shiftLeft(8*s)).mod(n)}y("g1m_timesFr","g1m_timesScalar"),Dt(t,"g1m","g1m","frm","g1m_timesFr"),y("g2m_timesFr","g2m_timesScalar"),Dt(t,"g2m","g2m","frm","g2m_timesFr"),y("g1m_timesFrAffine","g1m_timesScalarAffine"),y("g2m_timesFrAffine","g2m_timesScalarAffine"),Kt(t,"frm_batchApplyKey",0,"frm",f,f,f,"frm_mul"),Kt(t,"g1m_batchApplyKey",0,"frm",3*r,3*r,f,"g1m_timesFr"),Kt(t,"g1m_batchApplyKeyMixed",0,"frm",2*r,3*r,f,"g1m_timesFrAffine"),Kt(t,"g2m_batchApplyKey",0,"frm",2*r*3,3*r*2,f,"g2m_timesFr"),Kt(t,"g2m_batchApplyKeyMixed",0,"frm",2*r*2,3*r*2,f,"g2m_timesFrAffine");const I=[d("3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507"),d("1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569"),d.one],C=t.alloc([...St(A(I[0]),s),...St(A(I[1]),s),...St(A(I[2]),s)]),v=[d.zero,d.one,d.zero],F=t.alloc([...St(A(v[0]),s),...St(A(v[1]),s),...St(A(v[2]),s)]),x=[[d("352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160"),d("3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758")],[d("1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905"),d("927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582")],[d.one,d.zero]],B=t.alloc([...St(A(x[0][0]),s),...St(A(x[0][1]),s),...St(A(x[1][0]),s),...St(A(x[1][1]),s),...St(A(x[2][0]),s),...St(A(x[2][1]),s)]),E=[[d.zero,d.zero],[d.one,d.zero],[d.zero,d.zero]],S=t.alloc([...St(A(E[0][0]),s),...St(A(E[0][1]),s),...St(A(E[1][0]),s),...St(A(E[1][1]),s),...St(A(E[2][0]),s),...St(A(E[2][1]),s)]),O=t.alloc([...St(A(1),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s),...St(A(0),s)]);t.alloc([...St(A(d(2).modInv(n)),s),...St(d(0),s)]);const q=t.alloc([...St(A(1),s),...St(A(1),s)]);t.alloc([...St(A("4"),s),...St(A("4"),s)]),function(){const e=t.addFunction(L+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(s)),a=i.getLocal("x"),o=i.i32_add(i.getLocal("x"),i.i32_const(s)),r=i.getLocal("pr"),c=i.i32_add(i.getLocal("pr"),i.i32_const(s));e.addCode(i.call(p+"_copy",a,n),i.call(p+"_sub",a,o,r),i.call(p+"_add",n,o,c))}();const G=Tt(t,L+"_mulNR","f6m","f2m");!function(){const e=t.addFunction(G+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(2*s));e.addCode(i.call(L+"_copy",i.getLocal("x"),n),i.call(L+"_mulNR",i.i32_add(i.getLocal("x"),i.i32_const(4*r)),i.getLocal("pr")),i.call(L+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*r)),i.i32_add(i.getLocal("pr"),i.i32_const(4*r))),i.call(L+"_copy",n,i.i32_add(i.getLocal("pr"),i.i32_const(2*r))))}();const U=Qt(t,G+"_mulNR","ftm",G),z=function(t){let e=t;const i=[];for(;e.gt(d.zero);)e.isOdd()?i.push(1):i.push(0),e=e.shiftRight(1);return i}(d("d201000000010000",16)),P=t.alloc(z),M=3*c,Q=z.length-1,T=z.reduce(((t,e)=>t+(0!=e?1:0)),0),R=6*r,k=3*r*2+(T+Q+1)*M,N=d("15132376222941642752");function D(e){const i=[[[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")]],[[d("1"),d("0")],[d("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760"),d("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027")],[d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),d("0")],[d("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),d("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257")],[d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),d("0")],[d("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557"),d("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230")],[d("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),d("0")],[d("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027"),d("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760")],[d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),d("0")],[d("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257"),d("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],[d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),d("0")],[d("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230"),d("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557")]]],a=[[[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")],[d("1"),d("0")]],[[d("1"),d("0")],[d("0"),d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436")],[d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),d("0")],[d("0"),d("1")],[d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),d("0")],[d("0"),d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350")]],[[d("1"),d("0")],[d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),d("0")],[d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),d("0")],[d("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),d("0")],[d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),d("0")],[d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),d("0")]]],o=t.addFunction(U+"_frobeniusMap"+e);o.addParam("x","i32"),o.addParam("r","i32");const l=o.getCodeBuilder();for(let n=0;n<6;n++){const d=0==n?l.getLocal("x"):l.i32_add(l.getLocal("x"),l.i32_const(n*c)),f=d,h=l.i32_add(l.getLocal("x"),l.i32_const(n*c+s)),g=0==n?l.getLocal("r"):l.i32_add(l.getLocal("r"),l.i32_const(n*c)),_=g,m=l.i32_add(l.getLocal("r"),l.i32_const(n*c+s)),w=u(i[Math.floor(n/3)][e%12],a[n%3][e%6]),b=t.alloc([...St(A(w[0]),r),...St(A(w[1]),r)]);e%2==1?o.addCode(l.call(p+"_copy",f,_),l.call(p+"_neg",h,m),l.call(L+"_mul",g,l.i32_const(b),g)):o.addCode(l.call(L+"_mul",d,l.i32_const(b),g))}function u(t,e){const i=d(t[0]),a=d(t[1]),o=d(e[0]),r=d(e[1]),s=[i.times(o).minus(a.times(r)).mod(n),i.times(r).add(a.times(o)).mod(n)];return s[0].isNegative()&&(s[0]=s[0].add(n)),s}}function j(e,n,a){const o=function(t){let e=t;const i=[];for(;e.gt(d.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();i.push(t),e=e.minus(t)}else i.push(0);e=e.shiftRight(1)}return i}(e).map((t=>-1==t?255:t)),r=t.alloc(o),s=t.addFunction(i+"__cyclotomicExp_"+a);s.addParam("x","i32"),s.addParam("r","i32"),s.addLocal("bit","i32"),s.addLocal("i","i32");const c=s.getCodeBuilder(),u=c.getLocal("x"),f=c.getLocal("r"),h=c.i32_const(t.alloc(l));s.addCode(c.call(U+"_conjugate",u,h),c.call(U+"_one",f),c.if(c.teeLocal("bit",c.i32_load8_s(c.i32_const(o.length-1),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",f,u,f),c.call(U+"_mul",f,h,f))),c.setLocal("i",c.i32_const(o.length-2)),c.block(c.loop(c.call(i+"__cyclotomicSquare",f,f),c.if(c.teeLocal("bit",c.i32_load8_s(c.getLocal("i"),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",f,u,f),c.call(U+"_mul",f,h,f))),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.br(0)))),n&&s.addCode(c.call(U+"_conjugate",f,f))}t.modules[i]={n64q:o,n64r:u,n8q:r,n8r:f,pG1gen:C,pG1zero:F,pG1b:_,pG2gen:B,pG2zero:S,pG2b:w,pq:t.modules.f1m.pq,pr:g,pOneT:O,r:a,q:n,prePSize:R,preQSize:k},function(){const e=t.addFunction(G+"_mul1");e.addParam("pA","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),n=i.getLocal("pA"),a=i.i32_add(i.getLocal("pA"),i.i32_const(2*s)),o=i.i32_add(i.getLocal("pA"),i.i32_const(4*s)),r=i.getLocal("pC1"),c=i.getLocal("pR"),l=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),u=i.i32_add(i.getLocal("pR"),i.i32_const(4*s)),d=i.i32_const(t.alloc(2*s)),f=i.i32_const(t.alloc(2*s));e.addCode(i.call(L+"_add",n,a,d),i.call(L+"_add",a,o,f),i.call(L+"_mul",a,r,u),i.call(L+"_mul",f,r,c),i.call(L+"_sub",c,u,c),i.call(L+"_mulNR",c,c),i.call(L+"_mul",d,r,l),i.call(L+"_sub",l,u,l))}(),function(){const e=t.addFunction(G+"_mul01");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),n=i.getLocal("pA"),a=i.i32_add(i.getLocal("pA"),i.i32_const(2*s)),o=i.i32_add(i.getLocal("pA"),i.i32_const(4*s)),r=i.getLocal("pC0"),c=i.getLocal("pC1"),l=i.getLocal("pR"),u=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),d=i.i32_add(i.getLocal("pR"),i.i32_const(4*s)),f=i.i32_const(t.alloc(2*s)),h=i.i32_const(t.alloc(2*s)),g=i.i32_const(t.alloc(2*s)),p=i.i32_const(t.alloc(2*s));e.addCode(i.call(L+"_mul",n,r,f),i.call(L+"_mul",a,c,h),i.call(L+"_add",n,a,g),i.call(L+"_add",n,o,p),i.call(L+"_add",a,o,l),i.call(L+"_mul",l,c,l),i.call(L+"_sub",l,h,l),i.call(L+"_mulNR",l,l),i.call(L+"_add",l,f,l),i.call(L+"_add",r,c,u),i.call(L+"_mul",u,g,u),i.call(L+"_sub",u,f,u),i.call(L+"_sub",u,h,u),i.call(L+"_mul",p,r,d),i.call(L+"_sub",d,f,d),i.call(L+"_add",d,h,d))}(),function(){const e=t.addFunction(U+"_mul014");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pC4","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),n=i.getLocal("pA"),a=i.i32_add(i.getLocal("pA"),i.i32_const(6*s)),o=i.getLocal("pC0"),r=i.getLocal("pC1"),c=i.getLocal("pC4"),l=i.i32_const(t.alloc(6*s)),u=i.i32_const(t.alloc(6*s)),d=i.i32_const(t.alloc(2*s)),f=i.getLocal("pR"),h=i.i32_add(i.getLocal("pR"),i.i32_const(6*s));e.addCode(i.call(G+"_mul01",n,o,r,l),i.call(G+"_mul1",a,c,u),i.call(L+"_add",r,c,d),i.call(G+"_add",a,n,h),i.call(G+"_mul01",h,o,d,h),i.call(G+"_sub",h,l,h),i.call(G+"_sub",h,u,h),i.call(G+"_copy",u,f),i.call(G+"_mulNR",f,f),i.call(G+"_add",f,l,f))}(),function(){const e=t.addFunction(i+"_ell");e.addParam("pP","i32"),e.addParam("pCoefs","i32"),e.addParam("pF","i32");const n=e.getCodeBuilder(),a=n.getLocal("pP"),o=n.i32_add(n.getLocal("pP"),n.i32_const(r)),c=n.getLocal("pF"),l=n.getLocal("pCoefs"),u=n.i32_add(n.getLocal("pCoefs"),n.i32_const(s)),d=n.i32_add(n.getLocal("pCoefs"),n.i32_const(2*s)),f=n.i32_add(n.getLocal("pCoefs"),n.i32_const(3*s)),h=n.i32_add(n.getLocal("pCoefs"),n.i32_const(4*s)),g=t.alloc(2*s),_=n.i32_const(g),m=n.i32_const(g),L=n.i32_const(g+s),w=t.alloc(2*s),b=n.i32_const(w),y=n.i32_const(w),A=n.i32_const(w+s);e.addCode(n.call(p+"_mul",l,o,m),n.call(p+"_mul",u,o,L),n.call(p+"_mul",d,a,y),n.call(p+"_mul",f,a,A),n.call(U+"_mul014",c,h,b,_,c))}();const V=t.alloc(R),K=t.alloc(k);function $(e){const n=t.addFunction(i+"_pairingEq"+e);for(let t=0;t<e;t++)n.addParam("p_"+t,"i32"),n.addParam("q_"+t,"i32");n.addParam("c","i32"),n.setReturnType("i32");const a=n.getCodeBuilder(),o=a.i32_const(t.alloc(l)),r=a.i32_const(t.alloc(l));n.addCode(a.call(U+"_one",o));for(let t=0;t<e;t++)n.addCode(a.call(i+"_prepareG1",a.getLocal("p_"+t),a.i32_const(V))),n.addCode(a.call(i+"_prepareG2",a.getLocal("q_"+t),a.i32_const(K))),n.addCode(a.if(a.i32_eqz(a.call(m+"_inGroupAffine",a.i32_const(V))),a.ret(a.i32_const(0))),a.if(a.i32_eqz(a.call(b+"_inGroupAffine",a.i32_const(K))),a.ret(a.i32_const(0)))),n.addCode(a.call(i+"_millerLoop",a.i32_const(V),a.i32_const(K),r)),n.addCode(a.call(U+"_mul",o,r,o));n.addCode(a.call(i+"_finalExponentiation",o,o)),n.addCode(a.call(U+"_eq",o,a.getLocal("c")))}for(let e=0;e<10;e++)D(e),t.exportFunction(U+"_frobeniusMap"+e);!function(){const e=t.addFunction(m+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),a=d("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),o=N.times(N).minus(d.one).divide(d(3)),c=i.i32_const(t.alloc(St(A(n),r))),l=i.i32_const(t.alloc(St(A(a),r))),u=i.i32_const(t.alloc(St(o,16))),f=i.getLocal("p"),h=i.i32_add(i.getLocal("p"),i.i32_const(s)),g=t.alloc(3*s),_=i.i32_const(g),L=i.i32_const(g),w=i.i32_const(g+s);i.i32_const(g+2*s);const b=t.alloc(2*s),y=i.i32_const(b),I=i.i32_const(b),C=i.i32_const(b+s);e.addCode(i.if(i.call(m+"_isZeroAffine",i.getLocal("p")),i.ret(i.i32_const(1))),i.if(i.i32_eqz(i.call(m+"_inCurveAffine",i.getLocal("p"))),i.ret(i.i32_const(0))),i.call(p+"_mul",f,c,L),i.call(p+"_copy",h,w),i.call(p+"_mul",f,l,I),i.call(p+"_copy",h,C),i.call(m+"_doubleAffine",_,_),i.call(m+"_subMixed",_,i.getLocal("p"),_),i.call(m+"_subMixed",_,y,_),i.call(m+"_timesScalar",_,u,i.i32_const(16),_),i.ret(i.call(m+"_eqMixed",_,y)));const v=t.addFunction(m+"_inGroup");v.addParam("pIn","i32"),v.setReturnType("i32");const F=v.getCodeBuilder(),x=F.i32_const(t.alloc(2*s));v.addCode(F.call(m+"_toAffine",F.getLocal("pIn"),x),F.ret(F.call(m+"_inGroupAffine",x)))}(),function(){const e=t.addFunction(b+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=[d("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894"),d("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893")],a=d("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),o=[d("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),d("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],l=i.i32_const(t.alloc([...St(A(n[0]),r),...St(A(n[1]),r)])),u=i.i32_const(t.alloc(St(A(a),r))),f=i.i32_const(t.alloc([...St(A(o[0]),r),...St(A(o[1]),r)])),h=i.i32_const(t.alloc(St(N,8))),g=i.getLocal("p"),_=i.i32_add(i.getLocal("p"),i.i32_const(c)),m=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(c)),y=i.i32_const(t.alloc(c)),I=t.alloc(2*c),C=i.i32_const(I),v=i.i32_const(I),F=i.i32_const(I),x=i.i32_const(I+s),B=i.i32_const(I+c),E=i.i32_const(I+c),S=i.i32_const(I+c+s),O=t.alloc(3*c),q=i.i32_const(O),G=i.i32_const(O),U=i.i32_const(O),z=i.i32_const(O+s),P=i.i32_const(O+c),M=i.i32_const(O+c),Q=i.i32_const(O+c+s),T=i.i32_const(O+2*c);e.addCode(i.if(i.call(b+"_isZeroAffine",i.getLocal("p")),i.ret(i.i32_const(1))),i.if(i.i32_eqz(i.call(b+"_inCurveAffine",i.getLocal("p"))),i.ret(i.i32_const(0))),i.call(L+"_mul",g,l,w),i.call(L+"_mul",_,l,y),i.call(L+"_mul1",w,u,v),i.call(L+"_neg",y,B),i.call(L+"_neg",w,G),i.call(L+"_mul",y,f,P),i.call(p+"_sub",F,x,m),i.call(p+"_add",F,x,x),i.call(p+"_copy",m,F),i.call(p+"_sub",E,S,m),i.call(p+"_add",E,S,S),i.call(p+"_copy",m,E),i.call(p+"_add",U,z,m),i.call(p+"_sub",U,z,z),i.call(p+"_copy",m,U),i.call(p+"_sub",Q,M,m),i.call(p+"_add",M,Q,Q),i.call(p+"_copy",m,M),i.call(L+"_one",T),i.call(b+"_timesScalar",q,h,i.i32_const(8),q),i.call(b+"_addMixed",q,C,q),i.ret(i.call(b+"_eqMixed",q,i.getLocal("p"))));const R=t.addFunction(b+"_inGroup");R.addParam("pIn","i32"),R.setReturnType("i32");const k=R.getCodeBuilder(),D=k.i32_const(t.alloc(2*c));R.addCode(k.call(b+"_toAffine",k.getLocal("pIn"),D),k.ret(k.call(b+"_inGroupAffine",D)))}(),function(){const e=t.addFunction(i+"_prepAddStep");e.addParam("R","i32"),e.addParam("Q","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("R"),o=n.i32_add(n.getLocal("R"),n.i32_const(2*r)),s=n.i32_add(n.getLocal("R"),n.i32_const(4*r)),l=n.getLocal("Q"),u=n.i32_add(n.getLocal("Q"),n.i32_const(2*r)),d=n.getLocal("r"),f=n.i32_add(n.getLocal("r"),n.i32_const(2*r)),h=n.i32_add(n.getLocal("r"),n.i32_const(4*r)),g=n.i32_const(t.alloc(c)),p=n.i32_const(t.alloc(c)),_=n.i32_const(t.alloc(c)),m=n.i32_const(t.alloc(c)),w=n.i32_const(t.alloc(c)),b=n.i32_const(t.alloc(c)),y=n.i32_const(t.alloc(c)),A=n.i32_const(t.alloc(c)),I=n.i32_const(t.alloc(c)),C=n.i32_const(t.alloc(c)),v=n.i32_const(t.alloc(c));e.addCode(n.call(L+"_square",s,g),n.call(L+"_square",u,p),n.call(L+"_mul",g,l,m),n.call(L+"_add",u,s,f),n.call(L+"_square",f,f),n.call(L+"_sub",f,p,f),n.call(L+"_sub",f,g,f),n.call(L+"_mul",f,g,f),n.call(L+"_sub",m,a,w),n.call(L+"_square",w,b),n.call(L+"_add",b,b,y),n.call(L+"_add",y,y,y),n.call(L+"_mul",y,w,A),n.call(L+"_sub",f,o,I),n.call(L+"_sub",I,o,I),n.call(L+"_mul",I,l,h),n.call(L+"_mul",y,a,C),n.call(L+"_square",I,a),n.call(L+"_sub",a,A,a),n.call(L+"_sub",a,C,a),n.call(L+"_sub",a,C,a),n.call(L+"_add",s,w,s),n.call(L+"_square",s,s),n.call(L+"_sub",s,g,s),n.call(L+"_sub",s,b,s),n.call(L+"_add",u,s,d),n.call(L+"_sub",C,a,v),n.call(L+"_mul",v,I,v),n.call(L+"_mul",o,A,m),n.call(L+"_add",m,m,m),n.call(L+"_sub",v,m,o),n.call(L+"_square",d,d),n.call(L+"_sub",d,p,d),n.call(L+"_square",s,_),n.call(L+"_sub",d,_,d),n.call(L+"_add",h,h,h),n.call(L+"_sub",h,d,h),n.call(L+"_add",s,s,d),n.call(L+"_neg",I,I),n.call(L+"_add",I,I,f))}(),function(){const e=t.addFunction(i+"_prepDblStep");e.addParam("R","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("R"),o=n.i32_add(n.getLocal("R"),n.i32_const(2*r)),s=n.i32_add(n.getLocal("R"),n.i32_const(4*r)),l=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(2*r)),d=n.i32_add(n.getLocal("r"),n.i32_const(4*r)),f=n.i32_const(t.alloc(c)),h=n.i32_const(t.alloc(c)),g=n.i32_const(t.alloc(c)),p=n.i32_const(t.alloc(c)),_=n.i32_const(t.alloc(c));e.addCode(n.call(L+"_square",a,l),n.call(L+"_square",o,h),n.call(L+"_square",h,g),n.call(L+"_add",h,a,u),n.call(L+"_square",u,u),n.call(L+"_sub",u,l,u),n.call(L+"_sub",u,g,u),n.call(L+"_add",u,u,u),n.call(L+"_add",l,l,p),n.call(L+"_add",p,l,p),n.call(L+"_add",a,p,d),n.call(L+"_square",p,_),n.call(L+"_square",s,f),n.call(L+"_sub",_,u,a),n.call(L+"_sub",a,u,a),n.call(L+"_add",s,o,s),n.call(L+"_square",s,s),n.call(L+"_sub",s,h,s),n.call(L+"_sub",s,f,s),n.call(L+"_sub",u,a,o),n.call(L+"_mul",o,p,o),n.call(L+"_add",g,g,g),n.call(L+"_add",g,g,g),n.call(L+"_add",g,g,g),n.call(L+"_sub",o,g,o),n.call(L+"_mul",p,f,u),n.call(L+"_add",u,u,u),n.call(L+"_neg",u,u),n.call(L+"_square",d,d),n.call(L+"_sub",d,l,d),n.call(L+"_sub",d,_,d),n.call(L+"_add",h,h,h),n.call(L+"_add",h,h,h),n.call(L+"_sub",d,h,d),n.call(L+"_mul",s,f,l),n.call(L+"_add",l,l,l))}(),function(){const e=t.addFunction(i+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const n=e.getCodeBuilder();e.addCode(n.call(m+"_normalize",n.getLocal("pP"),n.getLocal("ppreP")))}(),function(){const e=t.addFunction(i+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const n=e.getCodeBuilder(),a=n.getLocal("pQ"),o=t.alloc(3*c),r=n.i32_const(o),s=n.getLocal("ppreQ");e.addCode(n.call(b+"_normalize",a,s),n.if(n.call(b+"_isZero",s),n.ret([])),n.call(b+"_copy",s,r),n.setLocal("pCoef",n.i32_add(n.getLocal("ppreQ"),n.i32_const(3*c)))),e.addCode(n.setLocal("i",n.i32_const(z.length-2)),n.block(n.loop(n.call(i+"_prepDblStep",r,n.getLocal("pCoef")),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(M))),n.if(n.i32_load8_s(n.getLocal("i"),P),[...n.call(i+"_prepAddStep",r,s,n.getLocal("pCoef")),...n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(M)))]),n.br_if(1,n.i32_eqz(n.getLocal("i"))),n.setLocal("i",n.i32_sub(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){const e=t.addFunction(i+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const n=e.getCodeBuilder(),a=n.getLocal("ppreP");n.getLocal("ppreQ");const o=n.getLocal("pCoef"),r=n.getLocal("r");e.addCode(n.call(U+"_one",r),n.if(n.call(m+"_isZero",a),n.ret([])),n.if(n.call(m+"_isZero",n.getLocal("ppreQ")),n.ret([])),n.setLocal("pCoef",n.i32_add(n.getLocal("ppreQ"),n.i32_const(3*c))),n.setLocal("i",n.i32_const(z.length-2)),n.block(n.loop(n.call(i+"_ell",a,o,r),n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(M))),n.if(n.i32_load8_s(n.getLocal("i"),P),[...n.call(i+"_ell",a,o,r),...n.setLocal("pCoef",n.i32_add(n.getLocal("pCoef"),n.i32_const(M)))]),n.call(U+"_square",r,r),n.br_if(1,n.i32_eq(n.getLocal("i"),n.i32_const(1))),n.setLocal("i",n.i32_sub(n.getLocal("i"),n.i32_const(1))),n.br(0))),n.call(i+"_ell",a,o,r)),e.addCode(n.call(U+"_conjugate",r,r))}(),function(){const e=t.addFunction(i+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const n=d("322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560"),a=t.alloc(St(n,544)),o=e.getCodeBuilder();e.addCode(o.call(U+"_exp",o.getLocal("x"),o.i32_const(a),o.i32_const(544),o.getLocal("r")))}(),function(){!function(){const e=t.addFunction(i+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=n.i32_add(n.getLocal("x"),n.i32_const(c)),r=n.i32_add(n.getLocal("x"),n.i32_const(2*c)),s=n.i32_add(n.getLocal("x"),n.i32_const(3*c)),l=n.i32_add(n.getLocal("x"),n.i32_const(4*c)),u=n.i32_add(n.getLocal("x"),n.i32_const(5*c)),d=n.getLocal("r"),f=n.i32_add(n.getLocal("r"),n.i32_const(c)),h=n.i32_add(n.getLocal("r"),n.i32_const(2*c)),g=n.i32_add(n.getLocal("r"),n.i32_const(3*c)),p=n.i32_add(n.getLocal("r"),n.i32_const(4*c)),_=n.i32_add(n.getLocal("r"),n.i32_const(5*c)),m=n.i32_const(t.alloc(c)),w=n.i32_const(t.alloc(c)),b=n.i32_const(t.alloc(c)),y=n.i32_const(t.alloc(c)),A=n.i32_const(t.alloc(c)),I=n.i32_const(t.alloc(c)),C=n.i32_const(t.alloc(c)),v=n.i32_const(t.alloc(c));e.addCode(n.call(L+"_mul",a,l,C),n.call(L+"_mulNR",l,m),n.call(L+"_add",a,m,m),n.call(L+"_add",a,l,v),n.call(L+"_mul",v,m,m),n.call(L+"_mulNR",C,v),n.call(L+"_add",C,v,v),n.call(L+"_sub",m,v,m),n.call(L+"_add",C,C,w),n.call(L+"_mul",s,r,C),n.call(L+"_mulNR",r,b),n.call(L+"_add",s,b,b),n.call(L+"_add",s,r,v),n.call(L+"_mul",v,b,b),n.call(L+"_mulNR",C,v),n.call(L+"_add",C,v,v),n.call(L+"_sub",b,v,b),n.call(L+"_add",C,C,y),n.call(L+"_mul",o,u,C),n.call(L+"_mulNR",u,A),n.call(L+"_add",o,A,A),n.call(L+"_add",o,u,v),n.call(L+"_mul",v,A,A),n.call(L+"_mulNR",C,v),n.call(L+"_add",C,v,v),n.call(L+"_sub",A,v,A),n.call(L+"_add",C,C,I),n.call(L+"_sub",m,a,d),n.call(L+"_add",d,d,d),n.call(L+"_add",m,d,d),n.call(L+"_add",w,l,p),n.call(L+"_add",p,p,p),n.call(L+"_add",w,p,p),n.call(L+"_mul",I,n.i32_const(q),v),n.call(L+"_add",v,s,g),n.call(L+"_add",g,g,g),n.call(L+"_add",v,g,g),n.call(L+"_sub",A,r,h),n.call(L+"_add",h,h,h),n.call(L+"_add",A,h,h),n.call(L+"_sub",b,o,f),n.call(L+"_add",f,f,f),n.call(L+"_add",b,f,f),n.call(L+"_add",y,u,_),n.call(L+"_add",_,_,_),n.call(L+"_add",y,_,_))}(),j(N,true,"w0");const e=t.addFunction(i+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.getLocal("x"),o=n.getLocal("r"),r=n.i32_const(t.alloc(l)),s=n.i32_const(t.alloc(l)),u=n.i32_const(t.alloc(l)),d=n.i32_const(t.alloc(l)),f=n.i32_const(t.alloc(l)),h=n.i32_const(t.alloc(l)),g=n.i32_const(t.alloc(l));e.addCode(n.call(U+"_frobeniusMap6",a,r),n.call(U+"_inverse",a,s),n.call(U+"_mul",r,s,u),n.call(U+"_copy",u,s),n.call(U+"_frobeniusMap2",u,u),n.call(U+"_mul",u,s,u),n.call(i+"__cyclotomicSquare",u,s),n.call(U+"_conjugate",s,s),n.call(i+"__cyclotomicExp_w0",u,d),n.call(i+"__cyclotomicSquare",d,f),n.call(U+"_mul",s,d,h),n.call(i+"__cyclotomicExp_w0",h,s),n.call(i+"__cyclotomicExp_w0",s,r),n.call(i+"__cyclotomicExp_w0",r,g),n.call(U+"_mul",g,f,g),n.call(i+"__cyclotomicExp_w0",g,f),n.call(U+"_conjugate",h,h),n.call(U+"_mul",f,h,f),n.call(U+"_mul",f,u,f),n.call(U+"_conjugate",u,h),n.call(U+"_mul",s,u,s),n.call(U+"_frobeniusMap3",s,s),n.call(U+"_mul",g,h,g),n.call(U+"_frobeniusMap1",g,g),n.call(U+"_mul",d,r,d),n.call(U+"_frobeniusMap2",d,d),n.call(U+"_mul",d,s,d),n.call(U+"_mul",d,g,d),n.call(U+"_mul",d,f,o))}();for(let e=1;e<=5;e++)$(e),t.exportFunction(i+"_pairingEq"+e);!function(){const e=t.addFunction(i+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),a=n.i32_const(t.alloc(l));e.addCode(n.call(i+"_prepareG1",n.getLocal("p"),n.i32_const(V))),e.addCode(n.call(i+"_prepareG2",n.getLocal("q"),n.i32_const(K))),e.addCode(n.call(i+"_millerLoop",n.i32_const(V),n.i32_const(K),a)),e.addCode(n.call(i+"_finalExponentiation",a,n.getLocal("r")))}(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0"),t.exportFunction(G+"_mul1"),t.exportFunction(G+"_mul01"),t.exportFunction(U+"_mul014"),t.exportFunction(m+"_inGroupAffine"),t.exportFunction(m+"_inGroup"),t.exportFunction(b+"_inGroupAffine"),t.exportFunction(b+"_inGroup")};var Zt=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return I(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=BigInt(0),i=t.length,n=0;const a=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i>0;)i>=4?(i-=4,e+=BigInt(a.getUint32(i))<<BigInt(8*n),n+=4):i>=2?(i-=2,e+=BigInt(a.getUint16(i))<<BigInt(8*n),n+=2):(i-=1,e+=BigInt(a.getUint8(i))<<BigInt(8*n),n+=1);return e},beInt2Buff:function(t,e){let i=t;const n=new Uint8Array(e),a=new DataView(n.buffer);let o=e;for(;o>0;)o-4>=0?(o-=4,a.setUint32(o,Number(i&BigInt(4294967295))),i>>=BigInt(32)):o-2>=0?(o-=2,a.setUint16(o,Number(i&BigInt(65535))),i>>=BigInt(16)):(o-=1,a.setUint8(o,Number(i&BigInt(255))),i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},leBuff2int:function(t){let e=BigInt(0),i=0;const n=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i<t.length;)i+4<=t.length?(e+=BigInt(n.getUint32(i,!0))<<BigInt(8*i),i+=4):i+4<=t.length?(e+=BigInt(n.getUint16(i,!0))<<BigInt(8*i),i+=2):(e+=BigInt(n.getUint8(i,!0))<<BigInt(8*i),i+=1);return e},leInt2Buff:function(t,e){let i=t;void 0===e&&0==(e=Math.floor((q(t)-1)/8)+1)&&(e=1);const n=new Uint8Array(e),a=new DataView(n.buffer);let o=0;for(;o<e;)o+4<=e?(a.setUint32(o,Number(i&BigInt(4294967295)),!0),o+=4,i>>=BigInt(32)):o+2<=e?(a.setUint16(Number(o,i&BigInt(65535)),!0),o+=2,i>>=BigInt(16)):(a.setUint8(Number(o,i&BigInt(255)),!0),o+=1,i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},stringifyFElements:function t(e,i){if("bigint"==typeof i||void 0!==i.eq)return i.toString(10);if(i instanceof Uint8Array)return e.toString(e.e(i));if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i},unstringifyFElements:function t(e,i){if("string"==typeof i&&/^[0-9]+$/.test(i))return e.e(i);if("string"==typeof i&&/^0x[0-9a-fA-F]+$/.test(i))return e.e(i);if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){if(null===i)return null;const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i}});var Jt=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return d(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return d(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[t.length-i-1]);e=e.add(n.shiftLeft(8*i))}return e},beInt2Buff:function(t,e){let i=t,n=e-1;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n>=0;){let t=Number(i.and(d("255")));a[n]=t,n--,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a},leBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[i]);e=e.add(n.shiftLeft(8*i))}return e},leInt2Buff:function(t,e){let i=t,n=0;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n<a.length;){let t=Number(i.and(d(255)));a[n]=t,n++,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a}});let Yt={};"function"==typeof BigInt?Object.assign(Yt,Zt):Object.assign(Yt,Jt);const Wt=[];for(let t=0;t<256;t++)Wt[t]=Xt(t,8);function Xt(t,e){let i=0,n=t;for(let t=0;t<e;t++)i<<=1,i|=1&n,n>>=1;return i}Yt.bitReverse=function(t,e){return(Wt[t>>>24]|Wt[t>>>16&255]<<8|Wt[t>>>8&255]<<16|Wt[255&t]<<24)>>>32-e},Yt.log2=function(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)},Yt.buffReverseBits=function(t,e){const i=t.byteLength/e,n=Yt.log2(i);if(i!=1<<n)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const i=Yt.bitReverse(a,n);if(a>i){const n=t.slice(a*e,(a+1)*e);t.set(t.slice(i*e,(i+1)*e),a*e),t.set(n,i*e)}}},Yt.array2buffer=function(t,e){const i=new Uint8Array(e*t.length);for(let n=0;n<t.length;n++)i.set(t[n],n*e);return i},Yt.buffer2array=function(t,e){const i=t.byteLength/e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t.slice(a*e,a*e+e);return n};let{bitReverse:te,log2:ee,buffReverseBits:ie,stringifyBigInts:ne,unstringifyBigInts:ae,beBuff2int:oe,beInt2Buff:re,leBuff2int:se,leInt2Buff:ce,array2buffer:le,buffer2array:ue,stringifyFElements:de,unstringifyFElements:fe}=Yt;var he=Object.freeze({__proto__:null,bitReverse:te,log2:ee,buffReverseBits:ie,stringifyBigInts:ne,unstringifyBigInts:ae,beBuff2int:oe,beInt2Buff:re,leBuff2int:se,leInt2Buff:ce,array2buffer:le,buffer2array:ue,stringifyFElements:de,unstringifyFElements:fe});const ge=1<<30;class pe{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=ge){const i=Math.min(t-e,ge);this.buffers.push(new Uint8Array(i))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const i=e-t,n=Math.floor(t/ge);if(n==Math.floor((t+i-1)/ge)||0==i)return this.buffers[n].slice(t%ge,t%ge+i);let a,o=n,r=t%ge,s=i;for(;s>0;){const t=r+s>ge?ge-r:s,e=new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+r,t);if(t==i)return e.slice();a||(a=i<=ge?new Uint8Array(i):new pe(i)),a.set(e,i-s),s-=t,o++,r=0}return a}set(t,e){void 0===e&&(e=0);const i=t.byteLength;if(0==i)return;const n=Math.floor(e/ge);if(n==Math.floor((e+i-1)/ge))return t instanceof pe&&1==t.buffers.length?this.buffers[n].set(t.buffers[0],e%ge):this.buffers[n].set(t,e%ge);let a=n,o=e%ge,r=i;for(;r>0;){const e=o+r>ge?ge-o:r,n=t.slice(i-r,i-r+e);new Uint8Array(this.buffers[a].buffer,this.buffers[a].byteOffset+o,e).set(n),r-=e,a++,o=0}}}function _e(t,e,i,n){return async function(a){const o=Math.floor(a.byteLength/i);if(o*i!==a.byteLength)throw new Error("Invalid buffer size");const r=Math.floor(o/t.concurrency),s=[];for(let c=0;c<t.concurrency;c++){let l;if(l=c<t.concurrency-1?r:o-c*r,0==l)continue;const u=[{cmd:"ALLOCSET",var:0,buff:a.slice(c*r*i,c*r*i+l*i)},{cmd:"ALLOC",var:1,len:n*l},{cmd:"CALL",fnName:e,params:[{var:0},{val:l},{var:1}]},{cmd:"GET",out:0,var:1,len:n*l}];s.push(t.queueAction(u))}const c=await Promise.all(s);let l;l=a instanceof pe?new pe(o*n):new Uint8Array(o*n);let u=0;for(let t=0;t<c.length;t++)l.set(c[t][0],u),u+=c[t][0].byteLength;return l}}class me{constructor(t,e,i,n){if(this.tm=t,this.prefix=e,this.p=n,this.n8=i,this.type="F1",this.m=1,this.half=P(n,B),this.bitLength=q(n),this.mask=V(z(B,this.bitLength),B),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=P(this.p,B),this.nqr=this.two;let a=this.exp(this.nqr,this.half);for(;!this.eq(a,this.negone);)this.nqr=this.add(this.nqr,this.one),a=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let o=V(this.p,B);for(;!T(o);)this.s=this.s+1,o=P(o,B);this.w=[],this.w[this.s]=this.exp(this.nqr,o);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=_e(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=_e(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=F(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let i=S(t,e);G(i)?(i=K(i),nt(i,this.p)&&(i=X(i,this.p)),i=V(this.p,i)):nt(i,this.p)&&(i=X(i,this.p));const n=ce(i,this.n8);return this.toMontgomery(n)}toString(t,e){const i=this.fromMontgomery(t),n=I(i,0);return v(n,e)}fromRng(t){let e;const i=new Uint8Array(this.n8);do{e=x;for(let i=0;i<this.n64;i++)e=j(e,z(t.nextU64(),64*i));e=rt(e,this.mask)}while(ot(e,this.p));return y(i,0,e,this.n8),i}random(){return this.fromRng(bt())}toObject(t){const e=this.fromMontgomery(t);return I(e,0)}fromObject(t){const e=new Uint8Array(this.n8);return y(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,i){t.set(this.fromMontgomery(i),e)}toRprBE(t,e,i){const n=this.fromMontgomery(i);for(let t=0;t<this.n8/2;t++){const e=n[t];n[t]=n[this.n8-1-t],n[this.n8-1-t]=e}t.set(n,e)}fromRprLE(t,e){e=e||0;const i=t.slice(e,e+this.n8);return this.toMontgomery(i)}async batchInverse(t){let e=!1;const i=this.n8,n=this.n8;Array.isArray(t)?(t=le(t,i),e=!0):t=t.slice(0,t.byteLength);const a=Math.floor(t.byteLength/i);if(a*i!==t.byteLength)throw new Error("Invalid buffer size");const o=Math.floor(a/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let s;if(s=e<this.tm.concurrency-1?o:a-e*o,0==s)continue;const c=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*o*i,e*o*i+s*i)},{cmd:"ALLOC",var:1,len:n*s},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:s},{var:1},{val:n}]},{cmd:"GET",out:0,var:1,len:n*s}];r.push(this.tm.queueAction(c))}const s=await Promise.all(r);let c;c=t instanceof pe?new pe(a*n):new Uint8Array(a*n);let l=0;for(let t=0;t<s.length;t++)c.set(s[t][0],l),l+=s[t][0].byteLength;return e?ue(c,n):c}}class Le{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F2",this.m=2*i.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*i.n8),this.pOp2=t.alloc(2*i.n8),this.pOp3=t.alloc(2*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=F(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const i=this.F.e(t[0],e),n=this.F.e(t[1],e),a=new Uint8Array(2*this.F.n8);return a.set(i),a.set(n,2*this.F.n8),a}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),i=this.F.fromRng(t),n=new Uint8Array(2*this.F.n8);return n.set(e),n.set(i,this.F.n8),n}random(){return this.fromRng(bt())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),i=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]);return e.set(i),e.set(n,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class we{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F3",this.m=3*i.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=F(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const i=this.F.e(t[0],e),n=this.F.e(t[1],e),a=this.F.e(t[2],e),o=new Uint8Array(3*this.F.n8);return o.set(i),o.set(n,this.F.n8),o.set(a,2*this.F.n8),o}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),i=this.F.fromRng(t),n=this.F.fromRng(t),a=new Uint8Array(3*this.F.n8);return a.set(e),a.set(i,this.F.n8),a.set(n,2*this.F.n8),a}random(){return this.fromRng(bt())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),i=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]),a=this.F.fromObject(t[2]);return e.set(i),e.set(n,this.F.n8),e.set(a,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class be{constructor(t,e,i,n,a,o){this.tm=t,this.prefix=e,this.F=i,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*i.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*i.n8),this.one=this.tm.getBuff(n,3*i.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(n,2*i.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(a,i.n8),o&&(this.cofactor=F(o)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=_e(t,e+"_batchLEMtoC",2*i.n8,i.n8),this.batchLEMtoU=_e(t,e+"_batchLEMtoU",2*i.n8,2*i.n8),this.batchCtoLEM=_e(t,e+"_batchCtoLEM",i.n8,2*i.n8),this.batchUtoLEM=_e(t,e+"_batchUtoLEM",2*i.n8,2*i.n8),this.batchToJacobian=_e(t,e+"_batchToJacobian",2*i.n8,3*i.n8),this.batchToAffine=_e(t,e+"_batchToAffine",3*i.n8,2*i.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let i;if(e instanceof Uint8Array||(e=F(S(e))),t.byteLength==3*this.F.n8)i=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");i=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let i;if(t.byteLength==3*this.F.n8)i=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");i=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(n,e)}fromRprUncompressed(t,e){const i=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,this.F.n8);t.set(n,e)}fromRprCompressed(t,e){const i=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,i){if(i.byteLength!=2*this.F.n8){if(i.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(n,e)}}else t.set(i,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,i=this.toAffine(t),n=i.slice(0,this.F.n8),a=i.slice(this.F.n8,2*this.F.n8),o=e.add(e.mul(e.square(n),n),this.b),r=e.square(a);return e.eq(o,r)}fromRng(t){const e=this.F;let i,n,a=[];do{a[0]=e.fromRng(t),i=t.nextBool(),n=e.add(e.mul(e.square(a[0]),a[0]),this.b)}while(!e.isSquare(n));a[1]=e.sqrt(n);i^e.isNegative(a[1])&&(a[1]=e.neg(a[1]));let o=new Uint8Array(2*this.F.n8);return o.set(a[0]),o.set(a[1],this.F.n8),this.cofactor&&(o=this.timesScalar(o,this.cofactor)),o}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let n;return n=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,i,n]}fromObject(t){const e=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);let n;if(n=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(n,this.F.one))return this.zeroAffine;if(this.F.eq(n,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(i,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(i,this.F.n8),t.set(n,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function ye(t){const e=32767;let i,n;async function a(t){const a=new Uint8Array(t.code),o=await WebAssembly.compile(a);n=new WebAssembly.Memory({initial:t.init,maximum:e}),i=await WebAssembly.instantiate(o,{env:{memory:n}})}function o(t){const i=new Uint32Array(n.buffer,0,1);for(;3&i[0];)i[0]++;const a=i[0];if(i[0]+=t,i[0]+t>n.buffer.byteLength){const a=n.buffer.byteLength/65536;let o=Math.floor((i[0]+t)/65536)+1;o>e&&(o=e),n.grow(o-a)}return a}function r(t){const e=o(t.byteLength);return c(e,t),e}function s(t,e){const i=new Uint8Array(n.buffer);return new Uint8Array(i.buffer,i.byteOffset+t,e)}function c(t,e){new Uint8Array(n.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return a(t[0]);const e={vars:[],out:[]},l=new Uint32Array(n.buffer,0,1)[0];for(let n=0;n<t.length;n++)switch(t[n].cmd){case"ALLOCSET":e.vars[t[n].var]=r(t[n].buff);break;case"ALLOC":e.vars[t[n].var]=o(t[n].len);break;case"SET":c(e.vars[t[n].var],t[n].buff);break;case"CALL":{const a=[];for(let i=0;i<t[n].params.length;i++){const o=t[n].params[i];void 0!==o.var?a.push(e.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}i.exports[t[n].fnName](...a);break}case"GET":e.out[t[n].out]=s(e.vars[t[n].var],t[n].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(n.buffer,0,1)[0]=l,e.out}return t&&(t.onmessage=function(e){let i;if(i=e.data?e.data:e,"INIT"==i[0].cmd)a(i[0]).then((function(){t.postMessage(i.result)}));else if("TERMINATE"==i[0].cmd)t.close();else{const e=l(i);t.postMessage(e)}}),l}var Ae={},Ie=Worker;class Ce{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}var ve;const Fe="data:application/javascript;base64,"+(ve="("+ye.toString()+")(self)",globalThis.btoa(ve));class xe{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,i,n){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=n||new Ce,this.workers[t].postMessage(e,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const i=new Ce;if(this.singleThread){const e=this.taskManager(t);i.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((e=>setTimeout(e,t))))}}function Be(t,e){const i=t[e],n=t.Fr,a=t.tm;t[e].batchApplyKey=async function(t,o,r,s,c){let l,u,d,f,h;if(s=s||"affine",c=c||"affine","G1"==e)"jacobian"==s?(d=3*i.F.n8,l="g1m_batchApplyKey"):(d=2*i.F.n8,l="g1m_batchApplyKeyMixed"),f=3*i.F.n8,"jacobian"==c?h=3*i.F.n8:(u="g1m_batchToAffine",h=2*i.F.n8);else if("G2"==e)"jacobian"==s?(d=3*i.F.n8,l="g2m_batchApplyKey"):(d=2*i.F.n8,l="g2m_batchApplyKeyMixed"),f=3*i.F.n8,"jacobian"==c?h=3*i.F.n8:(u="g2m_batchToAffine",h=2*i.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);l="frm_batchApplyKey",d=i.n8,f=i.n8,h=i.n8}const g=Math.floor(t.byteLength/d),p=Math.floor(g/a.concurrency),_=[];r=n.e(r);let m=n.e(o);for(let e=0;e<a.concurrency;e++){let i;if(i=e<a.concurrency-1?p:g-e*p,0==i)continue;const o=[];o.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*p*d,e*p*d+i*d)}),o.push({cmd:"ALLOCSET",var:1,buff:m}),o.push({cmd:"ALLOCSET",var:2,buff:r}),o.push({cmd:"ALLOC",var:3,len:i*Math.max(f,h)}),o.push({cmd:"CALL",fnName:l,params:[{var:0},{val:i},{var:1},{var:2},{var:3}]}),u&&o.push({cmd:"CALL",fnName:u,params:[{var:3},{val:i},{var:3}]}),o.push({cmd:"GET",out:0,var:3,len:i*h}),_.push(a.queueAction(o)),m=n.mul(m,n.exp(r,i))}const L=await Promise.all(_);let w;w=t instanceof pe?new pe(g*h):new Uint8Array(g*h);let b=0;for(let t=0;t<L.length;t++)w.set(L[t][0],b),b+=L[t][0].byteLength;return w}}const Ee=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Se(t,e){const i=t[e],n=i.tm;async function a(t,n,a,o,r){if(!(t instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffBases is not Uint8Array`),new Error(`${r} _multiExpChunk buffBases is not Uint8Array`);if(!(n instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${r} _multiExpChunk buffScalars is not Uint8Array`);let s,c;if(a=a||"affine","G1"==e)"affine"==a?(c="g1m_multiexpAffine_chunk",s=2*i.F.n8):(c="g1m_multiexp_chunk",s=3*i.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==a?(c="g2m_multiexpAffine_chunk",s=2*i.F.n8):(c="g2m_multiexp_chunk",s=3*i.F.n8)}const l=Math.floor(t.byteLength/s);if(0==l)return i.zero;const u=Math.floor(n.byteLength/l);if(u*l!=n.byteLength)throw new Error("Scalar size does not match");const d=Ee[ee(l)],f=Math.floor((8*u-1)/d)+1,h=[];for(let e=0;e<f;e++){const a=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:n},{cmd:"ALLOC",var:2,len:3*i.F.n8},{cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:u},{val:l},{val:e*d},{val:Math.min(8*u-e*d,d)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*i.F.n8}];h.push(i.tm.queueAction(a))}const g=await Promise.all(h);let p=i.zero;for(let t=g.length-1;t>=0;t--){if(!i.isZero(p))for(let t=0;t<d;t++)p=i.double(p);p=i.add(p,g[t][0])}return p}async function o(t,o,r,s,c){const l=1<<22;let u;if("G1"==e)u="affine"==r?2*i.F.n8:3*i.F.n8;else{if("G2"!=e)throw new Error("Invalid group");u="affine"==r?2*i.F.n8:3*i.F.n8}const d=Math.floor(t.byteLength/u),f=Math.floor(o.byteLength/d);if(f*d!=o.byteLength)throw new Error("Scalar size does not match");const h=Ee[ee(d)],g=Math.floor((8*f-1)/h)+1;let p;p=Math.floor(d/(n.concurrency/g)),p>l&&(p=l),p<1024&&(p=1024);const _=[];for(let e=0;e<d;e+=p){s&&s.debug(`Multiexp start: ${c}: ${e}/${d}`);const i=Math.min(d-e,p),n=t.slice(e*u,(e+i)*u),l=o.slice(e*f,(e+i)*f);_.push(a(n,l,r,s,c).then((t=>(s&&s.debug(`Multiexp end: ${c}: ${e}/${d}`),t))))}const m=await Promise.all(_);let L=i.zero;for(let t=m.length-1;t>=0;t--)L=i.add(L,m[t]);return L}i.multiExp=async function(t,e,i,n){return await o(t,e,"jacobian",i,n)},i.multiExpAffine=async function(t,e,i,n){return await o(t,e,"affine",i,n)}}function Oe(t,e){const i=t[e],n=t.Fr,a=i.tm;async function o(t,s,c,l,u,d){c=c||"affine",l=l||"affine";let f,h,g,p,_,m,L,w;"G1"==e?("affine"==c?(f=2*i.F.n8,p="g1m_batchToJacobian"):f=3*i.F.n8,h=3*i.F.n8,s&&(w="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==l?(g=2*i.F.n8,_="g1m_batchToAffine"):g=3*i.F.n8):"G2"==e?("affine"==c?(f=2*i.F.n8,p="g2m_batchToJacobian"):f=3*i.F.n8,h=3*i.F.n8,s&&(w="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==l?(g=2*i.F.n8,_="g2m_batchToAffine"):g=3*i.F.n8):"Fr"==e&&(f=i.n8,h=i.n8,g=i.n8,s&&(w="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let b=!1;Array.isArray(t)?(t=le(t,f),b=!0):t=t.slice(0,t.byteLength);const y=t.byteLength/f,A=ee(y);if(1<<A!=y)throw new Error("fft must be multiple of 2");if(A==n.s+1){let e;return e=s?await async function(t,e,i,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const u=[];u.push(o(c,!0,e,"jacobian",a,s)),u.push(o(l,!0,e,"jacobian",a,s)),[c,l]=await Promise.all(u);const d=await r(c,l,"fftJoinExtInv",n.one,n.shiftInv,"jacobian",i,a,s);let f;f=d[0].byteLength>1<<28?new pe(2*d[0].byteLength):new Uint8Array(2*d[0].byteLength);return f.set(d[0]),f.set(d[1],d[0].byteLength),f}(t,c,l,u,d):await async function(t,e,i,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const u=[];[c,l]=await r(c,l,"fftJoinExt",n.one,n.shift,e,"jacobian",a,s),u.push(o(c,!1,"jacobian",i,a,s)),u.push(o(l,!1,"jacobian",i,a,s));const d=await Promise.all(u);let f;f=d[0].byteLength>1<<28?new pe(2*d[0].byteLength):new Uint8Array(2*d[0].byteLength);return f.set(d[0]),f.set(d[1],d[0].byteLength),f}(t,c,l,u,d),b?ue(e,g):e}let I,C,v;s&&(I=n.inv(n.e(y))),ie(t,f);let F=Math.min(16384,y),x=y/F;for(;x<a.concurrency&&F>=16;)x*=2,F/=2;const B=ee(F),E=[];for(let e=0;e<x;e++){u&&u.debug(`${d}: fft ${A} mix start: ${e}/${x}`);const i=[];i.push({cmd:"ALLOC",var:0,len:h*F});const n=t.slice(F*e*f,F*(e+1)*f);i.push({cmd:"SET",var:0,buff:n}),p&&i.push({cmd:"CALL",fnName:p,params:[{var:0},{val:F},{var:0}]});for(let t=1;t<=B;t++)i.push({cmd:"CALL",fnName:m,params:[{var:0},{val:F},{val:t}]});B==A?(w&&(i.push({cmd:"ALLOCSET",var:1,buff:I}),i.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:1}]})),_&&i.push({cmd:"CALL",fnName:_,params:[{var:0},{val:F},{var:0}]}),i.push({cmd:"GET",out:0,var:0,len:F*g})):i.push({cmd:"GET",out:0,var:0,len:h*F}),E.push(a.queueAction(i).then((t=>(u&&u.debug(`${d}: fft ${A} mix end: ${e}/${x}`),t))))}v=await Promise.all(E);for(let t=0;t<x;t++)v[t]=v[t][0];for(let t=B+1;t<=A;t++){u&&u.debug(`${d}: fft  ${A}  join: ${t}/${A}`);const e=1<<A-t,i=x/e,o=[];for(let r=0;r<e;r++)for(let s=0;s<i/2;s++){const c=n.exp(n.w[t],s*F),l=n.w[t],f=r*i+s,p=r*i+s+i/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:v[f]}),m.push({cmd:"ALLOCSET",var:1,buff:v[p]}),m.push({cmd:"ALLOCSET",var:2,buff:c}),m.push({cmd:"ALLOCSET",var:3,buff:l}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:F},{var:2},{var:3}]}),t==A?(w&&(m.push({cmd:"ALLOCSET",var:4,buff:I}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:4}]}),m.push({cmd:"CALL",fnName:w,params:[{var:1},{val:F},{var:4}]})),_&&(m.push({cmd:"CALL",fnName:_,params:[{var:0},{val:F},{var:0}]}),m.push({cmd:"CALL",fnName:_,params:[{var:1},{val:F},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:F*g}),m.push({cmd:"GET",out:1,var:1,len:F*g})):(m.push({cmd:"GET",out:0,var:0,len:F*h}),m.push({cmd:"GET",out:1,var:1,len:F*h})),o.push(a.queueAction(m).then((n=>(u&&u.debug(`${d}: fft ${A} join  ${t}/${A}  ${r+1}/${e} ${s}/${i/2}`),n))))}const r=await Promise.all(o);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){const n=t*i+e,a=t*i+e+i/2,o=r.shift();v[n]=o[0],v[a]=o[1]}}if(C=t instanceof pe?new pe(y*g):new Uint8Array(y*g),s){C.set(v[0].slice((F-1)*g));let t=g;for(let e=x-1;e>0;e--)C.set(v[e],t),t+=F*g,delete v[e];C.set(v[0].slice(0,(F-1)*g),t),delete v[0]}else for(let t=0;t<x;t++)C.set(v[t],F*g*t),delete v[t];return b?ue(C,g):C}async function r(t,o,r,s,c,l,u,d,f){let h,g,p,_,m,L;if("G1"==e)"affine"==l?(m=2*i.F.n8,g="g1m_batchToJacobian"):m=3*i.F.n8,L=3*i.F.n8,h="g1m_"+r,"affine"==u?(p="g1m_batchToAffine",_=2*i.F.n8):_=3*i.F.n8;else if("G2"==e)"affine"==l?(m=2*i.F.n8,g="g2m_batchToJacobian"):m=3*i.F.n8,h="g2m_"+r,L=3*i.F.n8,"affine"==u?(p="g2m_batchToAffine",_=2*i.F.n8):_=3*i.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");m=n.n8,_=n.n8,L=n.n8,h="frm_"+r}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const w=Math.floor(t.byteLength/m);if(w!=1<<ee(w))throw new Error("Invalid number of points");let b=Math.floor(w/a.concurrency);b<16&&(b=16),b>65536&&(b=65536);const y=[];for(let e=0;e<w;e+=b){d&&d.debug(`${f}: fftJoinExt Start: ${e}/${w}`);const i=Math.min(w-e,b),r=n.mul(s,n.exp(c,e)),l=[],u=t.slice(e*m,(e+i)*m),A=o.slice(e*m,(e+i)*m);l.push({cmd:"ALLOC",var:0,len:L*i}),l.push({cmd:"SET",var:0,buff:u}),l.push({cmd:"ALLOC",var:1,len:L*i}),l.push({cmd:"SET",var:1,buff:A}),l.push({cmd:"ALLOCSET",var:2,buff:r}),l.push({cmd:"ALLOCSET",var:3,buff:c}),g&&(l.push({cmd:"CALL",fnName:g,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:g,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:i},{var:2},{var:3},{val:n.s}]}),p&&(l.push({cmd:"CALL",fnName:p,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:p,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"GET",out:0,var:0,len:i*_}),l.push({cmd:"GET",out:1,var:1,len:i*_}),y.push(a.queueAction(l).then((t=>(d&&d.debug(`${f}: fftJoinExt End: ${e}/${w}`),t))))}const A=await Promise.all(y);let I,C;w*_>1<<28?(I=new pe(w*_),C=new pe(w*_)):(I=new Uint8Array(w*_),C=new Uint8Array(w*_));let v=0;for(let t=0;t<A.length;t++)I.set(A[t][0],v),C.set(A[t][1],v),v+=A[t][0].byteLength;return[I,C]}i.fft=async function(t,e,i,n,a){return await o(t,!1,e,i,n,a)},i.ifft=async function(t,e,i,n,a){return await o(t,!0,e,i,n,a)},i.lagrangeEvaluations=async function(t,a,s,c,l){let u;if(a=a||"affine",s=s||"affine","G1"==e)u="affine"==a?2*i.F.n8:3*i.F.n8;else if("G2"==e)u="affine"==a?2*i.F.n8:3*i.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");u=n.n8}const d=t.byteLength/u,f=ee(d);if(2**f*u!=t.byteLength)throw c&&c.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(f<=n.s)return await i.ifft(t,a,s,c,l);if(f>n.s+1)throw c&&c.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let h=t.slice(0,t.byteLength/2),g=t.slice(t.byteLength/2,t.byteLength);const p=n.exp(n.shift,d/2),_=n.inv(n.sub(n.one,p));[h,g]=await r(h,g,"prepareLagrangeEvaluation",_,n.shiftInv,a,"jacobian",c,l+" prep");const m=[];let L;return m.push(o(h,!0,"jacobian",s,c,l+" t0")),m.push(o(g,!0,"jacobian",s,c,l+" t1")),[h,g]=await Promise.all(m),L=h.byteLength>1<<28?new pe(2*h.byteLength):new Uint8Array(2*h.byteLength),L.set(h),L.set(g,h.byteLength),L},i.fftMix=async function(t){const o=3*i.F.n8;let r,s;if("G1"==e)r="g1m_fftMix",s="g1m_fftJoin";else if("G2"==e)r="g2m_fftMix",s="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");r="frm_fftMix",s="frm_fftJoin"}const c=Math.floor(t.byteLength/o),l=ee(c);let u=1<<ee(a.concurrency);c<=2*u&&(u=1);const d=c/u,f=ee(d),h=[];for(let e=0;e<u;e++){const i=[],n=t.slice(e*d*o,(e+1)*d*o);i.push({cmd:"ALLOCSET",var:0,buff:n});for(let t=1;t<=f;t++)i.push({cmd:"CALL",fnName:r,params:[{var:0},{val:d},{val:t}]});i.push({cmd:"GET",out:0,var:0,len:d*o}),h.push(a.queueAction(i))}const g=await Promise.all(h),p=[];for(let t=0;t<g.length;t++)p[t]=g[t][0];for(let t=f+1;t<=l;t++){const e=1<<l-t,i=u/e,r=[];for(let c=0;c<e;c++)for(let e=0;e<i/2;e++){const l=n.exp(n.w[t],e*d),u=n.w[t],f=c*i+e,h=c*i+e+i/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:p[f]}),g.push({cmd:"ALLOCSET",var:1,buff:p[h]}),g.push({cmd:"ALLOCSET",var:2,buff:l}),g.push({cmd:"ALLOCSET",var:3,buff:u}),g.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:d},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:d*o}),g.push({cmd:"GET",out:1,var:1,len:d*o}),r.push(a.queueAction(g))}const c=await Promise.all(r);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){const n=t*i+e,a=t*i+e+i/2,o=c.shift();p[n]=o[0],p[a]=o[1]}}let _;_=t instanceof pe?new pe(c*o):new Uint8Array(c*o);let m=0;for(let t=0;t<u;t++)_.set(p[t],m),m+=p[t].byteLength;return _},i.fftJoin=async function(t,o,r,s){const c=3*i.F.n8;let l;if("G1"==e)l="g1m_fftJoin";else if("G2"==e)l="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");l="frm_fftJoin"}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const u=Math.floor(t.byteLength/c);if(u!=1<<ee(u))throw new Error("Invalid number of points");let d=1<<ee(a.concurrency);u<=2*d&&(d=1);const f=u/d,h=[];for(let e=0;e<d;e++){const i=[],u=n.mul(r,n.exp(s,e*f)),d=t.slice(e*f*c,(e+1)*f*c),g=o.slice(e*f*c,(e+1)*f*c);i.push({cmd:"ALLOCSET",var:0,buff:d}),i.push({cmd:"ALLOCSET",var:1,buff:g}),i.push({cmd:"ALLOCSET",var:2,buff:u}),i.push({cmd:"ALLOCSET",var:3,buff:s}),i.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:f},{var:2},{var:3}]}),i.push({cmd:"GET",out:0,var:0,len:f*c}),i.push({cmd:"GET",out:1,var:1,len:f*c}),h.push(a.queueAction(i))}const g=await Promise.all(h);let p,_;t instanceof pe?(p=new pe(u*c),_=new pe(u*c)):(p=new Uint8Array(u*c),_=new Uint8Array(u*c));let m=0;for(let t=0;t<g.length;t++)p.set(g[t][0],m),_.set(g[t][1],m),m+=g[t][0].byteLength;return[p,_]},i.fftFinal=async function(t,n){const o=3*i.F.n8,r=2*i.F.n8;let s,c;if("G1"==e)s="g1m_fftFinal",c="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");s="g2m_fftFinal",c="g2m_batchToAffine"}const l=Math.floor(t.byteLength/o);if(l!=1<<ee(l))throw new Error("Invalid number of points");const u=Math.floor(l/a.concurrency),d=[];for(let e=0;e<a.concurrency;e++){let i;if(i=e<a.concurrency-1?u:l-e*u,0==i)continue;const f=[],h=t.slice(e*u*o,(e*u+i)*o);f.push({cmd:"ALLOCSET",var:0,buff:h}),f.push({cmd:"ALLOCSET",var:1,buff:n}),f.push({cmd:"CALL",fnName:s,params:[{var:0},{val:i},{var:1}]}),f.push({cmd:"CALL",fnName:c,params:[{var:0},{val:i},{var:0}]}),f.push({cmd:"GET",out:0,var:0,len:i*r}),d.push(a.queueAction(f))}const f=await Promise.all(d);let h;h=t instanceof pe?new pe(l*r):new Uint8Array(l*r);let g=0;for(let t=f.length-1;t>=0;t--)h.set(f[t][0],g),g+=f[t][0].byteLength;return h}}async function qe(t){const e=await async function(t,e){const i=new xe;i.memory=new WebAssembly.Memory({initial:25}),i.u8=new Uint8Array(i.memory.buffer),i.u32=new Uint32Array(i.memory.buffer);const n=await WebAssembly.compile(t.code);if(i.instance=await WebAssembly.instantiate(n,{env:{memory:i.memory}}),i.singleThread=e,i.initalPFree=i.u32[0],i.pq=t.pq,i.pr=t.pr,i.pG1gen=t.pG1gen,i.pG1zero=t.pG1zero,i.pG2gen=t.pG2gen,i.pG2zero=t.pG2zero,i.pOneT=t.pOneT,e)i.code=t.code,i.taskManager=ye(),await i.taskManager([{cmd:"INIT",init:25,code:i.code.slice()}]),i.concurrency=1;else{let e;i.workers=[],i.pendingDeferreds=[],i.working=[],e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Ae.cpus().length,0==e&&(e=2),e>64&&(e=64),i.concurrency=e;for(let t=0;t<e;t++)i.workers[t]=new Ie(Fe),i.workers[t].addEventListener("message",a(t)),i.working[t]=!1;const n=[];for(let e=0;e<i.workers.length;e++){const a=t.code.slice();n.push(i.postAction(e,[{cmd:"INIT",init:25,code:a}],[a.buffer]))}await Promise.all(n)}return i;function a(t){return function(e){let n;n=e&&e.data?e.data:e,i.working[t]=!1,i.pendingDeferreds[t].resolve(n),i.processWorks()}}}(t.wasm,t.singleThread),i={};return i.q=S(t.wasm.q.toString()),i.r=S(t.wasm.r.toString()),i.name=t.name,i.tm=e,i.prePSize=t.wasm.prePSize,i.preQSize=t.wasm.preQSize,i.Fr=new me(e,"frm",t.n8r,t.r),i.F1=new me(e,"f1m",t.n8q,t.q),i.F2=new Le(e,"f2m",i.F1),i.G1=new be(e,"g1m",i.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),i.G2=new be(e,"g2m",i.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),i.F6=new we(e,"f6m",i.F2),i.F12=new Le(e,"ftm",i.F6),i.Gt=i.F12,Be(i,"G1"),Be(i,"G2"),Be(i,"Fr"),Se(i,"G1"),Se(i,"G2"),Oe(i,"G1"),Oe(i,"G2"),Oe(i,"Fr"),function(t){const e=t.tm;t.pairing=function(i,n){e.startSyncOp();const a=e.allocBuff(t.G1.toJacobian(i)),o=e.allocBuff(t.G2.toJacobian(n)),r=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](a,o,r);const s=e.getBuff(r,t.Gt.n8);return e.endSyncOp(),s},t.pairingEq=async function(){let i,n;arguments.length%2==1?(i=arguments[arguments.length-1],n=(arguments.length-1)/2):(i=t.Gt.one,n=arguments.length/2);const a=[];for(let i=0;i<n;i++){const n=[],o=t.G1.toJacobian(arguments[2*i]);n.push({cmd:"ALLOCSET",var:0,buff:o}),n.push({cmd:"ALLOC",var:1,len:t.prePSize});const r=t.G2.toJacobian(arguments[2*i+1]);n.push({cmd:"ALLOCSET",var:2,buff:r}),n.push({cmd:"ALLOC",var:3,len:t.preQSize}),n.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),n.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),n.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),n.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),n.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),a.push(e.queueAction(n))}const o=await Promise.all(a);e.startSyncOp();const r=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(r);for(let t=0;t<o.length;t++){const i=e.allocBuff(o[t][0]);e.instance.exports.ftm_mul(r,i,r)}e.instance.exports[t.name+"_finalExponentiation"](r,r);const s=e.allocBuff(i),c=!!e.instance.exports.ftm_eq(r,s);return e.endSyncOp(),c},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,i);const n=this.tm.getBuff(i,this.prePSize);return this.tm.endSyncOp(),n},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,i);const n=this.tm.getBuff(i,this.preQSize);return this.tm.endSyncOp(),n},t.millerLoop=function(t,e){this.tm.startSyncOp();const i=this.tm.allocBuff(t),n=this.tm.allocBuff(e),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](i,n,a);const o=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),o},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,i);const n=this.tm.getBuff(i,this.Gt.n8);return this.tm.endSyncOp(),n}}(i),i.array2buffer=function(t,e){const i=new Uint8Array(e*t.length);for(let n=0;n<t.length;n++)i.set(t[n],n*e);return i},i.buffer2array=function(t,e){const i=t.byteLength/e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t.slice(a*e,a*e+e);return n},i}function Ge(t){let e;return e="string"==typeof t&&"0x"==t.slice(0,2).toLowerCase()?d(t.slice(2),16):d(t),e}function Ue(t){const e=[];let i=Ge(t);if(i.isNegative())throw new Error("Number cannot be negative");for(;!i.isZero();)e.push(i.and(127).toJSNumber()),i=i.shiftRight(7);0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function ze(t){let e,i;const n=t.bitLength().toJSNumber();t<0?(i=!0,e=d.one.shiftLeft(n).add(t)):(i=!1,e=Ge(t));const a=7-n%7,o=d.one.shiftLeft(a).minus(1).shiftLeft(n),r=(1<<7-a)-1|128,s=Ue(e.add(o));return i||(s[s.length-1]=s[s.length-1]&r),s}function Pe(t){let e=Ge(t);if(e.greater(d("FFFFFFFF",16)))throw new Error("Number too big");return Ue(e)}var Me=function(t){const e=function(t){for(var e=[],i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(i++,n=65536+((1023&n)<<10|1023&t.charCodeAt(i)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e}(t);return[...Pe(e.length),...e]},Qe=function t(e){if("string"==typeof e){let t=e.split("\n");for(let e=0;e<t.length;e++)t[e]&&(t[e]="    "+t[e]);return t.join("\n")}if(Array.isArray(e)){for(let i=0;i<e.length;i++)e[i]=t(e[i]);return e}},Te={toNumber:Ge,u32:function(t){const e=[],i=Ge(t);return e.push(i.and(255).toJSNumber()),e.push(i.shiftRight(8).and(255).toJSNumber()),e.push(i.shiftRight(16).and(255).toJSNumber()),e.push(i.shiftRight(24).and(255).toJSNumber()),e},u64:function(t){const e=[],i=Ge(t);return e.push(i.and(255).toJSNumber()),e.push(i.shiftRight(8).and(255).toJSNumber()),e.push(i.shiftRight(16).and(255).toJSNumber()),e.push(i.shiftRight(24).and(255).toJSNumber()),e.push(i.shiftRight(32).and(255).toJSNumber()),e.push(i.shiftRight(40).and(255).toJSNumber()),e.push(i.shiftRight(48).and(255).toJSNumber()),e.push(i.shiftRight(56).and(255).toJSNumber()),e},varuint32:Pe,varuint64:function(t){let e=Ge(t);if(e.greater(d("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");return Ue(e)},varint32:function(t){let e=Ge(t);if(e.greater(d("FFFFFFFF",16)))throw new Error("Number too big");if(e.greater(d("7FFFFFFF",16))&&(e=e.minus(d("100000000",16))),e.lesser(d("-80000000",16)))throw new Error("Number too small");return ze(e)},varint64:function(t){let e=Ge(t);if(e.greater(d("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");if(e.greater(d("7FFFFFFFFFFFFFFF",16))&&(e=e.minus(d("10000000000000000",16))),e.lesser(d("-8000000000000000",16)))throw new Error("Number too small");return ze(e)},string:Me,toHexString:function(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")},ident:Qe};var Re=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){const i=this.func.localIdxByName[t];if(void 0===i)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...Te.varuint32(i)]}teeLocal(t,e){const i=this.func.localIdxByName[t];if(void 0===i)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...Te.varuint32(i)]}getLocal(t){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Te.varuint32(e)]}i64_load8_s(t,e,i){const n=e||0;return[...t,48,void 0===i?0:i,...Te.varuint32(n)]}i64_load8_u(t,e,i){const n=e||0;return[...t,49,void 0===i?0:i,...Te.varuint32(n)]}i64_load16_s(t,e,i){const n=e||0;return[...t,50,void 0===i?1:i,...Te.varuint32(n)]}i64_load16_u(t,e,i){const n=e||0;return[...t,51,void 0===i?1:i,...Te.varuint32(n)]}i64_load32_s(t,e,i){const n=e||0;return[...t,52,void 0===i?2:i,...Te.varuint32(n)]}i64_load32_u(t,e,i){const n=e||0;return[...t,53,void 0===i?2:i,...Te.varuint32(n)]}i64_load(t,e,i){const n=e||0;return[...t,41,void 0===i?3:i,...Te.varuint32(n)]}i64_store(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=3,r=e):Array.isArray(i)?(a=e,o=3,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,55,o,...Te.varuint32(a)]}i64_store32(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=2,r=e):Array.isArray(i)?(a=e,o=2,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,62,o,...Te.varuint32(a)]}i64_store16(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=1,r=e):Array.isArray(i)?(a=e,o=1,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,61,o,...Te.varuint32(a)]}i64_store8(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=0,r=e):Array.isArray(i)?(a=e,o=0,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,60,o,...Te.varuint32(a)]}i32_load8_s(t,e,i){const n=e||0;return[...t,44,void 0===i?0:i,...Te.varuint32(n)]}i32_load8_u(t,e,i){const n=e||0;return[...t,45,void 0===i?0:i,...Te.varuint32(n)]}i32_load16_s(t,e,i){const n=e||0;return[...t,46,void 0===i?1:i,...Te.varuint32(n)]}i32_load16_u(t,e,i){const n=e||0;return[...t,47,void 0===i?1:i,...Te.varuint32(n)]}i32_load(t,e,i){const n=e||0;return[...t,40,void 0===i?2:i,...Te.varuint32(n)]}i32_store(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=2,r=e):Array.isArray(i)?(a=e,o=2,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,54,o,...Te.varuint32(a)]}i32_store16(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=1,r=e):Array.isArray(i)?(a=e,o=1,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,59,o,...Te.varuint32(a)]}i32_store8(t,e,i,n){let a,o,r;return Array.isArray(e)?(a=0,o=0,r=e):Array.isArray(i)?(a=e,o=0,r=i):Array.isArray(n)&&(a=e,o=i,r=n),[...t,...r,58,o,...Te.varuint32(a)]}call(t,...e){const i=this.module.functionIdxByName[t];if(void 0===i)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...Te.varuint32(i)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,i){return i?[...t,4,64,...e,5,...i,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,e){return[...e,13,...Te.varuint32(t)]}br(t){return[12,...Te.varuint32(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...Te.varint64(t)]}i32_const(t){return[65,...Te.varint32(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}};const ke={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};var Ne=class{constructor(t,e,i,n,a){if("import"==i)this.fnType="import",this.moduleName=n,this.fieldName=a;else{if("internal"!=i)throw new Error("Invalid function fnType: "+i);this.fnType="internal"}this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const i=this.nextLocal++;this.localIdxByName[t]=i,this.params.push({type:e})}addLocal(t,e,i){const n=i||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const a=this.nextLocal++;this.localIdxByName[t]=a,this.locals.push({type:e,length:n})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...[...Te.varuint32(this.params.length),...this.params.map((t=>ke[t.type]))],...this.returnType?[1,ke[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...Te.varuint32(t.length),ke[t.type]])),e=[...Te.varuint32(this.locals.length),...[].concat(...t),...this.code,11];return[...Te.varuint32(e.length),...e]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new Re(this)}};var De=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Te.u32(1836278016),...Te.u32(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new Ne(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,i){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let n=i||t;const a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new Ne(this,t,"import",e,n)),this.nImportFunctions++,this.functions[a]}setMemory(t,e,i){this.memory={pagesSize:t,moduleName:e||"env",fieldName:i||"memory"}}exportFunction(t,e){const i=e||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const n=this.functionIdxByName[t];i!=t&&(this.functionIdxByName[i]=n),this.exports.push({exportName:i,idx:n})}addFunctionToTable(t){const e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let i,n;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(i=t.length,n=t):(i=t,n=e),i=1+(i-1>>3)<<3;const a=this.free;return this.free+=i,n&&this.addData(a,n),a}allocString(t){const e=(new globalThis.TextEncoder).encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const e=this.functions[this.functionsTable[0]].getSignature();t["s_"+Te.toHexString(e)]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){const i=this.functions[e].getSignature(),n="s_"+Te.toHexString(i);void 0===t[n]&&(t[n]=this.signatures.length,this.signatures.push(i)),this.functions[e].signatureIdx=t[n]}}_buildSection(t,e){return[t,...Te.varuint32(e.length),...e]}_buildType(){return this._buildSection(1,[...Te.varuint32(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Te.string(this.memory.moduleName),...Te.string(this.memory.fieldName),2,0,...Te.varuint32(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...Te.string(this.functions[e].moduleName),...Te.string(this.functions[e].fieldName),0,...Te.varuint32(this.functions[e].signatureIdx)]);return this._buildSection(2,Te.varuint32(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...Te.varuint32(this.functions[e].signatureIdx));return this._buildSection(3,[...Te.varuint32(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...Te.varuint32(1),112,0,...Te.varuint32(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...Te.varuint32(this.functionsTable[e]));return this._buildSection(9,[...Te.varuint32(1),...Te.varuint32(0),65,...Te.varint32(0),11,...Te.varuint32(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let e=0;e<this.exports.length;e++)t.push([...Te.string(this.exports[e].exportName),0,...Te.varuint32(this.exports[e].idx)]);return this._buildSection(7,Te.varuint32(t.length).concat(...t))}_buildCode(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,Te.varuint32(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Te.u32(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...Te.varint32(this.datas[e].offset),11,...Te.varuint32(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,Te.varuint32(t.length).concat(...t))}},je=De;async function Ve(t,e){const i=new je;i.setMemory(25),$t(i),e&&e(i);const n={};if(n.code=i.build(),n.pq=i.modules.f1m.pq,n.pr=i.modules.frm.pq,n.pG1gen=i.modules.bn128.pG1gen,n.pG1zero=i.modules.bn128.pG1zero,n.pG1b=i.modules.bn128.pG1b,n.pG2gen=i.modules.bn128.pG2gen,n.pG2zero=i.modules.bn128.pG2zero,n.pG2b=i.modules.bn128.pG2b,n.pOneT=i.modules.bn128.pOneT,n.prePSize=i.modules.bn128.prePSize,n.preQSize=i.modules.bn128.preQSize,n.n8q=32,n.n8r=32,n.q=i.modules.bn128.q,n.r=i.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const a={name:"bn128",wasm:n,q:S("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:S("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:S("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},o=await qe(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=o),o}async function Ke(t,e){const i=new je;i.setMemory(25),Ht(i),e&&e(i);const n={};if(n.code=i.build(),n.pq=i.modules.f1m.pq,n.pr=i.modules.frm.pq,n.pG1gen=i.modules.bls12381.pG1gen,n.pG1zero=i.modules.bls12381.pG1zero,n.pG1b=i.modules.bls12381.pG1b,n.pG2gen=i.modules.bls12381.pG2gen,n.pG2zero=i.modules.bls12381.pG2zero,n.pG2b=i.modules.bls12381.pG2b,n.pOneT=i.modules.bls12381.pOneT,n.prePSize=i.modules.bls12381.prePSize,n.preQSize=i.modules.bls12381.preQSize,n.n8q=48,n.n8r=32,n.q=i.modules.bls12381.q,n.r=i.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const a={name:"bls12381",wasm:n,q:S("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:S("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:S("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:S("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},o=await qe(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=o),o}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,S("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),S("21888242871839275222246405745257275088548364400416034343698204186575808495617"),S("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),S("21888242871839275222246405745257275088696311157297823662689037894645226208583");const $e=ft,He=he;var Ze={};async function Je(t,e,i,n){if(i=i||262144,["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const a=await Ze.promises.open(t,e),o=await a.stat();return new Ye(a,o,i,n,t)}class Ye{constructor(t,e,i,n,a){for(this.fileName=a,this.fd=t,this.pos=0,this.pageSize=n||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(i/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const e=this,i=new Promise(((i,n)=>{e.pendingLoads.push({page:t,resolve:i,reject:n})}));return e.__statusPage("After Load request: ",t),i}__statusPage(t,e){const i=[],n=this;if(!n.logHistory)return;i.push("=="+t+" "+e);let a="";for(let t=0;t<n.pendingLoads.length;t++)n.pendingLoads[t].page==e&&(a=a+" "+t);if(a&&i.push("Pending loads:"+a),void 0!==n.pages[e]){const t=n.pages[e];i.push("Loaded"),i.push("pendingOps: "+t.pendingOps),t.loading&&i.push("loading: "+t.loading),t.writing&&i.push("writing"),t.dirty&&i.push("dirty")}i.push("=="),n.history[e]||(n.history[e]=[]),n.history[e].push(i)}__printHistory(t){const e=this;e.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let i=0;i<e.history[t].length;i++)for(let n=0;n<e.history[t][i].length;n++)console.log("-> "+e.history[t][i][n])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const e=Object.keys(t.pages),i=[];for(let n=0;n<e.length;n++){const a=t.pages[parseInt(e[n])];0!=a.dirty||0!=a.pendingOps||a.writing||a.loading||i.push(parseInt(e[n]))}let n=t.maxPagesLoaded-e.length;const a=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||n>0||i.length>0);){const e=t.pendingLoads.shift();if(void 0!==t.pages[e.page]){t.pages[e.page].pendingOps++;const n=i.indexOf(e.page);n>=0&&i.splice(n,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(n)n--;else{const e=i.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=o(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=o(),t.pages[e.page].loading=[e],a.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then((i=>{t.pages[e.page].size=i.bytesRead;const n=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<n.length;t++)n[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),i}),(t=>{e.reject(t)}))),t.__statusPage("After Load (loading): ",e.page))}}function o(){if(t.avBuffs.length>0){const e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(a).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const e=Object.keys(t.pages),i=[];for(let n=0;n<e.length;n++){const a=t.pages[parseInt(e[n])];a.dirty&&(a.dirty=!1,a.writing=!0,t.writing=!0,i.push(t.fd.write(a.buff,0,a.size,parseInt(e[n])*t.pageSize).then((()=>{a.writing=!1}),(e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()}))))}t.writing&&Promise.all(i).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,e){if(0==t.byteLength)return;const i=this;if(void 0===e&&(e=i.pos),i.pos=e+t.byteLength,i.totalSize<e+t.byteLength&&(i.totalSize=e+t.byteLength),i.pendingClose)throw new Error("Writing a closing file");const n=Math.floor(e/i.pageSize),a=Math.floor((e+t.byteLength-1)/i.pageSize),o=[];for(let t=n;t<=a;t++)o.push(i._loadPage(t));i._triggerLoad();let r=n,s=e%i.pageSize,c=t.byteLength;for(;c>0;){await o[r-n];const e=s+c>i.pageSize?i.pageSize-s:c,a=t.slice(t.byteLength-c,t.byteLength-c+e);new Uint8Array(i.pages[r].buff.buffer,s,e).set(a),i.pages[r].dirty=!0,i.pages[r].pendingOps--,i.pages[r].size=Math.max(s+e,i.pages[r].size),r>=i.totalPages&&(i.totalPages=r+1),c-=e,r++,s=0,i.writing||setImmediate(i._triggerWrite.bind(i))}}async read(t,e){let i=new Uint8Array(t);return await this.readToBuffer(i,0,t,e),i}async readToBuffer(t,e,i,n){if(0==i)return;const a=this;if(i>a.pageSize*a.maxPagesLoaded*.8){const t=Math.floor(1.1*i);this.maxPagesLoaded=Math.floor(t/a.pageSize)+1}if(void 0===n&&(n=a.pos),a.pos=n+i,a.pendingClose)throw new Error("Reading a closing file");const o=Math.floor(n/a.pageSize),r=Math.floor((n+i-1)/a.pageSize),s=[];for(let t=o;t<=r;t++)s.push(a._loadPage(t));a._triggerLoad();let c=o,l=n%a.pageSize,u=n+i>a.totalSize?i-(n+i-a.totalSize):i;for(;u>0;){await s[c-o],a.__statusPage("After Await (read): ",c);const n=l+u>a.pageSize?a.pageSize-l:u,r=new Uint8Array(a.pages[c].buff.buffer,a.pages[c].buff.byteOffset+l,n);t.set(r,e+i-u),a.pages[c].pendingOps--,a.__statusPage("After Op done: ",c),u-=n,c++,l=0,a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a))}this.pos=n+i}_tryClose(){const t=this;if(!t.pendingClose)return;t.error&&t.pendingCloseReject(t.error);t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((e,i)=>{t.pendingClose=e,t.pendingCloseReject=i,t._tryClose()})).then((()=>{t.fd.close()}),(e=>{throw t.fd.close(),e}))}async discard(){await this.close(),await Ze.promises.unlink(this.fileName)}async writeULE32(t,e){const i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,t,!0),await this.write(i,e)}async writeUBE32(t,e){const i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,t,!1),await this.write(i,e)}async writeULE64(t,e){const i=new Uint8Array(8),n=new DataView(i.buffer);n.setUint32(0,4294967295&t,!0),n.setUint32(4,Math.floor(t/4294967296),!0),await this.write(i,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),i=new Uint32Array(e.buffer);return 4294967296*i[1]+i[0]}}const We=new Uint8Array(4),Xe=new DataView(We.buffer),ti=new Uint8Array(8),ei=new DataView(ti.buffer);class ii{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const e=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),i=new Uint8Array(e);i.set(this.o.data),this.o.data=i,this.allocSize=e}}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,i,n){if(void 0===n&&(n=this.pos),this.readOnly&&n+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(n+i);const a=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+n,i);t.set(a,e),this.pos=n+i}async read(t,e){const i=new Uint8Array(t);return await this.readToBuffer(i,0,t,e),i}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){Xe.setUint32(0,t,!0),await this.write(We,e)}async writeUBE32(t,e){Xe.setUint32(0,t,!1),await this.write(We,e)}async writeULE64(t,e){ei.setUint32(0,4294967295&t,!0),ei.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ti,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),i=new Uint32Array(e.buffer);return 4294967296*i[1]+i[0]}}const ni=1<<22;const ai=new Uint8Array(4),oi=new DataView(ai.buffer),ri=new Uint8Array(8),si=new DataView(ri.buffer);class ci{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const e=Math.floor((t-1)/ni)+1;for(let i=Math.max(this.o.data.length-1,0);i<e;i++){const n=new Uint8Array(i<e-1?ni:t-(e-1)*ni);i==this.o.data.length-1&&n.set(this.o.data[i]),this.o.data[i]=n}this.totalSize=t}async write(t,e){const i=this;if(void 0===e&&(e=i.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let n=Math.floor(e/ni),a=e%ni,o=t.byteLength;for(;o>0;){const e=a+o>ni?ni-a:o,r=t.slice(t.byteLength-o,t.byteLength-o+e);new Uint8Array(i.o.data[n].buffer,a,e).set(r),o-=e,n++,a=0}this.pos=e+t.byteLength}async readToBuffer(t,e,i,n){const a=this;if(void 0===n&&(n=a.pos),this.readOnly&&n+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(n+i);let o=Math.floor(n/ni),r=n%ni,s=i;for(;s>0;){const n=r+s>ni?ni-r:s,c=new Uint8Array(a.o.data[o].buffer,r,n);t.set(c,e+i-s),s-=n,o++,r=0}this.pos=n+i}async read(t,e){const i=new Uint8Array(t);return await this.readToBuffer(i,0,t,e),i}close(){}async discard(){}async writeULE32(t,e){oi.setUint32(0,t,!0),await this.write(ai,e)}async writeUBE32(t,e){oi.setUint32(0,t,!1),await this.write(ai,e)}async writeULE64(t,e){si.setUint32(0,4294967295&t,!0),si.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ri,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),i=new Uint32Array(e.buffer);return 4294967296*i[1]+i[0]}}async function li(t,e,i){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||65536,pageSize:i||8192}),"file"==t.type)return await Je(t.fileName,"w+",t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const e=t.initialSize||1<<20,i=new ii;return i.o=t,i.o.data=new Uint8Array(e),i.allocSize=e,i.totalSize=0,i.readOnly=!1,i.pos=0,i}(t);if("bigMem"==t.type)return function(t){const e=t.initialSize||0,i=new ci;i.o=t;const n=e?Math.floor((e-1)/ni)+1:0;i.o.data=[];for(let t=0;t<n-1;t++)i.o.data.push(new Uint8Array(ni));return n&&i.o.data.push(new Uint8Array(e-ni*(n-1))),i.totalSize=0,i.readOnly=!1,i.pos=0,i}(t);throw new Error("Invalid FastFile type: "+t.type)}async function ui(t,e,i){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t){t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}}if("file"==t.type)return await Je(t.fileName,"r",t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const e=new ii;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){const e=new ci;return e.o=t,e.totalSize=(t.data.length-1)*ni+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function di(t,e,i,n,a){const o=await ui(t),r=await o.read(4);let s="";for(let t=0;t<4;t++)s+=String.fromCharCode(r[t]);if(s!=e)throw new Error(t+": Invalid File format");if(await o.readULE32()>i)throw new Error("Version not supported");const c=await o.readULE32();let l=[];for(let t=0;t<c;t++){let t=await o.readULE32(),e=await o.readULE64();void 0===l[t]&&(l[t]=[]),l[t].push({p:o.pos,size:e}),o.pos+=e}return{fd:o,sections:l}}async function fi(t,e,i,n,a,o){const r=await li(t,a,o),s=new Uint8Array(4);for(let t=0;t<4;t++)s[t]=e.charCodeAt(t);return await r.write(s,0),await r.writeULE32(i),await r.writeULE32(n),r}async function hi(t,e){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function gi(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const e=t.pos-t.writingSection.pSectionSize-8,i=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=i,delete t.writingSection}async function pi(t,e,i){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!e[i])throw new Error(t.fileName+": Missing section "+i);if(e[i].length>1)throw new Error(t.fileName+": Section Duplicated "+i);t.pos=e[i][0].p,t.readingSection=e[i][0]}async function _i(t,e){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function mi(t,e,i,n){const a=new Uint8Array(i);$e.toRprLE(a,0,e,i),await t.write(a,n)}async function Li(t,e,i){const n=await t.read(e,i);return $e.fromRprLE(n,0,e)}async function wi(t,e,i,n,a){void 0===a&&(a=e[n][0].size);const o=t.pageSize;await pi(t,e,n),await hi(i,n);for(let e=0;e<a;e+=o){const n=Math.min(a-e,o),r=await t.read(n);await i.write(r)}await gi(i),await _i(t,a!=e[n][0].size)}async function bi(t,e,i,n,a){if((n=void 0===n?0:n)+(a=void 0===a?e[i][0].size-n:a)>e[i][0].size)throw new Error("Reading out of the range of the section");let o;return o=a<1<<30?new Uint8Array(a):new pe(a),await t.readToBuffer(o,0,a,e[i][0].p+n),o}async function yi(t,e,i,n,a){const o=16*t.pageSize;if(await pi(t,e,a),await pi(i,n,a),e[a][0].size!=n[a][0].size)return!1;const r=e[a][0].size;for(let e=0;e<r;e+=o){const n=Math.min(r-e,o),a=await t.read(n),s=await i.read(n);for(let t=0;t<n;t++)if(a[t]!=s[t])return!1}return await _i(t),await _i(i),!0}$e.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),$e.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Ai=$e.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Ii=$e.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Ci(t){let e;if($e.eq(t,Ii))e=await Ve();else{if(!$e.eq(t,Ai))throw new Error(`Curve not supported: ${$e.toString(t)}`);e=await Ke()}return e}async function vi(t){let e;const i=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(i)>=0)e=await Ve();else{if(!(["BLS12381"].indexOf(i)>=0))throw new Error(`Curve not supported: ${t}`);e=await Ke()}return e}var Fi=function t(e,i){if(!e){var n=new xi(i);throw Error.captureStackTrace&&Error.captureStackTrace(n,t),n}};class xi extends Error{}function Bi(t){return t.length}xi.prototype.name="AssertionError";var Ei={byteLength:Bi,toString:function(t){const e=t.byteLength;let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i},write:function(t,e,i=0,n=Bi(e)){const a=Math.min(n,t.byteLength-i);for(let n=0;n<a;n++)t[i+n]=e.charCodeAt(n);return a}};const Si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oi=new Uint8Array(256);for(let t=0;t<Si.length;t++)Oi[Si.charCodeAt(t)]=t;function qi(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}Oi[45]=62,Oi[95]=63;var Gi={byteLength:qi,toString:function(t){const e=t.byteLength;let i="";for(let n=0;n<e;n+=3)i+=Si[t[n]>>2]+Si[(3&t[n])<<4|t[n+1]>>4]+Si[(15&t[n+1])<<2|t[n+2]>>6]+Si[63&t[n+2]];return e%3==2?i=i.substring(0,i.length-1)+"=":e%3==1&&(i=i.substring(0,i.length-2)+"=="),i},write:function(t,e,i=0,n=qi(e)){const a=Math.min(n,t.byteLength-i);for(let i=0,n=0;i<a;i+=4){const a=Oi[e.charCodeAt(i)],o=Oi[e.charCodeAt(i+1)],r=Oi[e.charCodeAt(i+2)],s=Oi[e.charCodeAt(i+3)];t[n++]=a<<2|o>>4,t[n++]=(15&o)<<4|r>>2,t[n++]=(3&r)<<6|63&s}return a}};function Ui(t){return t.length>>>1}var zi={byteLength:Ui,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let i="",n=0;for(let a=e-e%4;n<a;n+=4)i+=t.getUint32(n).toString(16).padStart(8,"0");for(;n<e;n++)i+=t.getUint8(n).toString(16).padStart(2,"0");return i},write:function(t,e,i=0,n=Ui(e)){const a=Math.min(n,t.byteLength-i);for(let n=0;n<a;n++){const a=Pi(e.charCodeAt(2*n)),o=Pi(e.charCodeAt(2*n+1));if(void 0===a||void 0===o)return t.subarray(0,n);t[i+n]=a<<4|o}return a}};function Pi(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function Mi(t){let e=0;for(let i=0,n=t.length;i<n;i++){const a=t.charCodeAt(i);if(a>=55296&&a<=56319&&i+1<n){const n=t.charCodeAt(i+1);if(n>=56320&&n<=57343){e+=4,i++;continue}}e+=a<=127?1:a<=2047?2:3}return e}let Qi,Ti;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;Qi=function(e){return t.decode(e)}}else Qi=function(t){const e=t.byteLength;let i="",n=0;for(;n<e;){let a=t[n];if(a<=127){i+=String.fromCharCode(a),n++;continue}let o=0,r=0;if(a<=223?(o=1,r=31&a):a<=239?(o=2,r=15&a):a<=244&&(o=3,r=7&a),e-n-o>0){let e=0;for(;e<o;)a=t[n+e+1],r=r<<6|63&a,e+=1}else r=65533,o=e-n;i+=String.fromCodePoint(r),n+=o+1}return i};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;Ti=function(e,i,n=0,a=Mi(i)){const o=Math.min(a,e.byteLength-n);return t.encodeInto(i,e.subarray(n,n+o)),o}}else Ti=function(t,e,i=0,n=Mi(e)){const a=Math.min(n,t.byteLength-i);t=t.subarray(i,i+a);let o=0,r=0;for(;o<e.length;){const i=e.codePointAt(o);if(i<=127){t[r++]=i,o++;continue}let n=0,a=0;for(i<=2047?(n=6,a=192):i<=65535?(n=12,a=224):i<=2097151&&(n=18,a=240),t[r++]=a|i>>n,n-=6;n>=0;)t[r++]=128|i>>n&63,n-=6;o+=i>=65536?2:1}return a};var Ri={byteLength:Mi,toString:Qi,write:Ti};function ki(t){return 2*t.length}var Ni={byteLength:ki,toString:function(t){const e=t.byteLength;let i="";for(let n=0;n<e-1;n+=2)i+=String.fromCharCode(t[n]+256*t[n+1]);return i},write:function(t,e,i=0,n=ki(e)){const a=Math.min(n,t.byteLength-i);let o=a;for(let n=0;n<e.length&&!((o-=2)<0);++n){const a=e.charCodeAt(n),o=a>>8,r=a%256;t[i+2*n]=r,t[i+2*n+1]=o}return a}};function Di(t){switch(t){case"ascii":return Ei;case"base64":return Gi;case"hex":return zi;case"utf8":case"utf-8":case void 0:return Ri;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ni;default:throw new Error(`Unknown encoding: ${t}`)}}function ji(t){return t instanceof Uint8Array}function Vi(t,e,i){return"string"==typeof t?function(t,e){const i=Di(e),n=new Uint8Array(i.byteLength(t));return i.write(n,t,0,n.byteLength),n}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,i){return new Uint8Array(t,e,i)}(t,e,i)}function Ki(t,e,i,n,a){if(0===t.byteLength)return-1;if("string"==typeof i?(n=i,i=0):void 0===i?i=a?0:t.length-1:i<0&&(i+=t.byteLength),i>=t.byteLength){if(a)return-1;i=t.byteLength-1}else if(i<0){if(!a)return-1;i=0}if("string"==typeof e)e=Vi(e,n);else if("number"==typeof e)return e&=255,a?t.indexOf(e,i):t.lastIndexOf(e,i);if(0===e.byteLength)return-1;if(a){let n=-1;for(let a=i;a<t.byteLength;a++)if(t[a]===e[-1===n?0:a-n]){if(-1===n&&(n=a),a-n+1===e.byteLength)return n}else-1!==n&&(a-=a-n),n=-1}else{i+e.byteLength>t.byteLength&&(i=t.byteLength-e.byteLength);for(let n=i;n>=0;n--){let i=!0;for(let a=0;a<e.byteLength;a++)if(t[n+a]!==e[a]){i=!1;break}if(i)return n}}return-1}function $i(t,e,i,n){return Ki(t,e,i,n,!0)}function Hi(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}var Zi={isBuffer:ji,isEncoding:function(t){try{return Di(t),!0}catch{return!1}},alloc:function(t,e,i){const n=new Uint8Array(t);return void 0!==e&&e(n,e,0,n.byteLength,i),n},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return Di(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const i=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=0;for(let a=i-i%4;n<a;n+=4){const i=t.getUint32(n),a=e.getUint32(n);if(i<a)return-1;if(i>a)return 1}for(;n<i;n++){const i=t.getUint8(n),a=e.getUint8(n);if(i<a)return-1;if(i>a)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const i=new Uint8Array(e);return t.reduce(((t,e)=>(i.set(e,t),t+e.byteLength)),0),i},copy:function(t,e,i=0,n=0,a=t.byteLength){if(a>0&&a<n)return 0;if(a===n)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(i<0)throw new RangeError("targetStart is out of range");if(n<0||n>=t.byteLength)throw new RangeError("sourceStart is out of range");if(a<0)throw new RangeError("sourceEnd is out of range");i>=e.byteLength&&(i=e.byteLength),a>t.byteLength&&(a=t.byteLength),e.byteLength-i<a-n&&(a=e.length-i+n);const o=a-n;return t===e?e.copyWithin(i,n,a):e.set(t.subarray(n,a),i),o},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const i=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=0;for(let a=i-i%4;n<a;n+=4)if(t.getUint32(n)!==e.getUint32(n))return!1;for(;n<i;n++)if(t.getUint8(n)!==e.getUint8(n))return!1;return!0},fill:function(t,e,i,n,a){if("string"==typeof e?"string"==typeof i?(a=i,i=0,n=t.byteLength):"string"==typeof n&&(a=n,n=t.byteLength):"number"==typeof val?e&=255:"boolean"==typeof val&&(e=+e),i<0||t.byteLength<i||t.byteLength<n)throw new RangeError("Out of range index");if(void 0===i&&(i=0),void 0===n&&(n=t.byteLength),n<=i)return t;if(e||(e=0),"number"==typeof e)for(let a=i;a<n;++a)t[a]=e;else{const o=(e=ji(e)?e:Vi(e,a)).byteLength;for(let a=0;a<n-i;++a)t[a+i]=e[a%o]}return t},from:Vi,includes:function(t,e,i,n){return-1!==$i(t,e,i,n)},indexOf:$i,lastIndexOf:function(t,e,i,n){return Ki(t,e,i,n,!1)},swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<e;i+=2)Hi(t,i,i+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<e;i+=4)Hi(t,i,i+3),Hi(t,i+1,i+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<e;i+=8)Hi(t,i,i+7),Hi(t,i+1,i+6),Hi(t,i+2,i+5),Hi(t,i+3,i+4);return t},toBuffer:function(t){return t},toString:function(t,e,i=0,n=t.byteLength){const a=t.byteLength;return i>=a||n<=i?"":(i<0&&(i=0),n>a&&(n=a),(0!==i||n<a)&&(t=t.subarray(i,n)),Di(e).toString(t))},write:function(t,e,i,n,a){return void 0===i?a="utf8":void 0===n&&"string"==typeof i?(a=i,i=void 0):void 0===a&&"string"==typeof n&&(a=n,n=void 0),Di(a).write(t,e,i,n)}},Ji=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var i=e.length,n=new Uint8Array(3*(i-("="==e[i-1])-("="==e[i-2]))/4|0),a=0,o=0;a<i;){var r=t[e.charCodeAt(a++)],s=t[e.charCodeAt(a++)],c=t[e.charCodeAt(a++)],l=t[e.charCodeAt(a++)];n[o++]=r<<2|s>>4,n[o++]=s<<4|c>>2,n[o++]=c<<6|l}return n}})(),Yi=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(t,e){e.exports=Ji("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),Wi=Yi(),Xi=WebAssembly.compile(Wi),tn=u((function(t){var e=null,i="undefined"!=typeof WebAssembly&&(async t=>(await WebAssembly.instantiate(await Xi,t)).exports)().then((t=>{e=t})),n=64,a=[];t.exports=d;var o=t.exports.BYTES_MIN=16,r=t.exports.BYTES_MAX=64;t.exports.BYTES=32;var s=t.exports.KEYBYTES_MIN=16,c=t.exports.KEYBYTES_MAX=64;t.exports.KEYBYTES=32;var l=t.exports.SALTBYTES=16,u=t.exports.PERSONALBYTES=16;function d(t,i,f,h,g){if(!(this instanceof d))return new d(t,i,f,h,g);if(!e)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==g&&(Fi(t>=o,"digestLength must be at least "+o+", was given "+t),Fi(t<=r,"digestLength must be at most "+r+", was given "+t),null!=i&&(Fi(i instanceof Uint8Array,"key must be Uint8Array or Buffer"),Fi(i.length>=s,"key must be at least "+s+", was given "+i.length),Fi(i.length<=c,"key must be at least "+c+", was given "+i.length)),null!=f&&(Fi(f instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Fi(f.length===l,"salt must be exactly "+l+", was given "+f.length)),null!=h&&(Fi(h instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Fi(h.length===u,"personal must be exactly "+u+", was given "+h.length))),a.length||(a.push(n),n+=216),this.digestLength=t,this.finalized=!1,this.pointer=a.pop(),this._memory=new Uint8Array(e.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=i?i.length:0,this._memory[2]=1,this._memory[3]=1,f&&this._memory.set(f,32),h&&this._memory.set(h,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),e.blake2b_init(this.pointer,this.digestLength),i&&(this.update(i),this._memory.fill(0,n,n+i.length),this._memory[this.pointer+200]=128)}function f(){}d.prototype._realloc=function(t){e.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(e.memory.buffer)},d.prototype.update=function(t){return Fi(!1===this.finalized,"Hash instance finalized"),Fi(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),n+t.length>this._memory.length&&this._realloc(n+t.length),this._memory.set(t,n),e.blake2b_update(this.pointer,n,n+t.length),this},d.prototype.digest=function(t){if(Fi(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,a.push(this.pointer),e.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return Zi.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);Fi(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var i=0;i<this.digestLength;i++)t[i]=this._memory[this.pointer+128+i];return t},d.prototype.final=d.prototype.digest,d.WASM=e,d.SUPPORTED="undefined"!=typeof WebAssembly,d.ready=function(t){return t||(t=f),i?i.then((()=>t()),t):t(new Error("WebAssembly not supported"))},d.prototype.ready=d.ready,d.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},d.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)}}));function en(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function nn(t,e){const i=new DataView(t.buffer,t.byteOffset,t.byteLength);let n="";for(let t=0;t<4;t++){t>0&&(n+="\n"),n+="\t\t";for(let e=0;e<4;e++)e>0&&(n+=" "),n+=i.getUint32(16*t+4*e).toString(16).padStart(8,"0")}return e&&(n=e+"\n"+n),n}function an(t,e){if(t.byteLength!=e.byteLength)return!1;for(var i=new Int8Array(t),n=new Int8Array(e),a=0;a!=t.byteLength;a++)if(i[a]!=n[a])return!1;return!0}function on(t){const e=t.getPartialHash(),i=tn(64);return i.setPartialHash(e),i}async function rn(t,e,i,n,a){if(t.G1.isZero(e))return!1;if(t.G1.isZero(i))return!1;if(t.G2.isZero(n))return!1;if(t.G2.isZero(a))return!1;return await t.pairingEq(e,a,t.G1.neg(i),n)}async function sn(t){for(;!t;)t=await window.prompt("Enter a random text. (Entropy): ","");const e=tn(64);e.update(mt.randomBytes(64));const i=new TextEncoder;e.update(i.encode(t));const n=Buffer.from(e.digest()),a=[];for(let t=0;t<8;t++)a[t]=n.readUInt32BE(4*t);return new _t(a)}function cn(t,e){let i,n;e<32?(i=1<<e>>>0,n=1):(i=4294967296,n=1<<e-32>>>0);let a=t;for(let t=0;t<n;t++)for(let t=0;t<i;t++)a=mt.createHash("sha256").update(a).digest();const o=new DataView(a.buffer,a.byteOffset,a.byteLength),r=[];for(let t=0;t<8;t++)r[t]=o.getUint32(4*t,!1);return new _t(r)}function ln(t){return t instanceof Uint8Array?t:("0x"==t.slice(0,2)&&(t=t.slice(2)),new Uint8Array(t.match(/[\da-f]{2}/gi).map((function(t){return parseInt(t,16)}))))}function un(t){return Array.prototype.map.call(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}async function dn(t,e){await hi(t,1),await t.writeULE32(1),await gi(t);const i=await Ci(e.q);await hi(t,2);const n=i.q,a=8*(Math.floor(($e.bitLength(n)-1)/64)+1),o=i.r,r=8*(Math.floor(($e.bitLength(o)-1)/64)+1);await t.writeULE32(a),await mi(t,n,a),await t.writeULE32(r),await mi(t,o,r),await t.writeULE32(e.nVars),await t.writeULE32(e.nPublic),await t.writeULE32(e.domainSize),await fn(t,i,e.vk_alpha_1),await fn(t,i,e.vk_beta_1),await hn(t,i,e.vk_beta_2),await hn(t,i,e.vk_gamma_2),await fn(t,i,e.vk_delta_1),await hn(t,i,e.vk_delta_2),await gi(t)}async function fn(t,e,i){const n=new Uint8Array(2*e.G1.F.n8);e.G1.toRprLEM(n,0,i),await t.write(n)}async function hn(t,e,i){const n=new Uint8Array(2*e.G2.F.n8);e.G2.toRprLEM(n,0,i),await t.write(n)}async function gn(t,e,i){const n=await t.read(2*e.G1.F.n8),a=e.G1.fromRprLEM(n,0);return i?e.G1.toObject(a):a}async function pn(t,e,i){const n=await t.read(2*e.G2.F.n8),a=e.G2.fromRprLEM(n,0);return i?e.G2.toObject(a):a}async function _n(t,e,i){await pi(t,e,1);const n=await t.readULE32();if(await _i(t),1==n)return await async function(t,e,i){const n={protocol:"groth16"};await pi(t,e,2);const a=await t.readULE32();n.n8q=a,n.q=await Li(t,a);const o=await t.readULE32();n.n8r=o,n.r=await Li(t,o);let r=await Ci(n.q);return n.nVars=await t.readULE32(),n.nPublic=await t.readULE32(),n.domainSize=await t.readULE32(),n.power=en(n.domainSize),n.vk_alpha_1=await gn(t,r,i),n.vk_beta_1=await gn(t,r,i),n.vk_beta_2=await pn(t,r,i),n.vk_gamma_2=await pn(t,r,i),n.vk_delta_1=await gn(t,r,i),n.vk_delta_2=await pn(t,r,i),await _i(t),n}(t,e,i);if(2==n)return await async function(t,e,i,n){const a={protocol:"plonk"};await pi(t,e,2);const o=await t.readULE32();a.n8q=o,a.q=await Li(t,o);const r=await t.readULE32();a.n8r=r,a.r=await Li(t,r);let s=await Ci(a.q);return a.nVars=await t.readULE32(),a.nPublic=await t.readULE32(),a.domainSize=await t.readULE32(),a.power=en(a.domainSize),a.nAdditions=await t.readULE32(),a.nConstrains=await t.readULE32(),a.k1=await t.read(r),a.k2=await t.read(r),a.Qm=await gn(t,s,n),a.Ql=await gn(t,s,n),a.Qr=await gn(t,s,n),a.Qo=await gn(t,s,n),a.Qc=await gn(t,s,n),a.S1=await gn(t,s,n),a.S2=await gn(t,s,n),a.S3=await gn(t,s,n),a.X_2=await pn(t,s,n),await _i(t),a}(t,e);throw new Error("Protocol not supported: ")}async function mn(t,e,i){const n={delta:{}};n.deltaAfter=await gn(t,e,i),n.delta.g1_s=await gn(t,e,i),n.delta.g1_sx=await gn(t,e,i),n.delta.g2_spx=await pn(t,e,i),n.transcript=await t.read(64),n.type=await t.readULE32();const a=await t.readULE32(),o=t.pos;let r=0;for(;t.pos-o<a;){const e=await t.read(1);if(e[0]<=r)throw new Error("Parameters in the contribution must be sorted");if(r=e[0],1==e[0]){const e=await t.read(1),i=await t.read(e[0]);n.name=(new TextDecoder).decode(i)}else if(2==e[0]){const e=await t.read(1);n.numIterationsExp=e[0]}else{if(3!=e[0])throw new Error("Parameter not recognized");{const e=await t.read(1);n.beaconHash=await t.read(e[0])}}}if(t.pos!=o+a)throw new Error("Parametes do not match");return n}async function Ln(t,e,i){await pi(t,i,10);const n={contributions:[]};n.csHash=await t.read(64);const a=await t.readULE32();for(let i=0;i<a;i++){const i=await mn(t,e);n.contributions.push(i)}return await _i(t),n}async function wn(t,e,i){await fn(t,e,i.deltaAfter),await fn(t,e,i.delta.g1_s),await fn(t,e,i.delta.g1_sx),await hn(t,e,i.delta.g2_spx),await t.write(i.transcript),await t.writeULE32(i.type||0);const n=[];if(i.name){n.push(1);const t=new TextEncoder("utf-8").encode(i.name.substring(0,64));n.push(t.byteLength);for(let e=0;e<t.byteLength;e++)n.push(t[e])}if(1==i.type){n.push(2),n.push(i.numIterationsExp),n.push(3),n.push(i.beaconHash.byteLength);for(let t=0;t<i.beaconHash.byteLength;t++)n.push(i.beaconHash[t])}if(n.length>0){const e=new Uint8Array(n);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0)}async function bn(t,e,i){await hi(t,10),await t.write(i.csHash),await t.writeULE32(i.contributions.length);for(let n=0;n<i.contributions.length;n++)await wn(t,e,i.contributions[n]);await gi(t)}function yn(t,e,i){const n=new Uint8Array(2*e.G1.F.n8);e.G1.toRprUncompressed(n,0,i),t.update(n)}function An(t,e,i){yn(t,e,i.deltaAfter),yn(t,e,i.delta.g1_s),yn(t,e,i.delta.g1_sx),function(t,e,i){const n=new Uint8Array(2*e.G2.F.n8);e.G2.toRprUncompressed(n,0,i),t.update(n)}(t,e,i.delta.g2_spx),t.update(i.transcript)}async function In(t,e){await pi(t,e,1);const i=await t.readULE32(),n=await Li(t,i),a=await t.readULE32();return await _i(t),{n8:i,q:n,nWitness:a}}const{stringifyBigInts:Cn}=He;async function vn(t,e,i){const{fd:n,sections:a}=await di(e,"wtns",2),o=await In(n,a),{fd:r,sections:s}=await di(t,"zkey",2),c=await _n(r,s);if("groth16"!=c.protocol)throw new Error("zkey file is not groth16");if(!$e.eq(c.r,o.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(o.nWitness!=c.nVars)throw new Error(`Invalid witness length. Circuit: ${c.nVars}, witness: ${o.nWitness}`);const l=await Ci(c.q),u=l.Fr,d=l.G1,f=l.G2,h=en(c.domainSize);i&&i.debug("Reading Wtns");const g=await bi(n,a,2);i&&i.debug("Reading Coeffs");const p=await bi(r,s,4);i&&i.debug("Building ABC");const[_,m,L]=await async function(t,e,i,n,a){const o=t.Fr.n8,r=12+e.n8r,s=(n.byteLength-4)/r,c=new pe(e.domainSize*o),l=new pe(e.domainSize*o),u=new pe(e.domainSize*o),d=[c,l];for(let e=0;e<s;e++){a&&e%1e6==0&&a.debug(`QAP AB: ${e}/${s}`);const c=n.slice(4+e*r,4+e*r+r),l=new DataView(c.buffer),u=l.getUint32(0,!0),f=l.getUint32(4,!0),h=l.getUint32(8,!0),g=c.slice(12,12+o);d[u].set(t.Fr.add(d[u].slice(f*o,f*o+o),t.Fr.mul(g,i.slice(h*o,h*o+o))),f*o)}for(let i=0;i<e.domainSize;i++)a&&i%1e6==0&&a.debug(`QAP C: ${i}/${e.domainSize}`),u.set(t.Fr.mul(c.slice(i*o,i*o+o),l.slice(i*o,i*o+o)),i*o);return[c,l,u]}(l,c,g,p,i),w=h==u.s?l.Fr.shift:l.Fr.w[h+1],b=await u.ifft(_,"","",i,"IFFT_A"),y=await u.batchApplyKey(b,u.e(1),w),A=await u.fft(y,"","",i,"FFT_A"),I=await u.ifft(m,"","",i,"IFFT_B"),C=await u.batchApplyKey(I,u.e(1),w),v=await u.fft(C,"","",i,"FFT_B"),F=await u.ifft(L,"","",i,"IFFT_C"),x=await u.batchApplyKey(F,u.e(1),w),B=await u.fft(x,"","",i,"FFT_C");i&&i.debug("Join ABC");const E=await async function(t,e,i,n,a,o){const r=1<<22,s=t.Fr.n8,c=Math.floor(i.byteLength/t.Fr.n8),l=[];for(let e=0;e<c;e+=r){o&&o.debug(`JoinABC: ${e}/${c}`);const u=Math.min(c-e,r),d=[],f=i.slice(e*s,(e+u)*s),h=n.slice(e*s,(e+u)*s),g=a.slice(e*s,(e+u)*s);d.push({cmd:"ALLOCSET",var:0,buff:f}),d.push({cmd:"ALLOCSET",var:1,buff:h}),d.push({cmd:"ALLOCSET",var:2,buff:g}),d.push({cmd:"ALLOC",var:3,len:u*s}),d.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:u},{var:3}]}),d.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:u},{var:3}]}),d.push({cmd:"GET",out:0,var:3,len:u*s}),l.push(t.tm.queueAction(d))}const u=await Promise.all(l);let d;d=i instanceof pe?new pe(i.byteLength):new Uint8Array(i.byteLength);let f=0;for(let t=0;t<u.length;t++)d.set(u[t][0],f),f+=u[t][0].byteLength;return d}(l,0,A,v,B,i);let S={};i&&i.debug("Reading A Points");const O=await bi(r,s,5);S.pi_a=await l.G1.multiExpAffine(O,g,i,"multiexp A"),i&&i.debug("Reading B1 Points");const q=await bi(r,s,6);let G=await l.G1.multiExpAffine(q,g,i,"multiexp B1");i&&i.debug("Reading B2 Points");const U=await bi(r,s,7);S.pi_b=await l.G2.multiExpAffine(U,g,i,"multiexp B2"),i&&i.debug("Reading C Points");const z=await bi(r,s,8);S.pi_c=await l.G1.multiExpAffine(z,g.slice((c.nPublic+1)*l.Fr.n8),i,"multiexp C"),i&&i.debug("Reading H Points");const P=await bi(r,s,9),M=await l.G1.multiExpAffine(P,E,i,"multiexp H"),Q=l.Fr.random(),T=l.Fr.random();S.pi_a=d.add(S.pi_a,c.vk_alpha_1),S.pi_a=d.add(S.pi_a,d.timesFr(c.vk_delta_1,Q)),S.pi_b=f.add(S.pi_b,c.vk_beta_2),S.pi_b=f.add(S.pi_b,f.timesFr(c.vk_delta_2,T)),G=d.add(G,c.vk_beta_1),G=d.add(G,d.timesFr(c.vk_delta_1,T)),S.pi_c=d.add(S.pi_c,M),S.pi_c=d.add(S.pi_c,d.timesFr(S.pi_a,T)),S.pi_c=d.add(S.pi_c,d.timesFr(G,Q)),S.pi_c=d.add(S.pi_c,d.timesFr(c.vk_delta_1,u.neg(u.mul(Q,T))));let R=[];for(let t=1;t<=c.nPublic;t++){const e=g.slice(t*u.n8,t*u.n8+u.n8);R.push($e.fromRprLE(e))}return S.pi_a=d.toObject(d.toAffine(S.pi_a)),S.pi_b=f.toObject(f.toAffine(S.pi_b)),S.pi_c=d.toObject(d.toAffine(S.pi_c)),S.protocol="groth16",S.curve=l.name,await r.close(),await n.close(),S=Cn(S),R=Cn(R),{proof:S,publicSignals:R}}function Fn(t){var e=[];return function t(e,i){if(Array.isArray(i))for(let n=0;n<i.length;n++)t(e,i[n]);else e.push(i)}(e,t),e}function xn(t){const e=BigInt(2)**BigInt(64);let i=BigInt("0xCBF29CE484222325");for(var n=0;n<t.length;n++)i^=BigInt(t[n].charCodeAt()),i*=BigInt(1099511628211),i%=e;let a=i.toString(16),o=16-a.length;return a="0".repeat(o).concat(a),a}function Bn(t,e){const i=[];let n=BigInt(t);const a=BigInt(4294967296);for(;n;)i.unshift(Number(n%a)),n/=a;if(e)for(var o=e-i.length;o>0;)i.unshift(0),o--;return i}const En=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Sn(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const On=Sn;function qn(t,e){return BigInt(t)<<BigInt(e)}function Gn(t,e){return BigInt(t)>>BigInt(e)}const Un=qn,zn=Gn;var Pn=Object.freeze({__proto__:null,fromString:Sn,e:On,fromArray:function(t,e){let i=BigInt(0);e=BigInt(e);for(let n=0;n<t.length;n++)i=i*e+BigInt(t[n]);return i},bitLength:function(t){const e=t.toString(16);return 4*(e.length-1)+En[parseInt(e[0],16)]},isNegative:function(t){return BigInt(t)<BigInt(0)},isZero:function(t){return!t},shiftLeft:qn,shiftRight:Gn,shl:Un,shr:zn,isOdd:function(t){return(BigInt(t)&BigInt(1))==BigInt(1)},naf:function(t){let e=BigInt(t);const i=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));i.push(t),e-=BigInt(t)}else i.push(0);e>>=BigInt(1)}return i},bits:function(t){let e=BigInt(t);const i=[];for(;e;)e&BigInt(1)?i.push(1):i.push(0),e>>=BigInt(1);return i},toNumber:function(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)},toArray:function(t,e){const i=[];let n=BigInt(t);for(e=BigInt(e);n;)i.unshift(Number(n%e)),n/=e;return i},add:function(t,e){return BigInt(t)+BigInt(e)},sub:function(t,e){return BigInt(t)-BigInt(e)},neg:function(t){return-BigInt(t)},mul:function(t,e){return BigInt(t)*BigInt(e)},square:function(t){return BigInt(t)*BigInt(t)},pow:function(t,e){return BigInt(t)**BigInt(e)},exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:function(t,e){return BigInt(t)/BigInt(e)},mod:function(t,e){return BigInt(t)%BigInt(e)},eq:function(t,e){return BigInt(t)==BigInt(e)},neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:function(t,e){return BigInt(t)>BigInt(e)},leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:function(t,e){return BigInt(t)>=BigInt(e)},band:function(t,e){return BigInt(t)&BigInt(e)},bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)}});function Mn(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?d(t.slice(2),16):d(t,e)}const Qn=Mn;function Tn(t,e){return d(t).shiftLeft(e)}function Rn(t,e){return d(t).shiftRight(e)}const kn=Tn,Nn=Rn;var Dn=Object.freeze({__proto__:null,fromString:Mn,e:Qn,fromArray:function(t,e){return d.fromArray(t,e)},bitLength:function(t){return d(t).bitLength()},isNegative:function(t){return d(t).isNegative()},isZero:function(t){return d(t).isZero()},shiftLeft:Tn,shiftRight:Rn,shl:kn,shr:Nn,isOdd:function(t){return d(t).isOdd()},naf:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();i.push(t),e=e.minus(t)}else i.push(0);e=e.shiftRight(1)}return i},bits:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);)e.isOdd()?i.push(1):i.push(0),e=e.shiftRight(1);return i},toNumber:function(t){if(!t.lt(d("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()},toArray:function(t,e){return d(t).toArray(e)},add:function(t,e){return d(t).add(d(e))},sub:function(t,e){return d(t).minus(d(e))},neg:function(t){return d.zero.minus(d(t))},mul:function(t,e){return d(t).times(d(e))},square:function(t){return d(t).square()},pow:function(t,e){return d(t).pow(d(e))},exp:function(t,e){return d(t).pow(d(e))},abs:function(t){return d(t).abs()},div:function(t,e){return d(t).divide(d(e))},mod:function(t,e){return d(t).mod(d(e))},eq:function(t,e){return d(t).eq(d(e))},neq:function(t,e){return d(t).neq(d(e))},lt:function(t,e){return d(t).lt(d(e))},gt:function(t,e){return d(t).gt(d(e))},leq:function(t,e){return d(t).leq(d(e))},geq:function(t,e){return d(t).geq(d(e))},band:function(t,e){return d(t).and(d(e))},bor:function(t,e){return d(t).or(d(e))},bxor:function(t,e){return d(t).xor(d(e))},land:function(t,e){return!d(t).isZero()&&!d(e).isZero()},lor:function(t,e){return!d(t).isZero()||!d(e).isZero()},lnot:function(t){return d(t).isZero()}});const jn="function"==typeof BigInt;let Vn={};jn?Object.assign(Vn,Pn):Object.assign(Vn,Dn),Vn.toRprLE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new Uint32Array(t.buffer,e,n/4),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o[t]=parseInt(a.substring(a.length-8*t-8,a.length-8*t),16);for(let t=r;t<o.length;t++)o[t]=0;for(let e=4*o.length;e<n;e++)t[e]=Vn.toNumber(Vn.band(Vn.shiftRight(i,8*e),255))},Vn.toRprBE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new DataView(t.buffer,t.byteOffset+e,n),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o.setUint32(n-4*t-4,parseInt(a.substring(a.length-8*t-8,a.length-8*t),16),!1);for(let t=0;t<n/4-r;t++)o[t]=0},Vn.fromRprLE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new Uint32Array(t.buffer,e,i/4),a=new Array(i/4);return n.forEach(((t,e)=>a[a.length-e-1]=t.toString(16).padStart(8,"0"))),Vn.fromString(a.join(""),16)},Vn.fromRprBE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new DataView(t.buffer,t.byteOffset+e,i),a=new Array(i/4);for(let t=0;t<i/4;t++)a[t]=n.getUint32(4*t,!1).toString(16).padStart(8,"0");return Vn.fromString(a.join(""),16)},Vn.toString=function(t,e){return t.toString(e)},Vn.toLEBuff=function(t){const e=new Uint8Array(Math.floor((Vn.bitLength(t)-1)/8)+1);return Vn.toRprLE(e,0,t,e.byteLength),e},Vn.zero=Vn.e(0),Vn.one=Vn.e(1);let{toRprLE:Kn,toRprBE:$n,fromRprLE:Hn,fromRprBE:Zn,toString:Jn,toLEBuff:Yn,zero:Wn,one:Xn,fromString:ta,e:ea,fromArray:ia,bitLength:na,isNegative:aa,isZero:oa,shiftLeft:ra,shiftRight:sa,shl:ca,shr:la,isOdd:ua,naf:da,bits:fa,toNumber:ha,toArray:ga,add:pa,sub:_a,neg:ma,mul:La,square:wa,pow:ba,exp:ya,abs:Aa,div:Ia,mod:Ca,eq:va,neq:Fa,lt:xa,gt:Ba,leq:Ea,geq:Sa,band:Oa,bor:qa,bxor:Ga,land:Ua,lor:za,lnot:Pa}=Vn;var Ma=Object.freeze({__proto__:null,toRprLE:Kn,toRprBE:$n,fromRprLE:Hn,fromRprBE:Zn,toString:Jn,toLEBuff:Yn,zero:Wn,one:Xn,fromString:ta,e:ea,fromArray:ia,bitLength:na,isNegative:aa,isZero:oa,shiftLeft:ra,shiftRight:sa,shl:ca,shr:la,isOdd:ua,naf:da,bits:fa,toNumber:ha,toArray:ga,add:pa,sub:_a,neg:ma,mul:La,square:wa,pow:ba,exp:ya,abs:Aa,div:Ia,mod:Ca,eq:va,neq:Fa,lt:xa,gt:Ba,leq:Ea,geq:Sa,band:Oa,bor:qa,bxor:Ga,land:Ua,lor:za,lnot:Pa});function Qa(t,e,i){if(oa(i))return t.one;const n=fa(i);if(0==n.legth)return t.one;let a=e;for(let i=n.length-2;i>=0;i--)a=t.square(a),n[i]&&(a=t.mul(a,e));return a}function Ta(t){if(t.m%2==1)if(va(Ca(t.p,4),1))if(va(Ca(t.p,8),1))if(va(Ca(t.p,16),1))!function(t){t.sqrt_q=ba(t.p,t.m),t.sqrt_s=0,t.sqrt_t=_a(t.sqrt_q,1);for(;!ua(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=Ia(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const i=t.random();t.sqrt_z=t.pow(i,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=Ia(_a(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let i=e.pow(t,e.sqrt_tm1d2);const n=e.pow(e.mul(e.square(i),t),2**(e.sqrt_s-1));if(e.eq(n,e.negone))return null;let a=e.sqrt_s,o=e.mul(t,i),r=e.mul(o,i),s=e.sqrt_z;for(;!e.eq(r,e.one);){let t=e.square(r),n=1;for(;!e.eq(t,e.one);)t=e.square(t),n++;i=s;for(let t=0;t<a-n-1;t++)i=e.square(i);s=e.square(i),r=e.mul(r,s),o=e.mul(o,i),a=n}return e.geq(o,e.zero)?o:e.neg(o)}}(t);else{if(!va(Ca(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!va(Ca(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else va(Ca(t.p,4),3)&&function(t){t.sqrt_q=ba(t.p,t.m),t.sqrt_e1=Ia(_a(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const i=this.pow(e,this.sqrt_e1),n=this.mul(this.square(i),e);if(this.eq(n,this.negone))return null;const a=this.mul(i,e);return t.geq(a,t.zero)?a:t.neg(a)}}(t);else{const e=Ca(ba(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=ba(t.p,t.m/2),t.sqrt_e34=Ia(_a(t.sqrt_q,3),4),t.sqrt_e12=Ia(_a(t.sqrt_q,1),2),t.frobenius=function(e,i){return e%2==1?t.conjugate(i):i},t.sqrt=function(t){const e=this,i=e.pow(t,e.sqrt_e34),n=e.mul(e.square(i),t),a=e.mul(e.frobenius(1,n),n);if(e.eq(a,e.negone))return null;const o=e.mul(i,t);let r;if(e.eq(n,e.negone))r=e.mul(o,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,n),e.sqrt_e12);r=e.mul(t,o)}return e.geq(r,e.zero)?r:e.neg(r)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function Ra(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let i=0;i<t;i++)e[i]=4294967296*Math.random()>>>0;return e}class ka{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=na(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let i=this.pow(this.nqr,e);for(;!this.eq(i,this.negone);)this.nqr=this.nqr+this.one,i=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),Ta(this)}e(t,e){let i;if(e?16==e&&(i=BigInt("0x"+t)):i=BigInt(t),i<0){let t=-i;return t>=this.p&&(t%=this.p),this.p-t}return i>=this.p?i%this.p:i}add(t,e){const i=t+e;return i>=this.p?i-this.p:i}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,i=this.p,n=this.one,a=t%this.p;for(;a;){let t=i/a;[e,n]=[n,e-t*n],[i,a]=[a,i-t*a]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return Qa(this,t,e)}exp(t,e){return Qa(this,t,e)}band(t,e){const i=t&e&this.mask;return i>=this.p?i-this.p:i}bor(t,e){const i=(t|e)&this.mask;return i>=this.p?i-this.p:i}bxor(t,e){const i=(t^e)&this.mask;return i>=this.p?i-this.p:i}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const i=t<<e&this.mask;return i>=this.p?i-this.p:i}{const i=this.p-e;return Number(i)<this.bitLength?t>>i:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const i=this.p-e;if(Number(i)<this.bitLength){const e=t<<i&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,i=this.nqr_to_t,n=this.pow(t,this.t),a=this.pow(t,this.add(this.t,this.one)>>this.one);for(;n!=this.one;){let t=this.square(n),o=1;for(;t!=this.one;)o++,t=this.square(t);let r=i;for(let t=0;t<e-o-1;t++)r=this.square(r);e=o,i=this.square(r),n=this.mul(n,i),a=this.mul(a,r)}return a>this.p>>this.one&&(a=this.neg(a)),a}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let i=0;i<t;i++)e=(e<<BigInt(8))+BigInt(Ra(1)[0]);return e%this.p}toString(t,e){let i;if(t>this.half){i="-"+(this.p-t).toString(e)}else i=t.toString(e);return i}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let i=0;i<this.n64;i++)e+=t.nextU64()<<BigInt(64*i);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}}class Na{constructor(t){this.type="F1",this.one=d.one,this.zero=d.zero,this.p=d(t),this.m=1,this.negone=this.p.minus(d.one),this.two=d(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=d.one.shiftLeft(this.bitLength).minus(d.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=d.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);const e=this.negone.shiftRight(this.one);this.nqr=this.two;let i=this.pow(this.nqr,e);for(;!i.equals(this.negone);)this.nqr=this.nqr.add(this.one),i=this.pow(this.nqr,e);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),Ta(this)}e(t,e){const i=d(t,e);return this.normalize(i)}add(t,e){let i=t.add(e);return i.geq(this.p)&&(i=i.minus(this.p)),i}sub(t,e){return t.geq(e)?t.minus(e):this.p.minus(e.minus(t))}neg(t){return t.isZero()?t:this.p.minus(t)}mul(t,e){return t.times(e).mod(this.p)}mulScalar(t,e){return t.times(d(e)).mod(this.p)}square(t){return t.square().mod(this.p)}eq(t,e){return t.eq(e)}neq(t,e){return t.neq(e)}lt(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.lt(n)}gt(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.gt(n)}leq(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.leq(n)}geq(t,e){const i=t.gt(this.half)?t.minus(this.p):t,n=e.gt(this.half)?e.minus(this.p):e;return i.geq(n)}div(t,e){if(e.isZero())throw new Error("Division by zero");return t.times(e.modInv(this.p)).mod(this.p)}idiv(t,e){if(e.isZero())throw new Error("Division by zero");return t.divide(e)}inv(t){if(t.isZero())throw new Error("Division by zero");return t.modInv(this.p)}mod(t,e){return t.mod(e)}pow(t,e){return t.modPow(e,this.p)}exp(t,e){return t.modPow(e,this.p)}band(t,e){return t.and(e).and(this.mask).mod(this.p)}bor(t,e){return t.or(e).and(this.mask).mod(this.p)}bxor(t,e){return t.xor(e).and(this.mask).mod(this.p)}bnot(t){return t.xor(this.mask).mod(this.p)}shl(t,e){if(e.lt(this.bitLength))return t.shiftLeft(e).and(this.mask).mod(this.p);{const i=this.p.minus(e);return i.lt(this.bitLength)?this.shr(t,i):d.zero}}shr(t,e){if(e.lt(this.bitLength))return t.shiftRight(e);{const i=this.p.minus(e);return i.lt(this.bitLength)?this.shl(t,i):d.zero}}land(t,e){return t.isZero()||e.isZero()?d.zero:d.one}lor(t,e){return t.isZero()&&e.isZero()?d.zero:d.one}lnot(t){return t.isZero()?d.one:d.zero}sqrt_old(t){if(t.equals(this.zero))return this.zero;if(!this.pow(t,this.negone.shiftRight(this.one)).equals(this.one))return null;let e=parseInt(this.s),i=this.nqr_to_t,n=this.pow(t,this.t),a=this.pow(t,this.add(this.t,this.one).shiftRight(this.one));for(;!n.equals(this.one);){let t=this.square(n),o=1;for(;!t.equals(this.one);)o++,t=this.square(t);let r=i;for(let t=0;t<e-o-1;t++)r=this.square(r);e=o,i=this.square(r),n=this.mul(n,i),a=this.mul(a,r)}return a.greater(this.p.shiftRight(this.one))&&(a=this.neg(a)),a}normalize(t){return(t=d(t)).isNegative()?this.p.minus(t.abs().mod(this.p)):t.mod(this.p)}random(){let t=d(0),e=d(this.p.square());for(;!e.isZero();)t=t.shiftLeft(8).add(d(Ra(1)[0])),e=e.shiftRight(8);return t.mod(this.p)}toString(t,e){let i;if(t.lesserOrEquals(this.p.shiftRight(d(1))))i=t.toString(e);else{i="-"+this.p.minus(t).toString(e)}return i}isZero(t){return t.isZero()}fromRng(t){let e;do{e=d(0);for(let i=0;i<this.n64;i++)e=e.add(e,t.nextU64().shiftLeft(64*i));e=e.and(this.mask)}while(e.geq(this.p));return e=e.times(this.Ri).mod(this.q),e}}const Da="function"==typeof BigInt;let ja;ja=Da?ka:Na;class Va extends ja{toRprLE(t,e,i){Kn(t,e,i,8*this.n64)}toRprBE(t,e,i){$n(t,e,i,8*this.n64)}toRprBEM(t,e,i){return this.toRprBE(t,e,this.mul(this.R,i))}toRprLEM(t,e,i){return this.toRprLE(t,e,this.mul(this.R,i))}fromRprLE(t,e){return Hn(t,e,this.n8)}fromRprBE(t,e){return Zn(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}}var Ka=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return Hn(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=BigInt(0),i=t.length,n=0;const a=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i>0;)i>=4?(i-=4,e+=BigInt(a.getUint32(i))<<BigInt(8*n),n+=4):i>=2?(i-=2,e+=BigInt(a.getUint16(i))<<BigInt(8*n),n+=2):(i-=1,e+=BigInt(a.getUint8(i))<<BigInt(8*n),n+=1);return e},beInt2Buff:function(t,e){let i=t;const n=new Uint8Array(e),a=new DataView(n.buffer);let o=e;for(;o>0;)o-4>=0?(o-=4,a.setUint32(o,Number(i&BigInt(4294967295))),i>>=BigInt(32)):o-2>=0?(o-=2,a.setUint16(o,Number(i&BigInt(65535))),i>>=BigInt(16)):(o-=1,a.setUint8(o,Number(i&BigInt(255))),i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},leBuff2int:function(t){let e=BigInt(0),i=0;const n=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i<t.length;)i+4<=t.length?(e+=BigInt(n.getUint32(i,!0))<<BigInt(8*i),i+=4):i+4<=t.length?(e+=BigInt(n.getUint16(i,!0))<<BigInt(8*i),i+=2):(e+=BigInt(n.getUint8(i,!0))<<BigInt(8*i),i+=1);return e},leInt2Buff:function(t,e){let i=t;void 0===e&&0==(e=Math.floor((na(t)-1)/8)+1)&&(e=1);const n=new Uint8Array(e),a=new DataView(n.buffer);let o=0;for(;o<e;)o+4<=e?(a.setUint32(o,Number(i&BigInt(4294967295)),!0),o+=4,i>>=BigInt(32)):o+2<=e?(a.setUint16(Number(o,i&BigInt(65535)),!0),o+=2,i>>=BigInt(16)):(a.setUint8(Number(o,i&BigInt(255)),!0),o+=1,i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},stringifyFElements:function t(e,i){if("bigint"==typeof i||void 0!==i.eq)return i.toString(10);if(i instanceof Uint8Array)return e.toString(e.e(i));if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i},unstringifyFElements:function t(e,i){if("string"==typeof i&&/^[0-9]+$/.test(i))return e.e(i);if("string"==typeof i&&/^0x[0-9a-fA-F]+$/.test(i))return e.e(i);if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){if(null===i)return null;const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i}});var $a=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return d(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return d(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[t.length-i-1]);e=e.add(n.shiftLeft(8*i))}return e},beInt2Buff:function(t,e){let i=t,n=e-1;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n>=0;){let t=Number(i.and(d("255")));a[n]=t,n--,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a},leBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[i]);e=e.add(n.shiftLeft(8*i))}return e},leInt2Buff:function(t,e){let i=t,n=0;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n<a.length;){let t=Number(i.and(d(255)));a[n]=t,n++,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a}});let Ha={};"function"==typeof BigInt?Object.assign(Ha,Ka):Object.assign(Ha,$a);const Za=[];for(let t=0;t<256;t++)Za[t]=Ja(t,8);function Ja(t,e){let i=0,n=t;for(let t=0;t<e;t++)i<<=1,i|=1&n,n>>=1;return i}Ha.bitReverse=function(t,e){return(Za[t>>>24]|Za[t>>>16&255]<<8|Za[t>>>8&255]<<16|Za[255&t]<<24)>>>32-e},Ha.log2=function(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)},Ha.buffReverseBits=function(t,e){const i=t.byteLength/e,n=Ha.log2(i);if(i!=1<<n)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const i=Ha.bitReverse(a,n);if(a>i){const n=t.slice(a*e,(a+1)*e);t.set(t.slice(i*e,(i+1)*e),a*e),t.set(n,i*e)}}},Ha.array2buffer=function(t,e){const i=new Uint8Array(e*t.length);for(let n=0;n<t.length;n++)i.set(t[n],n*e);return i},Ha.buffer2array=function(t,e){const i=t.byteLength/e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t.slice(a*e,a*e+e);return n},function(t){globalThis.btoa(t)}("("+function(t){const e=32767;let i,n;async function a(t){const a=new Uint8Array(t.code),o=await WebAssembly.compile(a);n=new WebAssembly.Memory({initial:t.init,maximum:e}),i=await WebAssembly.instantiate(o,{env:{memory:n}})}function o(t){const i=new Uint32Array(n.buffer,0,1);for(;3&i[0];)i[0]++;const a=i[0];if(i[0]+=t,i[0]+t>n.buffer.byteLength){const a=n.buffer.byteLength/65536;let o=Math.floor((i[0]+t)/65536)+1;o>e&&(o=e),n.grow(o-a)}return a}function r(t){const e=o(t.byteLength);return c(e,t),e}function s(t,e){const i=new Uint8Array(n.buffer);return new Uint8Array(i.buffer,i.byteOffset+t,e)}function c(t,e){new Uint8Array(n.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return a(t[0]);const e={vars:[],out:[]},l=new Uint32Array(n.buffer,0,1)[0];for(let n=0;n<t.length;n++)switch(t[n].cmd){case"ALLOCSET":e.vars[t[n].var]=r(t[n].buff);break;case"ALLOC":e.vars[t[n].var]=o(t[n].len);break;case"SET":c(e.vars[t[n].var],t[n].buff);break;case"CALL":{const a=[];for(let i=0;i<t[n].params.length;i++){const o=t[n].params[i];void 0!==o.var?a.push(e.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}i.exports[t[n].fnName](...a);break}case"GET":e.out[t[n].out]=s(e.vars[t[n].var],t[n].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(n.buffer,0,1)[0]=l,e.out}return t&&(t.onmessage=function(e){let i;if(i=e.data?e.data:e,"INIT"==i[0].cmd)a(i[0]).then((function(){t.postMessage(i.result)}));else if("TERMINATE"==i[0].cmd)t.close();else{const e=l(i);t.postMessage(e)}}),l}.toString()+")(self)"),globalThis.curve_bn128=null,globalThis.curve_bls12381=null,ea("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ea("21888242871839275222246405745257275088548364400416034343698204186575808495617"),ea("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ea("21888242871839275222246405745257275088696311157297823662689037894645226208583");const Ya=Ma;async function Wa(t,e){e=e||{};let i,n=32767,a=!1;for(;!a;)try{i=new WebAssembly.Memory({initial:n}),a=!0}catch(t){if(1===n)throw t;console.warn("Could not allocate "+1024*n*64+" bytes. This may cause severe instability. Trying with "+1024*n*64/2+" bytes"),n=Math.floor(n/2)}const o=await WebAssembly.compile(t);let r;const s=await WebAssembly.instantiate(o,{env:{memory:i},runtime:{exceptionHandler:function(t){let e;throw e=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":"Unknown error.",console.log("ERROR: ",t,e),new Error(e)},showSharedRWMemory:function(){const t=s.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let i=0;i<t;i++)e[t-1-i]=s.exports.readSharedRWMemory(i);console.log(Ya.fromArray(e,4294967296))},error:function(t,i,n,a,o,s){let c;throw c=7==t?l(i)+" "+r.getFr(a).toString()+" != "+r.getFr(o).toString()+" "+l(s):9==t?l(i)+" "+r.getFr(a).toString()+" "+l(o):5==t&&e.sym?l(i)+" "+e.sym.labelIdx2Name[o]:l(i)+" "+n+" "+a+" "+o+" "+s,console.log("ERROR: ",t,c),new Error(c)},log:function(t){console.log(r.getFr(t).toString())},logGetSignal:function(t,i){e.logGetSignal&&e.logGetSignal(t,r.getFr(i))},logSetSignal:function(t,i){e.logSetSignal&&e.logSetSignal(t,r.getFr(i))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}}),c=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);return r="function"==typeof s.exports.getVersion?new to(s,c):new Xa(i,s,c),r;function l(t){const e=new Uint8Array(i.buffer),n=[];for(let i=0;e[t+i]>0;i++)n.push(e[t+i]);return String.fromCharCode.apply(null,n)}}class Xa{constructor(t,e,i){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;const n=this.instance.exports.getPRawPrime(),a=new Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.i32[(n>>2)+t];this.prime=Ya.fromArray(a,4294967296),this.Fr=new Va(this.prime),this.mask32=Ya.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(Ya.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=i}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const i=this.allocInt(),n=this.allocFr();Object.keys(t).forEach((e=>{const a=xn(e),o=parseInt(a.slice(0,8),16),r=parseInt(a.slice(8,16),16);try{this.instance.exports.getSignalOffset32(i,0,o,r)}catch(t){throw new Error(`Signal ${e} is not an input of the circuit.`)}const s=this.getInt(i),c=Fn(t[e]);for(let t=0;t<c.length;t++)this.setFr(n,c[t]),this.instance.exports.setSignal(0,0,s+t,n)}))}async calculateWitness(t,e){const i=this,n=i.i32[0],a=[];await i._doCalculateWitness(t,e);for(let t=0;t<i.NVars;t++){const e=i.instance.exports.getPWitness(t);a.push(i.getFr(e))}return i.i32[0]=n,a}async calculateBinWitness(t,e){const i=this,n=i.i32[0];await i._doCalculateWitness(t,e);const a=i.instance.exports.getWitnessBuffer();i.i32[0]=n;const o=i.memory.buffer.slice(a,a+i.NVars*i.n64*8);return new Uint8Array(o)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){const e=this,i=t>>2;if(2147483648&e.i32[i+1]){const t=new Array(e.n32);for(let n=0;n<e.n32;n++)t[e.n32-1-n]=e.i32[i+2+n];const a=e.Fr.e(Ya.fromArray(t,4294967296));return 1073741824&e.i32[i+1]?(n=a,e.Fr.mul(e.RInv,n)):a}return 2147483648&e.i32[i]?e.Fr.e(e.i32[i]-4294967296):e.Fr.e(e.i32[i]);var n}setFr(t,e){const i=this;e=i.Fr.e(e);const n=i.Fr.neg(i.Fr.e("80000000",16)),a=i.Fr.e("7FFFFFFF",16);if(i.Fr.geq(e,n)&&i.Fr.leq(e,a)){let a;return i.Fr.geq(e,i.Fr.zero)?a=Ya.toNumber(e):(a=Ya.toNumber(i.Fr.sub(e,n)),a-=2147483648,a=4294967296+a),i.i32[t>>2]=a,void(i.i32[1+(t>>2)]=0)}i.i32[t>>2]=0,i.i32[1+(t>>2)]=2147483648;const o=Ya.toArray(e,4294967296);for(let e=0;e<i.n32;e++){const n=o.length-1-e;i.i32[2+(t>>2)+e]=n>=0?o[n]:0}}}class to{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const i=new Array(this.n32);for(let t=0;t<this.n32;t++)i[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=Ya.fromArray(i,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const i=Object.keys(t);var n=0;if(i.forEach((e=>{const i=xn(e),a=parseInt(i.slice(0,8),16),o=parseInt(i.slice(8,16),16),r=Fn(t[e]);for(let t=0;t<r.length;t++){const e=Bn(r[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(a,o,t),n++}catch(t){throw new Error(t)}}})),n<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${n} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){const i=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const e=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);i.push(fromArray32(e))}return i}async calculateWTNSBin(t,e){const i=new Uint32Array(this.witnessSize*this.n32+this.n32+11),n=new Uint8Array(i.buffer);await this._doCalculateWitness(t,e),n[0]="w".charCodeAt(0),n[1]="t".charCodeAt(0),n[2]="n".charCodeAt(0),n[3]="s".charCodeAt(0),i[1]=2,i[2]=2,i[3]=1;const a=4*this.n32,o=(8+a).toString(16);i[4]=parseInt(o.slice(0,8),16),i[5]=parseInt(o.slice(8,16),16),i[6]=a,this.instance.exports.getRawPrime();var r=7;for(let t=0;t<this.n32;t++)i[r+t]=this.instance.exports.readSharedRWMemory(t);i[r+=this.n32]=this.witnessSize,i[++r]=2,r++;const s=(a*this.witnessSize).toString(16);i[r]=parseInt(s.slice(0,8),16),i[r+1]=parseInt(s.slice(8,16),16),r+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)i[r+t]=this.instance.exports.readSharedRWMemory(t);r+=this.n32}return n}}const{unstringifyBigInts:eo}=He;async function io(t,e,i,n){const a=eo(t),o=await ui(e),r=await o.read(o.totalSize);await o.close();const s=await Wa(r);if(1==s.circom_version()){const t=await s.calculateBinWitness(a),e=await fi(i,"wtns",2,2);await async function(t,e,i){await hi(t,1);const n=8*(Math.floor(($e.bitLength(i)-1)/64)+1);if(await t.writeULE32(n),await mi(t,i,n),e.byteLength%n!=0)throw new Error("Invalid witness length");await t.writeULE32(e.byteLength/n),await gi(t),await hi(t,2),await t.write(e),await gi(t)}(e,t,s.prime),await e.close()}else{const t=await li(i),e=await s.calculateWTNSBin(a);await t.write(e),await t.close()}}const{unstringifyBigInts:no}=He;const{unstringifyBigInts:ao}=He;const{unstringifyBigInts:oo}=He;function ro(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var so=Object.freeze({__proto__:null,fullProve:async function(t,e,i,n){const a=no(t),o={type:"mem"};return await io(a,e,o),await vn(i,o,n)},prove:vn,verify:async function(t,e,i,n){const a=ao(t),o=ao(i),r=ao(e),s=await vi(a.curve),c=s.G1.fromObject(a.IC[0]),l=new Uint8Array(2*s.G1.F.n8*r.length),u=new Uint8Array(s.Fr.n8*r.length);for(let t=0;t<r.length;t++){const e=s.G1.fromObject(a.IC[t+1]);l.set(e,t*s.G1.F.n8*2),$e.toRprLE(u,s.Fr.n8*t,r[t],s.Fr.n8)}let d=await s.G1.multiExpAffine(l,u);d=s.G1.add(d,c);const f=s.G1.fromObject(o.pi_a),h=s.G2.fromObject(o.pi_b),g=s.G1.fromObject(o.pi_c),p=s.G2.fromObject(a.vk_gamma_2),_=s.G2.fromObject(a.vk_delta_2),m=s.G1.fromObject(a.vk_alpha_1),L=s.G2.fromObject(a.vk_beta_2);return await s.pairingEq(s.G1.neg(f),h,d,p,g,_,m,L)?(n&&n.info("OK!"),!0):(n&&n.error("Invalid proof"),!1)},exportSolidityCallData:async function(t,e){const i=oo(t),n=oo(e);let a,o="";for(let t=0;t<n.length;t++)""!=o&&(o+=","),o+=ro(n[t]);return a=`[${ro(i.pi_a[0])}, ${ro(i.pi_a[1])}],[[${ro(i.pi_b[0][1])}, ${ro(i.pi_b[0][0])}],[${ro(i.pi_b[1][1])}, ${ro(i.pi_b[1][0])}]],[${ro(i.pi_c[0])}, ${ro(i.pi_c[1])}],[${o}]`,a}});function co(t,e){const i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=[];for(let t=0;t<8;t++)n[t]=i.getUint32(4*t);const a=new _t(n);return t.G2.fromRng(a)}function lo(t,e,i,n,a){const o=tn(64),r=new Uint8Array([e]);o.update(r),o.update(i);const s=t.G1.toUncompressed(n);o.update(s);const c=t.G1.toUncompressed(a);o.update(c);return co(t,o.digest())}function uo(t,e,i,n,a){return t.g1_s=e.G1.toAffine(e.G1.fromRng(a)),t.g1_sx=e.G1.toAffine(e.G1.timesFr(t.g1_s,t.prvKey)),t.g2_sp=e.G2.toAffine(lo(e,i,n,t.g1_s,t.g1_sx)),t.g2_spx=e.G2.toAffine(e.G2.timesFr(t.g2_sp,t.prvKey)),t}function fo(t,e,i){const n={tau:{},alpha:{},beta:{}};return n.tau.prvKey=t.Fr.fromRng(i),n.alpha.prvKey=t.Fr.fromRng(i),n.beta.prvKey=t.Fr.fromRng(i),uo(n.tau,t,0,e,i),uo(n.alpha,t,1,e,i),uo(n.beta,t,2,e,i),n}async function ho(t,e,i,n){n||(n=i),await t.writeULE32(1);const a=t.pos;await t.writeULE64(0),await t.writeULE32(8*e.F1.n64);const o=new Uint8Array(e.F1.n8);$e.toRprLE(o,0,e.q,e.F1.n8),await t.write(o),await t.writeULE32(i),await t.writeULE32(n);const r=t.pos-a-8,s=t.pos;await t.writeULE64(r,a),t.pos=s}async function go(t,e){if(!e[1])throw new Error(t.fileName+": File has no  header");if(e[1].length>1)throw new Error(t.fileName+": File has more than one header");t.pos=e[1][0].p;const i=await t.readULE32(),n=await t.read(i),a=$e.fromRprLE(n),o=await Ci(a);if(8*o.F1.n64!=i)throw new Error(t.fileName+": Invalid size");const r=await t.readULE32(),s=await t.readULE32();if(t.pos-e[1][0].p!=e[1][0].size)throw new Error("Invalid PTau header size");return{curve:o,power:r,ceremonyPower:s}}function po(t,e,i,n){const a={tau:{},alpha:{},beta:{}};return a.tau.g1_s=o(),a.tau.g1_sx=o(),a.alpha.g1_s=o(),a.alpha.g1_sx=o(),a.beta.g1_s=o(),a.beta.g1_sx=o(),a.tau.g2_spx=r(),a.alpha.g2_spx=r(),a.beta.g2_spx=r(),a;function o(){let a;return a=n?i.G1.fromRprLEM(t,e):i.G1.fromRprUncompressed(t,e),e+=2*i.G1.F.n8,a}function r(){let a;return a=n?i.G2.fromRprLEM(t,e):i.G2.fromRprUncompressed(t,e),e+=2*i.G2.F.n8,a}}function _o(t,e,i,n,a){async function o(n){a?i.G1.toRprLEM(t,e,n):i.G1.toRprUncompressed(t,e,n),e+=2*i.F1.n8}async function r(n){a?i.G2.toRprLEM(t,e,n):i.G2.toRprUncompressed(t,e,n),e+=2*i.F2.n8}return o(n.tau.g1_s),o(n.tau.g1_sx),o(n.alpha.g1_s),o(n.alpha.g1_sx),o(n.beta.g1_s),o(n.beta.g1_sx),r(n.tau.g2_spx),r(n.alpha.g2_spx),r(n.beta.g2_spx),t}async function mo(t,e){const i={};i.tauG1=await c(),i.tauG2=await l(),i.alphaG1=await c(),i.betaG1=await c(),i.betaG2=await l(),i.key=await async function(t,e,i){return po(await t.read(2*e.F1.n8*6+2*e.F2.n8*3),0,e,i)}(t,e,!0),i.partialHash=await t.read(216),i.nextChallenge=await t.read(64),i.type=await t.readULE32();const n=new Uint8Array(2*e.G1.F.n8*6+2*e.G2.F.n8*3);_o(n,0,e,i.key,!1);const a=tn(64);a.setPartialHash(i.partialHash),a.update(n),i.responseHash=a.digest();const o=await t.readULE32(),r=t.pos;let s=0;for(;t.pos-r<o;){const t=await u(1);if(t[0]<=s)throw new Error("Parameters in the contribution must be sorted");if(s=t[0],1==t[0]){const t=await u(1),e=await u(t[0]);i.name=(new TextDecoder).decode(e)}else if(2==t[0]){const t=await u(1);i.numIterationsExp=t[0]}else{if(3!=t[0])throw new Error("Parameter not recognized");{const t=await u(1);i.beaconHash=await u(t[0])}}}if(t.pos!=r+o)throw new Error("Parametes do not match");return i;async function c(){const i=await t.read(2*e.G1.F.n8);return e.G1.fromRprLEM(i)}async function l(){const i=await t.read(2*e.G2.F.n8);return e.G2.fromRprLEM(i)}async function u(e){const i=await t.read(e);return new Uint8Array(i)}}async function Lo(t,e,i){if(!i[7])throw new Error(t.fileName+": File has no  contributions");if(i[7][0].length>1)throw new Error(t.fileName+": File has more than one contributions section");t.pos=i[7][0].p;const n=await t.readULE32(),a=[];for(let i=0;i<n;i++){const n=await mo(t,e);n.id=i+1,a.push(n)}if(t.pos-i[7][0].p!=i[7][0].size)throw new Error("Invalid contribution section size");return a}async function wo(t,e,i){const n=new Uint8Array(2*e.F1.n8),a=new Uint8Array(2*e.F2.n8);await r(i.tauG1),await s(i.tauG2),await r(i.alphaG1),await r(i.betaG1),await s(i.betaG2),await async function(t,e,i,n){const a=new Uint8Array(2*e.F1.n8*6+2*e.F2.n8*3);_o(a,0,e,i,n),await t.write(a)}(t,e,i.key,!0),await t.write(i.partialHash),await t.write(i.nextChallenge),await t.writeULE32(i.type||0);const o=[];if(i.name){o.push(1);const t=new TextEncoder("utf-8").encode(i.name.substring(0,64));o.push(t.byteLength);for(let e=0;e<t.byteLength;e++)o.push(t[e])}if(1==i.type){o.push(2),o.push(i.numIterationsExp),o.push(3),o.push(i.beaconHash.byteLength);for(let t=0;t<i.beaconHash.byteLength;t++)o.push(i.beaconHash[t])}if(o.length>0){const e=new Uint8Array(o);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0);async function r(i){e.G1.toRprLEM(n,0,i),await t.write(n)}async function s(i){e.G2.toRprLEM(a,0,i),await t.write(a)}}async function bo(t,e,i){await t.writeULE32(7);const n=t.pos;await t.writeULE64(0),await t.writeULE32(i.length);for(let n=0;n<i.length;n++)await wo(t,e,i[n]);const a=t.pos-n-8,o=t.pos;await t.writeULE64(a,n),t.pos=o}function yo(t,e,i){i&&i.debug("Calculating First Challenge Hash");const n=new tn(64),a=new Uint8Array(2*t.G1.F.n8),o=new Uint8Array(2*t.G2.F.n8);let r;return t.G1.toRprUncompressed(a,0,t.G1.g),t.G2.toRprUncompressed(o,0,t.G2.g),n.update(tn(64).digest()),r=2**e*2-1,i&&i.debug("Calculate Initial Hash: tauG1"),s(a,r),r=2**e,i&&i.debug("Calculate Initial Hash: tauG2"),s(o,r),i&&i.debug("Calculate Initial Hash: alphaTauG1"),s(a,r),i&&i.debug("Calculate Initial Hash: betaTauG1"),s(a,r),n.update(o),n.digest();function s(t,e){const a=5e5,o=Math.floor(e/a),r=e%a,s=new Uint8Array(a*t.byteLength);for(let e=0;e<a;e++)s.set(t,e*t.byteLength);for(let t=0;t<o;t++)n.update(s),i&&i.debug("Initial hash: "+t*a);for(let e=0;e<r;e++)n.update(t)}}function Ao(t,e,i,n){return fo(t,e,cn(i,n))}const Io=rn;async function Co(t,e,i,n){let a;if(1==e.type){const a=Ao(t,i.nextChallenge,e.beaconHash,e.numIterationsExp);if(!t.G1.eq(e.key.tau.g1_s,a.tau.g1_s))return n&&n.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.tau.g1_sx,a.tau.g1_sx))return n&&n.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.tau.g2_spx,a.tau.g2_spx))return n&&n.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_s,a.alpha.g1_s))return n&&n.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_sx,a.alpha.g1_sx))return n&&n.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.alpha.g2_spx,a.alpha.g2_spx))return n&&n.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_s,a.beta.g1_s))return n&&n.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_sx,a.beta.g1_sx))return n&&n.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.beta.g2_spx,a.beta.g2_spx))return n&&n.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1}return e.key.tau.g2_sp=t.G2.toAffine(lo(t,0,i.nextChallenge,e.key.tau.g1_s,e.key.tau.g1_sx)),e.key.alpha.g2_sp=t.G2.toAffine(lo(t,1,i.nextChallenge,e.key.alpha.g1_s,e.key.alpha.g1_sx)),e.key.beta.g2_sp=t.G2.toAffine(lo(t,2,i.nextChallenge,e.key.beta.g1_s,e.key.beta.g1_sx)),a=await Io(t,e.key.tau.g1_s,e.key.tau.g1_sx,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==a?(n&&n.error("INVALID key (tau) in challenge #"+e.id),!1):(a=await Io(t,e.key.alpha.g1_s,e.key.alpha.g1_sx,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==a?(n&&n.error("INVALID key (alpha) in challenge #"+e.id),!1):(a=await Io(t,e.key.beta.g1_s,e.key.beta.g1_sx,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==a?(n&&n.error("INVALID key (beta) in challenge #"+e.id),!1):(a=await Io(t,i.tauG1,e.tauG1,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==a?(n&&n.error("INVALID tau*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Io(t,e.key.tau.g1_s,e.key.tau.g1_sx,i.tauG2,e.tauG2),!0!==a?(n&&n.error("INVALID tau*G2. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Io(t,i.alphaG1,e.alphaG1,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==a?(n&&n.error("INVALID alpha*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Io(t,i.betaG1,e.betaG1,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==a?(n&&n.error("INVALID beta*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Io(t,e.key.beta.g1_s,e.key.beta.g1_sx,i.betaG2,e.betaG2),!0!==a?(n&&n.error("INVALID beta*G2. challenge #"+e.id+"It does not follow the previous contribution"),!1):(n&&n.info("Powers Of tau file OK!"),!0))))))))}async function vo(t,e,i,n,a,o,r,s,c,l){const u=a[o],d=2*u.F.n8,f=e[n][0].size/d;await pi(t,e,n),await hi(i,n);let h=r;for(let e=0;e<f;e+=65536){l&&l.debug(`Applying key: ${c}: ${e}/${f}`);const n=Math.min(f-e,65536);let o;o=await t.read(n*d),o=await u.batchApplyKey(o,h,s),await i.write(o),h=a.Fr.mul(h,a.Fr.exp(s,n))}await gi(i),await _i(t)}async function Fo(t,e,i,n,a,o,r,s,c,l,u){const d=n[a],f=2*d.F.n8,h=Math.floor((1<<20)/f);let g=r;for(let a=0;a<o;a+=h){u&&u.debug(`Applying key ${l}: ${a}/${o}`);const r=Math.min(o-a,h),p=await t.read(r*f),_=await d.batchUtoLEM(p),m=await d.batchApplyKey(_,g,s);let L;L="COMPRESSED"==c?await d.batchLEMtoC(m):await d.batchLEMtoU(m),i&&i.update(L),await e.write(L),g=n.Fr.mul(g,n.Fr.exp(s,r))}}var xo=Object.freeze({__proto__:null,newAccumulator:async function(t,e,i,n){await tn.ready();const a=await fi(i,"ptau",1,7);await ho(a,t,e,0);const o=t.G1.oneAffine,r=t.G2.oneAffine;await hi(a,2);const s=2**e*2-1;for(let t=0;t<s;t++)await a.write(o),n&&t%1e5==0&&t&&n.log("tauG1: "+t);await gi(a),await hi(a,3);const c=2**e;for(let t=0;t<c;t++)await a.write(r),n&&t%1e5==0&&t&&n.log("tauG2: "+t);await gi(a),await hi(a,4);const l=2**e;for(let t=0;t<l;t++)await a.write(o),n&&t%1e5==0&&t&&n.log("alphaTauG1: "+t);await gi(a),await hi(a,5);const u=2**e;for(let t=0;t<u;t++)await a.write(o),n&&t%1e5==0&&t&&n.log("betaTauG1: "+t);await gi(a),await hi(a,6),await a.write(r),await gi(a),await hi(a,7),await a.writeULE32(0),await gi(a),await a.close();const d=yo(t,e,n);return n&&n.debug(nn(tn(64).digest(),"Blank Contribution Hash:")),n&&n.info(nn(d,"First Contribution Hash:")),d},exportChallenge:async function(t,e,i){await tn.ready();const{fd:n,sections:a}=await di(t,"ptau",1),{curve:o,power:r}=await go(n,a),s=await Lo(n,o,a);let c,l;0==s.length?(c=tn(64).digest(),l=yo(o,r)):(c=s[s.length-1].responseHash,l=s[s.length-1].nextChallenge),i&&i.info(nn(c,"Last Response Hash: ")),i&&i.info(nn(l,"New Challenge Hash: "));const u=await li(e),d=tn(64);await u.write(c),d.update(c),await h(2,"G1",2**r*2-1,"tauG1"),await h(3,"G2",2**r,"tauG2"),await h(4,"G1",2**r,"alphaTauG1"),await h(5,"G1",2**r,"betaTauG1"),await h(6,"G2",1,"betaG2"),await n.close(),await u.close();const f=d.digest();if(!an(l,f))throw i&&i.info(nn(f,"Calc Curret Challenge Hash: ")),i&&i.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return l;async function h(t,e,r,s){const c=o[e],l=2*c.F.n8,f=Math.floor((1<<24)/l);await pi(n,a,t);for(let t=0;t<r;t+=f){i&&i.debug(`Exporting ${s}: ${t}/${r}`);const e=Math.min(r-t,f);let a;a=await n.read(e*l),a=await c.batchLEMtoU(a),await u.write(a),d.update(a)}await _i(n)}},importResponse:async function(t,e,i,n,a,o){await tn.ready();const r=new Uint8Array(64);for(let t=0;t<64;t++)r[t]=255;const{fd:s,sections:c}=await di(t,"ptau",1),{curve:l,power:u}=await go(s,c),d=await Lo(s,l,c),f={};n&&(f.name=n);const h=2*l.F1.n8,g=l.F1.n8,p=2*l.F2.n8,_=l.F2.n8,m=await ui(e);if(m.totalSize!=64+(2**u*2-1)*g+2**u*_+2**u*g+2**u*g+_+6*h+3*p)throw new Error("Size of the contribution is invalid");let L;L=d.length>0?d[d.length-1].nextChallenge:yo(l,u,o);const w=await fi(i,"ptau",1,a?7:2);await ho(w,l,u);const b=await m.read(64);if(an(r,L)&&(L=b,d[d.length-1].nextChallenge=L),!an(b,L))throw new Error("Wrong contribution. this contribution is not based on the previus hash");const y=new tn(64);y.update(b);const A=[];let I;I=await F(m,w,"G1",2,2**u*2-1,[1],"tauG1"),f.tauG1=I[0],I=await F(m,w,"G2",3,2**u,[1],"tauG2"),f.tauG2=I[0],I=await F(m,w,"G1",4,2**u,[0],"alphaG1"),f.alphaG1=I[0],I=await F(m,w,"G1",5,2**u,[0],"betaG1"),f.betaG1=I[0],I=await F(m,w,"G2",6,1,[0],"betaG2"),f.betaG2=I[0],f.partialHash=y.getPartialHash();const C=await m.read(2*l.F1.n8*6+2*l.F2.n8*3);f.key=po(C,0,l,!1),y.update(new Uint8Array(C));const v=y.digest();if(o&&o.info(nn(v,"Contribution Response Hash imported: ")),a){const t=new tn(64);t.update(v),await x(t,w,"G1",2,2**u*2-1,"tauG1",o),await x(t,w,"G2",3,2**u,"tauG2",o),await x(t,w,"G1",4,2**u,"alphaTauG1",o),await x(t,w,"G1",5,2**u,"betaTauG1",o),await x(t,w,"G2",6,1,"betaG2",o),f.nextChallenge=t.digest(),o&&o.info(nn(f.nextChallenge,"Next Challenge Hash: "))}else f.nextChallenge=r;return d.push(f),await bo(w,l,d),await m.close(),await w.close(),await s.close(),f.nextChallenge;async function F(t,e,i,n,r,s,c){return a?await async function(t,e,i,n,a,r,s){const c=l[i],u=c.F.n8,d=2*c.F.n8,f=[];await hi(e,n);const h=Math.floor((1<<24)/d);A[n]=e.pos;for(let i=0;i<a;i+=h){o&&o.debug(`Importing ${s}: ${i}/${a}`);const n=Math.min(a-i,h),l=await t.read(n*u);y.update(l);const g=await c.batchCtoLEM(l);await e.write(g);for(let t=0;t<r.length;t++){const e=r[t];if(e>=i&&e<i+n){const t=c.fromRprLEM(g,(e-i)*d);f.push(t)}}}return await gi(e),f}(t,e,i,n,r,s,c):await async function(t,e,i,n,a,r,s){const c=l[i],u=c.F.n8,d=[],f=Math.floor((1<<24)/u);for(let e=0;e<a;e+=f){o&&o.debug(`Importing ${s}: ${e}/${a}`);const i=Math.min(a-e,f),n=await t.read(i*u);y.update(n);for(let t=0;t<r.length;t++){const a=r[t];if(a>=e&&a<e+i){const t=c.fromRprCompressed(n,(a-e)*u);d.push(t)}}}return d}(t,0,i,0,r,s,c)}async function x(t,e,i,n,a,o,r){const s=l[i],c=2*s.F.n8,u=Math.floor((1<<24)/c),d=e.pos;e.pos=A[n];for(let i=0;i<a;i+=u){r&&r.debug(`Hashing ${o}: ${i}/${a}`);const n=Math.min(a-i,u),l=await e.read(n*c),d=await s.batchLEMtoU(l);t.update(d)}e.pos=d}},verify:async function(t,e){let i;await tn.ready();const{fd:n,sections:a}=await di(t,"ptau",1),{curve:o,power:r,ceremonyPower:s}=await go(n,a),c=await Lo(n,o,a);e&&e.debug("power: 2**"+r),e&&e.debug("Computing initial contribution hash");const l={tauG1:o.G1.g,tauG2:o.G2.g,alphaG1:o.G1.g,betaG1:o.G1.g,betaG2:o.G2.g,nextChallenge:yo(o,s,e),responseHash:tn(64).digest()};if(0==c.length)return e&&e.error("This file has no contribution! It cannot be used in production"),!1;let u;u=c.length>1?c[c.length-2]:l;const d=c[c.length-1];if(e&&e.debug("Validating contribution #"+c[c.length-1].id),!await Co(o,d,u,e))return!1;const f=tn(64);f.update(d.responseHash),e&&e.debug("Verifying powers in tau*G1 section");const h=await b(2,"G1","tauG1",2**r*2-1,[0,1],e);if(i=await Io(o,h.R1,h.R2,o.G2.g,d.tauG2),!0!==i)return e&&e.error("tauG1 section. Powers do not match"),!1;if(!o.G1.eq(o.G1.g,h.singularPoints[0]))return e&&e.error("First element of tau*G1 section must be the generator"),!1;if(!o.G1.eq(d.tauG1,h.singularPoints[1]))return e&&e.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in tau*G2 section");const g=await b(3,"G2","tauG2",2**r,[0,1],e);if(i=await Io(o,o.G1.g,d.tauG1,g.R1,g.R2),!0!==i)return e&&e.error("tauG2 section. Powers do not match"),!1;if(!o.G2.eq(o.G2.g,g.singularPoints[0]))return e&&e.error("First element of tau*G2 section must be the generator"),!1;if(!o.G2.eq(d.tauG2,g.singularPoints[1]))return e&&e.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in alpha*tau*G1 section");const p=await b(4,"G1","alphatauG1",2**r,[0],e);if(i=await Io(o,p.R1,p.R2,o.G2.g,d.tauG2),!0!==i)return e&&e.error("alphaTauG1 section. Powers do not match"),!1;if(!o.G1.eq(d.alphaG1,p.singularPoints[0]))return e&&e.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in beta*tau*G1 section");const _=await b(5,"G1","betatauG1",2**r,[0],e);if(i=await Io(o,_.R1,_.R2,o.G2.g,d.tauG2),!0!==i)return e&&e.error("betaTauG1 section. Powers do not match"),!1;if(!o.G1.eq(d.betaG1,_.singularPoints[0]))return e&&e.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;const m=await async function(t){const e=o.G2,i=2*e.F.n8,r=new Uint8Array(i);if(!a[6])throw t.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(a[6].length>1)throw t.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");n.pos=a[6][0].p;const s=await n.read(i),c=e.fromRprLEM(s);return e.toRprUncompressed(r,0,c),f.update(r),c}(e);if(!o.G2.eq(d.betaG2,m))return e&&e.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;const L=f.digest();if(r==s&&!an(L,d.nextChallenge))return e&&e.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;e&&e.info(nn(L,"Next challenge hash: ")),w(d,u);for(let t=c.length-2;t>=0;t--){const i=c[t],n=t>0?c[t-1]:l;if(!await Co(o,i,n,e))return!1;w(i,n)}if(e&&e.info("-----------------------------------------------------"),a[12]&&a[13]&&a[14]&&a[15]){let t;if(t=await y("G1",2,12,"tauG1",e),!t)return!1;if(t=await y("G2",3,13,"tauG2",e),!t)return!1;if(t=await y("G1",4,14,"alphaTauG1",e),!t)return!1;if(t=await y("G1",5,15,"betaTauG1",e),!t)return!1}else e&&e.warn('this file does not contain phase2 precalculated values. Please run: \n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.');return await n.close(),e&&e.info("Powers of Tau Ok!"),!0;function w(t,i){if(!e)return;e.info("-----------------------------------------------------"),e.info(`Contribution #${t.id}: ${t.name||""}`),e.info(nn(t.nextChallenge,"Next Challenge: "));const n=new Uint8Array(2*o.G1.F.n8*6+2*o.G2.F.n8*3);_o(n,0,o,t.key,!1);const a=tn(64);a.setPartialHash(t.partialHash),a.update(n);const r=a.digest();e.info(nn(r,"Response Hash:")),e.info(nn(i.nextChallenge,"Response Hash:")),1==t.type&&(e.info(`Beacon generator: ${un(t.beaconHash)}`),e.info(`Beacon iterations Exp: ${t.numIterationsExp}`))}async function b(t,e,i,r,s,c){const l=o[e],u=2*l.F.n8;await pi(n,a,t);const d=[];let h=l.zero,g=l.zero,p=l.zero;for(let t=0;t<r;t+=65536){c&&c.debug(`points relations: ${i}: ${t}/${r} `);const e=Math.min(r-t,65536),a=await n.read(e*u),o=await l.batchLEMtoU(a);f.update(o);const _=new Uint8Array(4*(e-1));if(mt.randomFillSync(_),t>0){const t=l.fromRprLEM(a,0),e=mt.randomBytes(4).readUInt32BE(0,!0);h=l.add(h,l.timesScalar(p,e)),g=l.add(g,l.timesScalar(t,e))}const m=await l.multiExpAffine(a.slice(0,(e-1)*u),_),L=await l.multiExpAffine(a.slice(u),_);h=l.add(h,m),g=l.add(g,L),p=l.fromRprLEM(a,(e-1)*u);for(let i=0;i<s.length;i++){const n=s[i];if(n>=t&&n<t+e){const e=l.fromRprLEM(a,(n-t)*u);d.push(e)}}}return await _i(n),{R1:h,R2:g,singularPoints:d}}async function y(t,e,i,s,c){c&&c.debug(`Verifying phase2 calculated values ${s}...`);const l=o[t],u=2*l.F.n8,d=new Array(8);for(let t=0;t<8;t++)d[t]=mt.randomBytes(4).readUInt32BE(0,!0);for(let t=0;t<=r;t++){if(!await f(t))return!1}if(2==e){if(!await f(r+1))return!1}return!0;async function f(t){c&&c.debug(`Power ${t}...`);const f=o.Fr.n8,h=2**t;let g,p=new Uint32Array(h),_=new _t(d);c&&c.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<h;e++)p[e]=t==r+1&&e==h-1?0:_.nextU32();p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength),c&&c.debug(`reading points Powers${t}...`),await pi(n,a,e),g=new pe(h*u),t==r+1?(await n.readToBuffer(g,0,(h-1)*u),g.set(o.G1.zeroAffine,(h-1)*u)):await n.readToBuffer(g,0,h*u),await _i(n,!0);const m=await l.multiExpAffine(g,p,c,s+"_"+t);p=new pe(h*f),_=new _t(d);const L=new Uint8Array(4),w=new DataView(L.buffer);c&&c.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<h;e++)e==h-1&&t==r+1||(w.setUint32(0,_.nextU32(),!0),p.set(L,e*f));c&&c.debug(`batchToMontgomery ${t}...`),p=await o.Fr.batchToMontgomery(p),c&&c.debug(`fft ${t}...`),p=await o.Fr.fft(p),c&&c.debug(`batchFromMontgomery ${t}...`),p=await o.Fr.batchFromMontgomery(p),c&&c.debug(`reading points Lagrange${t}...`),await pi(n,a,i),n.pos+=u*(2**t-1),await n.readToBuffer(g,0,h*u),await _i(n,!0);const b=await l.multiExpAffine(g,p,c,s+"_"+t+"_transformed");return!!l.eq(m,b)||(c&&c.error("Phase2 caclutation does not match with powers of tau"),!1)}}},challengeContribute:async function(t,e,i,n,a){await tn.ready();const o=await ui(e),r=8*t.F1.n64*2,s=8*t.F2.n64*2,c=(o.totalSize+r-64-s)/(4*r+s);let l=c,u=0;for(;l>1;)l/=2,u+=1;if(2**u!=c)throw new Error("Invalid file size");a&&a.debug("Power to tau size: "+u);const d=await sn(n),f=await li(i),h=tn(64);for(let t=0;t<o.totalSize;t+=o.pageSize){a&&a.debug(`Hashing challenge ${t}/${o.totalSize}`);const e=Math.min(o.totalSize-t,o.pageSize),i=await o.read(e);h.update(i)}const g=await o.read(64,0);a&&a.info(nn(g,"Claimed Previous Response Hash: "));const p=h.digest();a&&a.info(nn(p,"Current Challenge Hash: "));const _=fo(t,p,d);a&&["tau","alpha","beta"].forEach((e=>{a.debug(e+".g1_s: "+t.G1.toString(_[e].g1_s,16)),a.debug(e+".g1_sx: "+t.G1.toString(_[e].g1_sx,16)),a.debug(e+".g2_sp: "+t.G2.toString(_[e].g2_sp,16)),a.debug(e+".g2_spx: "+t.G2.toString(_[e].g2_spx,16)),a.debug("")}));const m=tn(64);await f.write(p),m.update(p),await Fo(o,f,m,t,"G1",2**u*2-1,t.Fr.one,_.tau.prvKey,"COMPRESSED","tauG1",a),await Fo(o,f,m,t,"G2",2**u,t.Fr.one,_.tau.prvKey,"COMPRESSED","tauG2",a),await Fo(o,f,m,t,"G1",2**u,_.alpha.prvKey,_.tau.prvKey,"COMPRESSED","alphaTauG1",a),await Fo(o,f,m,t,"G1",2**u,_.beta.prvKey,_.tau.prvKey,"COMPRESSED","betaTauG1",a),await Fo(o,f,m,t,"G2",1,_.beta.prvKey,_.tau.prvKey,"COMPRESSED","betaTauG2",a);const L=new Uint8Array(2*t.F1.n8*6+2*t.F2.n8*3);_o(L,0,t,_,!1),await f.write(L),m.update(L);const w=m.digest();a&&a.info(nn(w,"Contribution Response Hash: ")),await f.close(),await o.close()},beacon:async function(t,e,i,n,a,o){const r=ln(n);if(0==r.byteLength||2*r.byteLength!=n.length)return o&&o.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(r.length>=256)return o&&o.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((a=parseInt(a))<10||a>63)return o&&o.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await tn.ready();const{fd:s,sections:c}=await di(t,"ptau",1),{curve:l,power:u,ceremonyPower:d}=await go(s,c);if(u!=d)return o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),!1;c[12]&&o&&o.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const f=await Lo(s,l,c),h={name:i,type:1,numIterationsExp:a,beaconHash:r};let g;g=f.length>0?f[f.length-1].nextChallenge:yo(l,u,o),h.key=Ao(l,g,r,a);const p=new tn(64);p.update(g);const _=await fi(e,"ptau",1,7);await ho(_,l,u);const m=[];let L;L=await A(2,"G1",2**u*2-1,l.Fr.e(1),h.key.tau.prvKey,"tauG1",o),h.tauG1=L[1],L=await A(3,"G2",2**u,l.Fr.e(1),h.key.tau.prvKey,"tauG2",o),h.tauG2=L[1],L=await A(4,"G1",2**u,h.key.alpha.prvKey,h.key.tau.prvKey,"alphaTauG1",o),h.alphaG1=L[0],L=await A(5,"G1",2**u,h.key.beta.prvKey,h.key.tau.prvKey,"betaTauG1",o),h.betaG1=L[0],L=await A(6,"G2",1,h.key.beta.prvKey,h.key.tau.prvKey,"betaTauG2",o),h.betaG2=L[0],h.partialHash=p.getPartialHash();const w=new Uint8Array(2*l.F1.n8*6+2*l.F2.n8*3);_o(w,0,l,h.key,!1),p.update(new Uint8Array(w));const b=p.digest();o&&o.info(nn(b,"Contribution Response Hash imported: "));const y=new tn(64);return y.update(b),await I(_,"G1",2,2**u*2-1,"tauG1",o),await I(_,"G2",3,2**u,"tauG2",o),await I(_,"G1",4,2**u,"alphaTauG1",o),await I(_,"G1",5,2**u,"betaTauG1",o),await I(_,"G2",6,1,"betaG2",o),h.nextChallenge=y.digest(),o&&o.info(nn(h.nextChallenge,"Next Challenge Hash: ")),f.push(h),await bo(_,l,f),await s.close(),await _.close(),b;async function A(t,e,i,n,a,o,r){const u=[];s.pos=c[t][0].p,await hi(_,t),m[t]=_.pos;const d=l[e],f=2*d.F.n8,h=Math.floor((1<<20)/f);let g=n;for(let t=0;t<i;t+=h){r&&r.debug(`applying key${o}: ${t}/${i}`);const e=Math.min(i-t,h),n=await s.read(e*f),c=await d.batchApplyKey(n,g,a),m=_.write(c),L=await d.batchLEMtoC(c);if(p.update(L),await m,0==t)for(let t=0;t<Math.min(2,i);t++)u.push(d.fromRprLEM(c,t*f));g=l.Fr.mul(g,l.Fr.exp(a,e))}return await gi(_),u}async function I(t,e,i,n,a,o){const r=l[e],s=2*r.F.n8,c=Math.floor((1<<24)/s),u=t.pos;t.pos=m[i];for(let e=0;e<n;e+=c){o&&o.debug(`Hashing ${a}: ${e}/${n}`);const i=Math.min(n-e,c),l=await t.read(i*s),u=await r.batchLEMtoU(l);y.update(u)}t.pos=u}},contribute:async function(t,e,i,n,a){await tn.ready();const{fd:o,sections:r}=await di(t,"ptau",1),{curve:s,power:c,ceremonyPower:l}=await go(o,r);if(c!=l)throw a&&a.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");r[12]&&a&&a.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const u=await Lo(o,s,r),d={name:i,type:0};let f;const h=await sn(n);f=u.length>0?u[u.length-1].nextChallenge:yo(s,c,a),d.key=fo(s,f,h);const g=new tn(64);g.update(f);const p=await fi(e,"ptau",1,7);await ho(p,s,c);const _=[];let m;m=await y(2,"G1",2**c*2-1,s.Fr.e(1),d.key.tau.prvKey,"tauG1"),d.tauG1=m[1],m=await y(3,"G2",2**c,s.Fr.e(1),d.key.tau.prvKey,"tauG2"),d.tauG2=m[1],m=await y(4,"G1",2**c,d.key.alpha.prvKey,d.key.tau.prvKey,"alphaTauG1"),d.alphaG1=m[0],m=await y(5,"G1",2**c,d.key.beta.prvKey,d.key.tau.prvKey,"betaTauG1"),d.betaG1=m[0],m=await y(6,"G2",1,d.key.beta.prvKey,d.key.tau.prvKey,"betaTauG2"),d.betaG2=m[0],d.partialHash=g.getPartialHash();const L=new Uint8Array(2*s.F1.n8*6+2*s.F2.n8*3);_o(L,0,s,d.key,!1),g.update(new Uint8Array(L));const w=g.digest();a&&a.info(nn(w,"Contribution Response Hash imported: "));const b=new tn(64);return b.update(w),await A(p,"G1",2,2**c*2-1,"tauG1"),await A(p,"G2",3,2**c,"tauG2"),await A(p,"G1",4,2**c,"alphaTauG1"),await A(p,"G1",5,2**c,"betaTauG1"),await A(p,"G2",6,1,"betaG2"),d.nextChallenge=b.digest(),a&&a.info(nn(d.nextChallenge,"Next Challenge Hash: ")),u.push(d),await bo(p,s,u),await o.close(),await p.close(),w;async function y(t,e,i,n,c,l){const u=[];o.pos=r[t][0].p,await hi(p,t),_[t]=p.pos;const d=s[e],f=2*d.F.n8,h=Math.floor((1<<20)/f);let m=n;for(let t=0;t<i;t+=h){a&&a.debug(`processing: ${l}: ${t}/${i}`);const e=Math.min(i-t,h),n=await o.read(e*f),r=await d.batchApplyKey(n,m,c),_=p.write(r),L=await d.batchLEMtoC(r);if(g.update(L),await _,0==t)for(let t=0;t<Math.min(2,i);t++)u.push(d.fromRprLEM(r,t*f));m=s.Fr.mul(m,s.Fr.exp(c,e))}return await gi(p),u}async function A(t,e,i,n,o){const r=s[e],c=2*r.F.n8,l=Math.floor((1<<24)/c),u=t.pos;t.pos=_[i];for(let e=0;e<n;e+=l){a&&e&&a.debug(`Hashing ${o}: `+e);const i=Math.min(n-e,l),s=await t.read(i*c),u=await r.batchLEMtoU(s);b.update(u)}t.pos=u}},preparePhase2:async function(t,e,i){const{fd:n,sections:a}=await di(t,"ptau",1),{curve:o,power:r}=await go(n,a),s=await fi(e,"ptau",1,11);return await ho(s,o,r),await wi(n,a,s,2),await wi(n,a,s,3),await wi(n,a,s,4),await wi(n,a,s,5),await wi(n,a,s,6),await wi(n,a,s,7),await c(2,12,"G1","tauG1"),await c(3,13,"G2","tauG2"),await c(4,14,"G1","alphaTauG1"),await c(5,15,"G1","betaTauG1"),await n.close(),void await s.close();async function c(t,e,c,l){i&&i.debug("Starting section: "+l),await hi(s,e);for(let t=0;t<=r;t++)await u(t);async function u(e){const u=2**e,d=o[c];o.Fr;const f=2*d.F.n8;let h;d.F.n8,h=new pe(u*f),await pi(n,a,t),2==t&&e==r+1?(await n.readToBuffer(h,0,(u-1)*f),h.set(o.G1.zeroAffine,(u-1)*f)):await n.readToBuffer(h,0,u*f),await _i(n,!0),h=await d.lagrangeEvaluations(h,"affine","affine",i,l),await s.write(h)}2==t&&await u(r+1),await gi(s)}},truncate:async function(t,e,i){const{fd:n,sections:a}=await di(t,"ptau",1),{curve:o,power:r,ceremonyPower:s}=await go(n,a),c=2*o.G1.F.n8,l=2*o.G2.F.n8;for(let t=1;t<r;t++)await u(t);return await n.close(),!0;async function u(t){let r=t.toString();for(;r.length<2;)r="0"+r;i&&i.debug("Writing Power: "+r);const u=await fi(e+r+".ptau","ptau",1,11);await ho(u,o,t,s),await wi(n,a,u,2,(2**t*2-1)*c),await wi(n,a,u,3,2**t*l),await wi(n,a,u,4,2**t*c),await wi(n,a,u,5,2**t*c),await wi(n,a,u,6,l),await wi(n,a,u,7),await wi(n,a,u,12,(2**(t+1)*2-1)*c),await wi(n,a,u,13,(2**t*2-1)*l),await wi(n,a,u,14,(2**t*2-1)*c),await wi(n,a,u,15,(2**t*2-1)*c),await u.close()}},convert:async function(t,e,i){const{fd:n,sections:a}=await di(t,"ptau",1),{curve:o,power:r}=await go(n,a),s=await fi(e,"ptau",1,11);return await ho(s,o,r),await wi(n,a,s,2),await wi(n,a,s,3),await wi(n,a,s,4),await wi(n,a,s,5),await wi(n,a,s,6),await wi(n,a,s,7),await async function(t,e,c,l){i&&i.debug("Starting section: "+l);await hi(s,e);const u=a[e][0].size,d=n.pageSize;await pi(n,a,e);for(let t=0;t<u;t+=d){const e=Math.min(u-t,d),i=await n.read(e);await s.write(i)}await _i(n),2==t&&await async function(e){const u=2**e,d=o[c],f=2*d.F.n8;let h;h=new pe(u*f),await pi(n,a,t),2==t&&e==r+1?(await n.readToBuffer(h,0,(u-1)*f),h.set(o.G1.zeroAffine,(u-1)*f)):await n.readToBuffer(h,0,u*f);await _i(n,!0),h=await d.lagrangeEvaluations(h,"affine","affine",i,l),await s.write(h)}(r+1);await gi(s)}(2,12,"G1","tauG1"),await wi(n,a,s,13),await wi(n,a,s,14),await wi(n,a,s,15),await n.close(),void await s.close()},exportJson:async function(t,e){const{fd:i,sections:n}=await di(t,"ptau",1),{curve:a,power:o}=await go(i,n),r={};return r.q=a.q,r.power=o,r.contributions=await Lo(i,a,n),r.tauG1=await s(2,"G1",2**o*2-1,"tauG1"),r.tauG2=await s(3,"G2",2**o,"tauG2"),r.alphaTauG1=await s(4,"G1",2**o,"alphaTauG1"),r.betaTauG1=await s(5,"G1",2**o,"betaTauG1"),r.betaG2=await s(6,"G2",1,"betaG2"),r.lTauG1=await c(12,"G1","lTauG1"),r.lTauG2=await c(13,"G2","lTauG2"),r.lAlphaTauG1=await c(14,"G1","lAlphaTauG2"),r.lBetaTauG1=await c(15,"G1","lBetaTauG2"),await i.close(),r;async function s(t,o,r,s){const c=a[o],l=2*c.F.n8,u=[];await pi(i,n,t);for(let t=0;t<r;t++){e&&t&&t%1e4==0&&console.log(`${s}: `+t);const n=await i.read(l);u.push(c.fromRprLEM(n,0))}return await _i(i),u}async function c(t,r,s){const c=a[r],l=2*c.F.n8,u=[];await pi(i,n,t);for(let t=0;t<=o;t++){e&&console.log(`${s}: Power: ${t}`),u[t]=[];const n=2**t;for(let a=0;a<n;a++){e&&a&&a%1e4==0&&console.log(`${s}: ${a}/${n}`);const o=await i.read(l);u[t].push(c.fromRprLEM(o,0))}}return await _i(i),u}}});const Bo=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Eo(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const So=Eo;function Oo(t,e){return BigInt(t)<<BigInt(e)}function qo(t,e){return BigInt(t)>>BigInt(e)}const Go=Oo,Uo=qo;var zo=Object.freeze({__proto__:null,fromString:Eo,e:So,fromArray:function(t,e){let i=BigInt(0);e=BigInt(e);for(let n=0;n<t.length;n++)i=i*e+BigInt(t[n]);return i},bitLength:function(t){const e=t.toString(16);return 4*(e.length-1)+Bo[parseInt(e[0],16)]},isNegative:function(t){return BigInt(t)<BigInt(0)},isZero:function(t){return!t},shiftLeft:Oo,shiftRight:qo,shl:Go,shr:Uo,isOdd:function(t){return(BigInt(t)&BigInt(1))==BigInt(1)},naf:function(t){let e=BigInt(t);const i=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));i.push(t),e-=BigInt(t)}else i.push(0);e>>=BigInt(1)}return i},bits:function(t){let e=BigInt(t);const i=[];for(;e;)e&BigInt(1)?i.push(1):i.push(0),e>>=BigInt(1);return i},toNumber:function(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)},toArray:function(t,e){const i=[];let n=BigInt(t);for(e=BigInt(e);n;)i.unshift(Number(n%e)),n/=e;return i},add:function(t,e){return BigInt(t)+BigInt(e)},sub:function(t,e){return BigInt(t)-BigInt(e)},neg:function(t){return-BigInt(t)},mul:function(t,e){return BigInt(t)*BigInt(e)},square:function(t){return BigInt(t)*BigInt(t)},pow:function(t,e){return BigInt(t)**BigInt(e)},exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:function(t,e){return BigInt(t)/BigInt(e)},mod:function(t,e){return BigInt(t)%BigInt(e)},eq:function(t,e){return BigInt(t)==BigInt(e)},neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:function(t,e){return BigInt(t)>BigInt(e)},leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:function(t,e){return BigInt(t)>=BigInt(e)},band:function(t,e){return BigInt(t)&BigInt(e)},bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)}});function Po(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?d(t.slice(2),16):d(t,e)}const Mo=Po;function Qo(t,e){return d(t).shiftLeft(e)}function To(t,e){return d(t).shiftRight(e)}const Ro=Qo,ko=To;var No=Object.freeze({__proto__:null,fromString:Po,e:Mo,fromArray:function(t,e){return d.fromArray(t,e)},bitLength:function(t){return d(t).bitLength()},isNegative:function(t){return d(t).isNegative()},isZero:function(t){return d(t).isZero()},shiftLeft:Qo,shiftRight:To,shl:Ro,shr:ko,isOdd:function(t){return d(t).isOdd()},naf:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();i.push(t),e=e.minus(t)}else i.push(0);e=e.shiftRight(1)}return i},bits:function(t){let e=d(t);const i=[];for(;e.gt(d.zero);)e.isOdd()?i.push(1):i.push(0),e=e.shiftRight(1);return i},toNumber:function(t){if(!t.lt(d("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()},toArray:function(t,e){return d(t).toArray(e)},add:function(t,e){return d(t).add(d(e))},sub:function(t,e){return d(t).minus(d(e))},neg:function(t){return d.zero.minus(d(t))},mul:function(t,e){return d(t).times(d(e))},square:function(t){return d(t).square()},pow:function(t,e){return d(t).pow(d(e))},exp:function(t,e){return d(t).pow(d(e))},abs:function(t){return d(t).abs()},div:function(t,e){return d(t).divide(d(e))},mod:function(t,e){return d(t).mod(d(e))},eq:function(t,e){return d(t).eq(d(e))},neq:function(t,e){return d(t).neq(d(e))},lt:function(t,e){return d(t).lt(d(e))},gt:function(t,e){return d(t).gt(d(e))},leq:function(t,e){return d(t).leq(d(e))},geq:function(t,e){return d(t).geq(d(e))},band:function(t,e){return d(t).and(d(e))},bor:function(t,e){return d(t).or(d(e))},bxor:function(t,e){return d(t).xor(d(e))},land:function(t,e){return!d(t).isZero()&&!d(e).isZero()},lor:function(t,e){return!d(t).isZero()||!d(e).isZero()},lnot:function(t){return d(t).isZero()}});const Do="function"==typeof BigInt;let jo={};Do?Object.assign(jo,zo):Object.assign(jo,No),jo.toRprLE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new Uint32Array(t.buffer,e,n/4),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o[t]=parseInt(a.substring(a.length-8*t-8,a.length-8*t),16);for(let t=r;t<o.length;t++)o[t]=0;for(let e=4*o.length;e<n;e++)t[e]=jo.toNumber(jo.band(jo.shiftRight(i,8*e),255))},jo.toRprBE=function(t,e,i,n){const a="0000000"+i.toString(16),o=new DataView(t.buffer,t.byteOffset+e,n),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o.setUint32(n-4*t-4,parseInt(a.substring(a.length-8*t-8,a.length-8*t),16),!1);for(let t=0;t<n/4-r;t++)o[t]=0},jo.fromRprLE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new Uint32Array(t.buffer,e,i/4),a=new Array(i/4);return n.forEach(((t,e)=>a[a.length-e-1]=t.toString(16).padStart(8,"0"))),jo.fromString(a.join(""),16)},jo.fromRprBE=function(t,e,i){i=i||t.byteLength,e=e||0;const n=new DataView(t.buffer,t.byteOffset+e,i),a=new Array(i/4);for(let t=0;t<i/4;t++)a[t]=n.getUint32(4*t,!1).toString(16).padStart(8,"0");return jo.fromString(a.join(""),16)},jo.toString=function(t,e){return t.toString(e)},jo.toLEBuff=function(t){const e=new Uint8Array(Math.floor((jo.bitLength(t)-1)/8)+1);return jo.toRprLE(e,0,t,e.byteLength),e},jo.zero=jo.e(0),jo.one=jo.e(1);let{toRprLE:Vo,toRprBE:Ko,fromRprLE:$o,fromRprBE:Ho,toString:Zo,toLEBuff:Jo,zero:Yo,one:Wo,fromString:Xo,e:tr,fromArray:er,bitLength:ir,isNegative:nr,isZero:ar,shiftLeft:or,shiftRight:rr,shl:sr,shr:cr,isOdd:lr,naf:ur,bits:dr,toNumber:fr,toArray:hr,add:gr,sub:pr,neg:_r,mul:mr,square:Lr,pow:wr,exp:br,abs:yr,div:Ar,mod:Ir,eq:Cr,neq:vr,lt:Fr,gt:xr,leq:Br,geq:Er,band:Sr,bor:Or,bxor:qr,land:Gr,lor:Ur,lnot:zr}=jo;function Pr(t,e,i,n,a){t[e]=t[e]+t[i]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<16|t[a]>>>16&65535)>>>0,t[n]=t[n]+t[a]>>>0,t[i]=(t[i]^t[n])>>>0,t[i]=(t[i]<<12|t[i]>>>20&4095)>>>0,t[e]=t[e]+t[i]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<8|t[a]>>>24&255)>>>0,t[n]=t[n]+t[a]>>>0,t[i]=(t[i]^t[n])>>>0,t[i]=(t[i]<<7|t[i]>>>25&127)>>>0}class Mr{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return gr(mr(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++)Pr(t=this.buff,0,4,8,12),Pr(t,1,5,9,13),Pr(t,2,6,10,14),Pr(t,3,7,11,15),Pr(t,0,5,10,15),Pr(t,1,6,11,12),Pr(t,2,7,8,13),Pr(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function Qr(){const t=function(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let i=0;i<t;i++)e[i]=4294967296*Math.random()>>>0;return e}(32),e=new Uint32Array(t.buffer),i=[];for(let t=0;t<8;t++)i.push(e[t]);return i}let Tr=null;function Rr(){return Tr||(Tr=new Mr(Qr()),Tr)}var kr=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return $o(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=BigInt(0),i=t.length,n=0;const a=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i>0;)i>=4?(i-=4,e+=BigInt(a.getUint32(i))<<BigInt(8*n),n+=4):i>=2?(i-=2,e+=BigInt(a.getUint16(i))<<BigInt(8*n),n+=2):(i-=1,e+=BigInt(a.getUint8(i))<<BigInt(8*n),n+=1);return e},beInt2Buff:function(t,e){let i=t;const n=new Uint8Array(e),a=new DataView(n.buffer);let o=e;for(;o>0;)o-4>=0?(o-=4,a.setUint32(o,Number(i&BigInt(4294967295))),i>>=BigInt(32)):o-2>=0?(o-=2,a.setUint16(o,Number(i&BigInt(65535))),i>>=BigInt(16)):(o-=1,a.setUint8(o,Number(i&BigInt(255))),i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},leBuff2int:function(t){let e=BigInt(0),i=0;const n=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i<t.length;)i+4<=t.length?(e+=BigInt(n.getUint32(i,!0))<<BigInt(8*i),i+=4):i+4<=t.length?(e+=BigInt(n.getUint16(i,!0))<<BigInt(8*i),i+=2):(e+=BigInt(n.getUint8(i,!0))<<BigInt(8*i),i+=1);return e},leInt2Buff:function(t,e){let i=t;void 0===e&&0==(e=Math.floor((ir(t)-1)/8)+1)&&(e=1);const n=new Uint8Array(e),a=new DataView(n.buffer);let o=0;for(;o<e;)o+4<=e?(a.setUint32(o,Number(i&BigInt(4294967295)),!0),o+=4,i>>=BigInt(32)):o+2<=e?(a.setUint16(Number(o,i&BigInt(65535)),!0),o+=2,i>>=BigInt(16)):(a.setUint8(Number(o,i&BigInt(255)),!0),o+=1,i>>=BigInt(8));if(i)throw new Error("Number does not fit in this length");return n},stringifyFElements:function t(e,i){if("bigint"==typeof i||void 0!==i.eq)return i.toString(10);if(i instanceof Uint8Array)return e.toString(e.e(i));if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i},unstringifyFElements:function t(e,i){if("string"==typeof i&&/^[0-9]+$/.test(i))return e.e(i);if("string"==typeof i&&/^0x[0-9a-fA-F]+$/.test(i))return e.e(i);if(Array.isArray(i))return i.map(t.bind(this,e));if("object"==typeof i){if(null===i)return null;const n={};return Object.keys(i).forEach((a=>{n[a]=t(e,i[a])})),n}return i}});var Nr=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return d(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return d(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=t(e[n])})),i}return e},beBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[t.length-i-1]);e=e.add(n.shiftLeft(8*i))}return e},beInt2Buff:function(t,e){let i=t,n=e-1;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n>=0;){let t=Number(i.and(d("255")));a[n]=t,n--,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a},leBuff2int:function(t){let e=d.zero;for(let i=0;i<t.length;i++){const n=d(t[i]);e=e.add(n.shiftLeft(8*i))}return e},leInt2Buff:function(t,e){let i=t,n=0;const a=new Uint8Array(e);for(;i.gt(d.zero)&&n<a.length;){let t=Number(i.and(d(255)));a[n]=t,n++,i=i.shiftRight(8)}if(!i.eq(d.zero))throw new Error("Number does not fit in this length");return a}});let Dr={};"function"==typeof BigInt?Object.assign(Dr,kr):Object.assign(Dr,Nr);const jr=[];for(let t=0;t<256;t++)jr[t]=Vr(t,8);function Vr(t,e){let i=0,n=t;for(let t=0;t<e;t++)i<<=1,i|=1&n,n>>=1;return i}Dr.bitReverse=function(t,e){return(jr[t>>>24]|jr[t>>>16&255]<<8|jr[t>>>8&255]<<16|jr[255&t]<<24)>>>32-e},Dr.log2=function(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)},Dr.buffReverseBits=function(t,e){const i=t.byteLength/e,n=Dr.log2(i);if(i!=1<<n)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const i=Dr.bitReverse(a,n);if(a>i){const n=t.slice(a*e,(a+1)*e);t.set(t.slice(i*e,(i+1)*e),a*e),t.set(n,i*e)}}},Dr.array2buffer=function(t,e){const i=new Uint8Array(e*t.length);for(let n=0;n<t.length;n++)i.set(t[n],n*e);return i},Dr.buffer2array=function(t,e){const i=t.byteLength/e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t.slice(a*e,a*e+e);return n};let{bitReverse:Kr,log2:$r,buffReverseBits:Hr,stringifyBigInts:Zr,unstringifyBigInts:Jr,beBuff2int:Yr,beInt2Buff:Wr,leBuff2int:Xr,leInt2Buff:ts,array2buffer:es,buffer2array:is,stringifyFElements:ns,unstringifyFElements:as}=Dr;const os=1<<30;class rs{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=os){const i=Math.min(t-e,os);this.buffers.push(new Uint8Array(i))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const i=e-t,n=Math.floor(t/os);if(n==Math.floor((t+i-1)/os)||0==i)return this.buffers[n].slice(t%os,t%os+i);let a,o=n,r=t%os,s=i;for(;s>0;){const t=r+s>os?os-r:s,e=new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+r,t);if(t==i)return e.slice();a||(a=i<=os?new Uint8Array(i):new rs(i)),a.set(e,i-s),s-=t,o++,r=0}return a}set(t,e){void 0===e&&(e=0);const i=t.byteLength;if(0==i)return;const n=Math.floor(e/os);if(n==Math.floor((e+i-1)/os))return t instanceof rs&&1==t.buffers.length?this.buffers[n].set(t.buffers[0],e%os):this.buffers[n].set(t,e%os);let a=n,o=e%os,r=i;for(;r>0;){const e=o+r>os?os-o:r,n=t.slice(i-r,i-r+e);new Uint8Array(this.buffers[a].buffer,this.buffers[a].byteOffset+o,e).set(n),r-=e,a++,o=0}}}function ss(t,e,i,n){return async function(a){const o=Math.floor(a.byteLength/i);if(o*i!==a.byteLength)throw new Error("Invalid buffer size");const r=Math.floor(o/t.concurrency),s=[];for(let c=0;c<t.concurrency;c++){let l;if(l=c<t.concurrency-1?r:o-c*r,0==l)continue;const u=[{cmd:"ALLOCSET",var:0,buff:a.slice(c*r*i,c*r*i+l*i)},{cmd:"ALLOC",var:1,len:n*l},{cmd:"CALL",fnName:e,params:[{var:0},{val:l},{var:1}]},{cmd:"GET",out:0,var:1,len:n*l}];s.push(t.queueAction(u))}const c=await Promise.all(s);let l;l=a instanceof rs?new rs(o*n):new Uint8Array(o*n);let u=0;for(let t=0;t<c.length;t++)l.set(c[t][0],u),u+=c[t][0].byteLength;return l}}class cs{constructor(t,e,i,n){if(this.tm=t,this.prefix=e,this.p=n,this.n8=i,this.type="F1",this.m=1,this.half=rr(n,Wo),this.bitLength=ir(n),this.mask=pr(or(Wo,this.bitLength),Wo),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=rr(this.p,Wo),this.nqr=this.two;let a=this.exp(this.nqr,this.half);for(;!this.eq(a,this.negone);)this.nqr=this.add(this.nqr,this.one),a=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let o=pr(this.p,Wo);for(;!lr(o);)this.s=this.s+1,o=rr(o,Wo);this.w=[],this.w[this.s]=this.exp(this.nqr,o);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=ss(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=ss(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=Jo(tr(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let i=tr(t,e);nr(i)?(i=_r(i),xr(i,this.p)&&(i=Ir(i,this.p)),i=pr(this.p,i)):xr(i,this.p)&&(i=Ir(i,this.p));const n=ts(i,this.n8);return this.toMontgomery(n)}toString(t,e){const i=this.fromMontgomery(t),n=$o(i,0);return Zo(n,e)}fromRng(t){let e;const i=new Uint8Array(this.n8);do{e=Yo;for(let i=0;i<this.n64;i++)e=gr(e,or(t.nextU64(),64*i));e=Sr(e,this.mask)}while(Er(e,this.p));return Vo(i,0,e,this.n8),i}random(){return this.fromRng(Rr())}toObject(t){const e=this.fromMontgomery(t);return $o(e,0)}fromObject(t){const e=new Uint8Array(this.n8);return Vo(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,i){t.set(this.fromMontgomery(i),e)}toRprBE(t,e,i){const n=this.fromMontgomery(i);for(let t=0;t<this.n8/2;t++){const e=n[t];n[t]=n[this.n8-1-t],n[this.n8-1-t]=e}t.set(n,e)}fromRprLE(t,e){e=e||0;const i=t.slice(e,e+this.n8);return this.toMontgomery(i)}async batchInverse(t){let e=!1;const i=this.n8,n=this.n8;Array.isArray(t)?(t=es(t,i),e=!0):t=t.slice(0,t.byteLength);const a=Math.floor(t.byteLength/i);if(a*i!==t.byteLength)throw new Error("Invalid buffer size");const o=Math.floor(a/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let s;if(s=e<this.tm.concurrency-1?o:a-e*o,0==s)continue;const c=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*o*i,e*o*i+s*i)},{cmd:"ALLOC",var:1,len:n*s},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:s},{var:1},{val:n}]},{cmd:"GET",out:0,var:1,len:n*s}];r.push(this.tm.queueAction(c))}const s=await Promise.all(r);let c;c=t instanceof rs?new rs(a*n):new Uint8Array(a*n);let l=0;for(let t=0;t<s.length;t++)c.set(s[t][0],l),l+=s[t][0].byteLength;return e?is(c,n):c}}class ls{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F2",this.m=2*i.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*i.n8),this.pOp2=t.alloc(2*i.n8),this.pOp3=t.alloc(2*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=Jo(tr(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const i=this.F.e(t[0],e),n=this.F.e(t[1],e),a=new Uint8Array(2*this.F.n8);return a.set(i),a.set(n,2*this.F.n8),a}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),i=this.F.fromRng(t),n=new Uint8Array(2*this.F.n8);return n.set(e),n.set(i,this.F.n8),n}random(){return this.fromRng(Rr())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),i=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]);return e.set(i),e.set(n,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class us{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F3",this.m=3*i.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=Jo(tr(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const i=this.F.e(t[0],e),n=this.F.e(t[1],e),a=this.F.e(t[2],e),o=new Uint8Array(3*this.F.n8);return o.set(i),o.set(n,this.F.n8),o.set(a,2*this.F.n8),o}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),i=this.F.fromRng(t),n=this.F.fromRng(t),a=new Uint8Array(3*this.F.n8);return a.set(e),a.set(i,this.F.n8),a.set(n,2*this.F.n8),a}random(){return this.fromRng(Rr())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),i=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]),a=this.F.fromObject(t[2]);return e.set(i),e.set(n,this.F.n8),e.set(a,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class ds{constructor(t,e,i,n,a,o){this.tm=t,this.prefix=e,this.F=i,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*i.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*i.n8),this.one=this.tm.getBuff(n,3*i.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(n,2*i.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(a,i.n8),o&&(this.cofactor=Jo(o)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=ss(t,e+"_batchLEMtoC",2*i.n8,i.n8),this.batchLEMtoU=ss(t,e+"_batchLEMtoU",2*i.n8,2*i.n8),this.batchCtoLEM=ss(t,e+"_batchCtoLEM",i.n8,2*i.n8),this.batchUtoLEM=ss(t,e+"_batchUtoLEM",2*i.n8,2*i.n8),this.batchToJacobian=ss(t,e+"_batchToJacobian",2*i.n8,3*i.n8),this.batchToAffine=ss(t,e+"_batchToAffine",3*i.n8,2*i.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let i;if(e instanceof Uint8Array||(e=Jo(tr(e))),t.byteLength==3*this.F.n8)i=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");i=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let i;if(t.byteLength==3*this.F.n8)i=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");i=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(n,e)}fromRprUncompressed(t,e){const i=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,this.F.n8);t.set(n,e)}fromRprCompressed(t,e){const i=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,i){if(i.byteLength!=2*this.F.n8){if(i.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const n=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(n,e)}}else t.set(i,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,i=this.toAffine(t),n=i.slice(0,this.F.n8),a=i.slice(this.F.n8,2*this.F.n8),o=e.add(e.mul(e.square(n),n),this.b),r=e.square(a);return e.eq(o,r)}fromRng(t){const e=this.F;let i,n,a=[];do{a[0]=e.fromRng(t),i=t.nextBool(),n=e.add(e.mul(e.square(a[0]),a[0]),this.b)}while(!e.isSquare(n));a[1]=e.sqrt(n);i^e.isNegative(a[1])&&(a[1]=e.neg(a[1]));let o=new Uint8Array(2*this.F.n8);return o.set(a[0]),o.set(a[1],this.F.n8),this.cofactor&&(o=this.timesScalar(o,this.cofactor)),o}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let n;return n=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,i,n]}fromObject(t){const e=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);let n;if(n=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(n,this.F.one))return this.zeroAffine;if(this.F.eq(n,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(i,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(i,this.F.n8),t.set(n,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function fs(t){const e=32767;let i,n;async function a(t){const a=new Uint8Array(t.code),o=await WebAssembly.compile(a);n=new WebAssembly.Memory({initial:t.init,maximum:e}),i=await WebAssembly.instantiate(o,{env:{memory:n}})}function o(t){const i=new Uint32Array(n.buffer,0,1);for(;3&i[0];)i[0]++;const a=i[0];if(i[0]+=t,i[0]+t>n.buffer.byteLength){const a=n.buffer.byteLength/65536;let o=Math.floor((i[0]+t)/65536)+1;o>e&&(o=e),n.grow(o-a)}return a}function r(t){const e=o(t.byteLength);return c(e,t),e}function s(t,e){const i=new Uint8Array(n.buffer);return new Uint8Array(i.buffer,i.byteOffset+t,e)}function c(t,e){new Uint8Array(n.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return a(t[0]);const e={vars:[],out:[]},l=new Uint32Array(n.buffer,0,1)[0];for(let n=0;n<t.length;n++)switch(t[n].cmd){case"ALLOCSET":e.vars[t[n].var]=r(t[n].buff);break;case"ALLOC":e.vars[t[n].var]=o(t[n].len);break;case"SET":c(e.vars[t[n].var],t[n].buff);break;case"CALL":{const a=[];for(let i=0;i<t[n].params.length;i++){const o=t[n].params[i];void 0!==o.var?a.push(e.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}i.exports[t[n].fnName](...a);break}case"GET":e.out[t[n].out]=s(e.vars[t[n].var],t[n].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(n.buffer,0,1)[0]=l,e.out}return t&&(t.onmessage=function(e){let i;if(i=e.data?e.data:e,"INIT"==i[0].cmd)a(i[0]).then((function(){t.postMessage(i.result)}));else if("TERMINATE"==i[0].cmd)t.close();else{const e=l(i);t.postMessage(e)}}),l}class hs{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}const gs=function(t){return globalThis.btoa(t)}("("+fs.toString()+")(self)"),ps="data:application/javascript;base64,"+gs;class _s{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,i,n){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=n||new hs,this.workers[t].postMessage(e,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const i=new hs;if(this.singleThread){const e=this.taskManager(t);i.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((e=>setTimeout(e,t))))}}function ms(t,e){const i=t[e],n=t.Fr,a=t.tm;t[e].batchApplyKey=async function(t,o,r,s,c){let l,u,d,f,h;if(s=s||"affine",c=c||"affine","G1"==e)"jacobian"==s?(d=3*i.F.n8,l="g1m_batchApplyKey"):(d=2*i.F.n8,l="g1m_batchApplyKeyMixed"),f=3*i.F.n8,"jacobian"==c?h=3*i.F.n8:(u="g1m_batchToAffine",h=2*i.F.n8);else if("G2"==e)"jacobian"==s?(d=3*i.F.n8,l="g2m_batchApplyKey"):(d=2*i.F.n8,l="g2m_batchApplyKeyMixed"),f=3*i.F.n8,"jacobian"==c?h=3*i.F.n8:(u="g2m_batchToAffine",h=2*i.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);l="frm_batchApplyKey",d=i.n8,f=i.n8,h=i.n8}const g=Math.floor(t.byteLength/d),p=Math.floor(g/a.concurrency),_=[];r=n.e(r);let m=n.e(o);for(let e=0;e<a.concurrency;e++){let i;if(i=e<a.concurrency-1?p:g-e*p,0==i)continue;const o=[];o.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*p*d,e*p*d+i*d)}),o.push({cmd:"ALLOCSET",var:1,buff:m}),o.push({cmd:"ALLOCSET",var:2,buff:r}),o.push({cmd:"ALLOC",var:3,len:i*Math.max(f,h)}),o.push({cmd:"CALL",fnName:l,params:[{var:0},{val:i},{var:1},{var:2},{var:3}]}),u&&o.push({cmd:"CALL",fnName:u,params:[{var:3},{val:i},{var:3}]}),o.push({cmd:"GET",out:0,var:3,len:i*h}),_.push(a.queueAction(o)),m=n.mul(m,n.exp(r,i))}const L=await Promise.all(_);let w;w=t instanceof rs?new rs(g*h):new Uint8Array(g*h);let b=0;for(let t=0;t<L.length;t++)w.set(L[t][0],b),b+=L[t][0].byteLength;return w}}const Ls=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function ws(t,e){const i=t[e],n=i.tm;async function a(t,n,a,o,r){if(!(t instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffBases is not Uint8Array`),new Error(`${r} _multiExpChunk buffBases is not Uint8Array`);if(!(n instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${r} _multiExpChunk buffScalars is not Uint8Array`);let s,c;if(a=a||"affine","G1"==e)"affine"==a?(c="g1m_multiexpAffine_chunk",s=2*i.F.n8):(c="g1m_multiexp_chunk",s=3*i.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==a?(c="g2m_multiexpAffine_chunk",s=2*i.F.n8):(c="g2m_multiexp_chunk",s=3*i.F.n8)}const l=Math.floor(t.byteLength/s);if(0==l)return i.zero;const u=Math.floor(n.byteLength/l);if(u*l!=n.byteLength)throw new Error("Scalar size does not match");const d=Ls[$r(l)],f=Math.floor((8*u-1)/d)+1,h=[];for(let e=0;e<f;e++){const a=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:n},{cmd:"ALLOC",var:2,len:3*i.F.n8},{cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:u},{val:l},{val:e*d},{val:Math.min(8*u-e*d,d)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*i.F.n8}];h.push(i.tm.queueAction(a))}const g=await Promise.all(h);let p=i.zero;for(let t=g.length-1;t>=0;t--){if(!i.isZero(p))for(let t=0;t<d;t++)p=i.double(p);p=i.add(p,g[t][0])}return p}async function o(t,o,r,s,c){const l=1<<22;let u;if("G1"==e)u="affine"==r?2*i.F.n8:3*i.F.n8;else{if("G2"!=e)throw new Error("Invalid group");u="affine"==r?2*i.F.n8:3*i.F.n8}const d=Math.floor(t.byteLength/u),f=Math.floor(o.byteLength/d);if(f*d!=o.byteLength)throw new Error("Scalar size does not match");const h=Ls[$r(d)],g=Math.floor((8*f-1)/h)+1;let p;p=Math.floor(d/(n.concurrency/g)),p>l&&(p=l),p<1024&&(p=1024);const _=[];for(let e=0;e<d;e+=p){s&&s.debug(`Multiexp start: ${c}: ${e}/${d}`);const i=Math.min(d-e,p),n=t.slice(e*u,(e+i)*u),l=o.slice(e*f,(e+i)*f);_.push(a(n,l,r,s,c).then((t=>(s&&s.debug(`Multiexp end: ${c}: ${e}/${d}`),t))))}const m=await Promise.all(_);let L=i.zero;for(let t=m.length-1;t>=0;t--)L=i.add(L,m[t]);return L}i.multiExp=async function(t,e,i,n){return await o(t,e,"jacobian",i,n)},i.multiExpAffine=async function(t,e,i,n){return await o(t,e,"affine",i,n)}}function bs(t,e){const i=t[e],n=t.Fr,a=i.tm;async function o(t,s,c,l,u,d){c=c||"affine",l=l||"affine";let f,h,g,p,_,m,L,w;"G1"==e?("affine"==c?(f=2*i.F.n8,p="g1m_batchToJacobian"):f=3*i.F.n8,h=3*i.F.n8,s&&(w="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==l?(g=2*i.F.n8,_="g1m_batchToAffine"):g=3*i.F.n8):"G2"==e?("affine"==c?(f=2*i.F.n8,p="g2m_batchToJacobian"):f=3*i.F.n8,h=3*i.F.n8,s&&(w="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==l?(g=2*i.F.n8,_="g2m_batchToAffine"):g=3*i.F.n8):"Fr"==e&&(f=i.n8,h=i.n8,g=i.n8,s&&(w="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let b=!1;Array.isArray(t)?(t=es(t,f),b=!0):t=t.slice(0,t.byteLength);const y=t.byteLength/f,A=$r(y);if(1<<A!=y)throw new Error("fft must be multiple of 2");if(A==n.s+1){let e;return e=s?await async function(t,e,i,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const u=[];u.push(o(c,!0,e,"jacobian",a,s)),u.push(o(l,!0,e,"jacobian",a,s)),[c,l]=await Promise.all(u);const d=await r(c,l,"fftJoinExtInv",n.one,n.shiftInv,"jacobian",i,a,s);let f;f=d[0].byteLength>1<<28?new rs(2*d[0].byteLength):new Uint8Array(2*d[0].byteLength);return f.set(d[0]),f.set(d[1],d[0].byteLength),f}(t,c,l,u,d):await async function(t,e,i,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const u=[];[c,l]=await r(c,l,"fftJoinExt",n.one,n.shift,e,"jacobian",a,s),u.push(o(c,!1,"jacobian",i,a,s)),u.push(o(l,!1,"jacobian",i,a,s));const d=await Promise.all(u);let f;f=d[0].byteLength>1<<28?new rs(2*d[0].byteLength):new Uint8Array(2*d[0].byteLength);return f.set(d[0]),f.set(d[1],d[0].byteLength),f}(t,c,l,u,d),b?is(e,g):e}let I,C,v;s&&(I=n.inv(n.e(y))),Hr(t,f);let F=Math.min(16384,y),x=y/F;for(;x<a.concurrency&&F>=16;)x*=2,F/=2;const B=$r(F),E=[];for(let e=0;e<x;e++){u&&u.debug(`${d}: fft ${A} mix start: ${e}/${x}`);const i=[];i.push({cmd:"ALLOC",var:0,len:h*F});const n=t.slice(F*e*f,F*(e+1)*f);i.push({cmd:"SET",var:0,buff:n}),p&&i.push({cmd:"CALL",fnName:p,params:[{var:0},{val:F},{var:0}]});for(let t=1;t<=B;t++)i.push({cmd:"CALL",fnName:m,params:[{var:0},{val:F},{val:t}]});B==A?(w&&(i.push({cmd:"ALLOCSET",var:1,buff:I}),i.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:1}]})),_&&i.push({cmd:"CALL",fnName:_,params:[{var:0},{val:F},{var:0}]}),i.push({cmd:"GET",out:0,var:0,len:F*g})):i.push({cmd:"GET",out:0,var:0,len:h*F}),E.push(a.queueAction(i).then((t=>(u&&u.debug(`${d}: fft ${A} mix end: ${e}/${x}`),t))))}v=await Promise.all(E);for(let t=0;t<x;t++)v[t]=v[t][0];for(let t=B+1;t<=A;t++){u&&u.debug(`${d}: fft  ${A}  join: ${t}/${A}`);const e=1<<A-t,i=x/e,o=[];for(let r=0;r<e;r++)for(let s=0;s<i/2;s++){const c=n.exp(n.w[t],s*F),l=n.w[t],f=r*i+s,p=r*i+s+i/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:v[f]}),m.push({cmd:"ALLOCSET",var:1,buff:v[p]}),m.push({cmd:"ALLOCSET",var:2,buff:c}),m.push({cmd:"ALLOCSET",var:3,buff:l}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:F},{var:2},{var:3}]}),t==A?(w&&(m.push({cmd:"ALLOCSET",var:4,buff:I}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:4}]}),m.push({cmd:"CALL",fnName:w,params:[{var:1},{val:F},{var:4}]})),_&&(m.push({cmd:"CALL",fnName:_,params:[{var:0},{val:F},{var:0}]}),m.push({cmd:"CALL",fnName:_,params:[{var:1},{val:F},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:F*g}),m.push({cmd:"GET",out:1,var:1,len:F*g})):(m.push({cmd:"GET",out:0,var:0,len:F*h}),m.push({cmd:"GET",out:1,var:1,len:F*h})),o.push(a.queueAction(m).then((n=>(u&&u.debug(`${d}: fft ${A} join  ${t}/${A}  ${r+1}/${e} ${s}/${i/2}`),n))))}const r=await Promise.all(o);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){const n=t*i+e,a=t*i+e+i/2,o=r.shift();v[n]=o[0],v[a]=o[1]}}if(C=t instanceof rs?new rs(y*g):new Uint8Array(y*g),s){C.set(v[0].slice((F-1)*g));let t=g;for(let e=x-1;e>0;e--)C.set(v[e],t),t+=F*g,delete v[e];C.set(v[0].slice(0,(F-1)*g),t),delete v[0]}else for(let t=0;t<x;t++)C.set(v[t],F*g*t),delete v[t];return b?is(C,g):C}async function r(t,o,r,s,c,l,u,d,f){let h,g,p,_,m,L;if("G1"==e)"affine"==l?(m=2*i.F.n8,g="g1m_batchToJacobian"):m=3*i.F.n8,L=3*i.F.n8,h="g1m_"+r,"affine"==u?(p="g1m_batchToAffine",_=2*i.F.n8):_=3*i.F.n8;else if("G2"==e)"affine"==l?(m=2*i.F.n8,g="g2m_batchToJacobian"):m=3*i.F.n8,h="g2m_"+r,L=3*i.F.n8,"affine"==u?(p="g2m_batchToAffine",_=2*i.F.n8):_=3*i.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");m=n.n8,_=n.n8,L=n.n8,h="frm_"+r}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const w=Math.floor(t.byteLength/m);if(w!=1<<$r(w))throw new Error("Invalid number of points");let b=Math.floor(w/a.concurrency);b<16&&(b=16),b>65536&&(b=65536);const y=[];for(let e=0;e<w;e+=b){d&&d.debug(`${f}: fftJoinExt Start: ${e}/${w}`);const i=Math.min(w-e,b),r=n.mul(s,n.exp(c,e)),l=[],u=t.slice(e*m,(e+i)*m),A=o.slice(e*m,(e+i)*m);l.push({cmd:"ALLOC",var:0,len:L*i}),l.push({cmd:"SET",var:0,buff:u}),l.push({cmd:"ALLOC",var:1,len:L*i}),l.push({cmd:"SET",var:1,buff:A}),l.push({cmd:"ALLOCSET",var:2,buff:r}),l.push({cmd:"ALLOCSET",var:3,buff:c}),g&&(l.push({cmd:"CALL",fnName:g,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:g,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:i},{var:2},{var:3},{val:n.s}]}),p&&(l.push({cmd:"CALL",fnName:p,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:p,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"GET",out:0,var:0,len:i*_}),l.push({cmd:"GET",out:1,var:1,len:i*_}),y.push(a.queueAction(l).then((t=>(d&&d.debug(`${f}: fftJoinExt End: ${e}/${w}`),t))))}const A=await Promise.all(y);let I,C;w*_>1<<28?(I=new rs(w*_),C=new rs(w*_)):(I=new Uint8Array(w*_),C=new Uint8Array(w*_));let v=0;for(let t=0;t<A.length;t++)I.set(A[t][0],v),C.set(A[t][1],v),v+=A[t][0].byteLength;return[I,C]}i.fft=async function(t,e,i,n,a){return await o(t,!1,e,i,n,a)},i.ifft=async function(t,e,i,n,a){return await o(t,!0,e,i,n,a)},i.lagrangeEvaluations=async function(t,a,s,c,l){let u;if(a=a||"affine",s=s||"affine","G1"==e)u="affine"==a?2*i.F.n8:3*i.F.n8;else if("G2"==e)u="affine"==a?2*i.F.n8:3*i.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");u=n.n8}const d=t.byteLength/u,f=$r(d);if(2**f*u!=t.byteLength)throw c&&c.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(f<=n.s)return await i.ifft(t,a,s,c,l);if(f>n.s+1)throw c&&c.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let h=t.slice(0,t.byteLength/2),g=t.slice(t.byteLength/2,t.byteLength);const p=n.exp(n.shift,d/2),_=n.inv(n.sub(n.one,p));[h,g]=await r(h,g,"prepareLagrangeEvaluation",_,n.shiftInv,a,"jacobian",c,l+" prep");const m=[];let L;return m.push(o(h,!0,"jacobian",s,c,l+" t0")),m.push(o(g,!0,"jacobian",s,c,l+" t1")),[h,g]=await Promise.all(m),L=h.byteLength>1<<28?new rs(2*h.byteLength):new Uint8Array(2*h.byteLength),L.set(h),L.set(g,h.byteLength),L},i.fftMix=async function(t){const o=3*i.F.n8;let r,s;if("G1"==e)r="g1m_fftMix",s="g1m_fftJoin";else if("G2"==e)r="g2m_fftMix",s="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");r="frm_fftMix",s="frm_fftJoin"}const c=Math.floor(t.byteLength/o),l=$r(c);let u=1<<$r(a.concurrency);c<=2*u&&(u=1);const d=c/u,f=$r(d),h=[];for(let e=0;e<u;e++){const i=[],n=t.slice(e*d*o,(e+1)*d*o);i.push({cmd:"ALLOCSET",var:0,buff:n});for(let t=1;t<=f;t++)i.push({cmd:"CALL",fnName:r,params:[{var:0},{val:d},{val:t}]});i.push({cmd:"GET",out:0,var:0,len:d*o}),h.push(a.queueAction(i))}const g=await Promise.all(h),p=[];for(let t=0;t<g.length;t++)p[t]=g[t][0];for(let t=f+1;t<=l;t++){const e=1<<l-t,i=u/e,r=[];for(let c=0;c<e;c++)for(let e=0;e<i/2;e++){const l=n.exp(n.w[t],e*d),u=n.w[t],f=c*i+e,h=c*i+e+i/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:p[f]}),g.push({cmd:"ALLOCSET",var:1,buff:p[h]}),g.push({cmd:"ALLOCSET",var:2,buff:l}),g.push({cmd:"ALLOCSET",var:3,buff:u}),g.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:d},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:d*o}),g.push({cmd:"GET",out:1,var:1,len:d*o}),r.push(a.queueAction(g))}const c=await Promise.all(r);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){const n=t*i+e,a=t*i+e+i/2,o=c.shift();p[n]=o[0],p[a]=o[1]}}let _;_=t instanceof rs?new rs(c*o):new Uint8Array(c*o);let m=0;for(let t=0;t<u;t++)_.set(p[t],m),m+=p[t].byteLength;return _},i.fftJoin=async function(t,o,r,s){const c=3*i.F.n8;let l;if("G1"==e)l="g1m_fftJoin";else if("G2"==e)l="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");l="frm_fftJoin"}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const u=Math.floor(t.byteLength/c);if(u!=1<<$r(u))throw new Error("Invalid number of points");let d=1<<$r(a.concurrency);u<=2*d&&(d=1);const f=u/d,h=[];for(let e=0;e<d;e++){const i=[],u=n.mul(r,n.exp(s,e*f)),d=t.slice(e*f*c,(e+1)*f*c),g=o.slice(e*f*c,(e+1)*f*c);i.push({cmd:"ALLOCSET",var:0,buff:d}),i.push({cmd:"ALLOCSET",var:1,buff:g}),i.push({cmd:"ALLOCSET",var:2,buff:u}),i.push({cmd:"ALLOCSET",var:3,buff:s}),i.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:f},{var:2},{var:3}]}),i.push({cmd:"GET",out:0,var:0,len:f*c}),i.push({cmd:"GET",out:1,var:1,len:f*c}),h.push(a.queueAction(i))}const g=await Promise.all(h);let p,_;t instanceof rs?(p=new rs(u*c),_=new rs(u*c)):(p=new Uint8Array(u*c),_=new Uint8Array(u*c));let m=0;for(let t=0;t<g.length;t++)p.set(g[t][0],m),_.set(g[t][1],m),m+=g[t][0].byteLength;return[p,_]},i.fftFinal=async function(t,n){const o=3*i.F.n8,r=2*i.F.n8;let s,c;if("G1"==e)s="g1m_fftFinal",c="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");s="g2m_fftFinal",c="g2m_batchToAffine"}const l=Math.floor(t.byteLength/o);if(l!=1<<$r(l))throw new Error("Invalid number of points");const u=Math.floor(l/a.concurrency),d=[];for(let e=0;e<a.concurrency;e++){let i;if(i=e<a.concurrency-1?u:l-e*u,0==i)continue;const f=[],h=t.slice(e*u*o,(e*u+i)*o);f.push({cmd:"ALLOCSET",var:0,buff:h}),f.push({cmd:"ALLOCSET",var:1,buff:n}),f.push({cmd:"CALL",fnName:s,params:[{var:0},{val:i},{var:1}]}),f.push({cmd:"CALL",fnName:c,params:[{var:0},{val:i},{var:0}]}),f.push({cmd:"GET",out:0,var:0,len:i*r}),d.push(a.queueAction(f))}const f=await Promise.all(d);let h;h=t instanceof rs?new rs(l*r):new Uint8Array(l*r);let g=0;for(let t=f.length-1;t>=0;t--)h.set(f[t][0],g),g+=f[t][0].byteLength;return h}}async function ys(t){const e=await async function(t,e){const i=new _s;i.memory=new WebAssembly.Memory({initial:25}),i.u8=new Uint8Array(i.memory.buffer),i.u32=new Uint32Array(i.memory.buffer);const n=await WebAssembly.compile(t.code);if(i.instance=await WebAssembly.instantiate(n,{env:{memory:i.memory}}),i.singleThread=e,i.initalPFree=i.u32[0],i.pq=t.pq,i.pr=t.pr,i.pG1gen=t.pG1gen,i.pG1zero=t.pG1zero,i.pG2gen=t.pG2gen,i.pG2zero=t.pG2zero,i.pOneT=t.pOneT,e)i.code=t.code,i.taskManager=fs(),await i.taskManager([{cmd:"INIT",init:25,code:i.code.slice()}]),i.concurrency=1;else{let e;i.workers=[],i.pendingDeferreds=[],i.working=[],e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Ae.cpus().length,0==e&&(e=2),e>64&&(e=64),i.concurrency=e;for(let t=0;t<e;t++)i.workers[t]=new Ie(ps),i.workers[t].addEventListener("message",a(t)),i.working[t]=!1;const n=[];for(let e=0;e<i.workers.length;e++){const a=t.code.slice();n.push(i.postAction(e,[{cmd:"INIT",init:25,code:a}],[a.buffer]))}await Promise.all(n)}return i;function a(t){return function(e){let n;n=e&&e.data?e.data:e,i.working[t]=!1,i.pendingDeferreds[t].resolve(n),i.processWorks()}}}(t.wasm,t.singleThread),i={};return i.q=tr(t.wasm.q),i.r=tr(t.wasm.r),i.name=t.name,i.tm=e,i.prePSize=t.wasm.prePSize,i.preQSize=t.wasm.preQSize,i.Fr=new cs(e,"frm",t.n8r,t.r),i.F1=new cs(e,"f1m",t.n8q,t.q),i.F2=new ls(e,"f2m",i.F1),i.G1=new ds(e,"g1m",i.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),i.G2=new ds(e,"g2m",i.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),i.F6=new us(e,"f6m",i.F2),i.F12=new ls(e,"ftm",i.F6),i.Gt=i.F12,ms(i,"G1"),ms(i,"G2"),ms(i,"Fr"),ws(i,"G1"),ws(i,"G2"),bs(i,"G1"),bs(i,"G2"),bs(i,"Fr"),function(t){const e=t.tm;t.pairing=function(i,n){e.startSyncOp();const a=e.allocBuff(t.G1.toJacobian(i)),o=e.allocBuff(t.G2.toJacobian(n)),r=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](a,o,r);const s=e.getBuff(r,t.Gt.n8);return e.endSyncOp(),s},t.pairingEq=async function(){let i,n;arguments.length%2==1?(i=arguments[arguments.length-1],n=(arguments.length-1)/2):(i=t.Gt.one,n=arguments.length/2);const a=[];for(let i=0;i<n;i++){const n=[],o=t.G1.toJacobian(arguments[2*i]);n.push({cmd:"ALLOCSET",var:0,buff:o}),n.push({cmd:"ALLOC",var:1,len:t.prePSize});const r=t.G2.toJacobian(arguments[2*i+1]);n.push({cmd:"ALLOCSET",var:2,buff:r}),n.push({cmd:"ALLOC",var:3,len:t.preQSize}),n.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),n.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),n.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),n.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),n.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),a.push(e.queueAction(n))}const o=await Promise.all(a);e.startSyncOp();const r=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(r);for(let t=0;t<o.length;t++){const i=e.allocBuff(o[t][0]);e.instance.exports.ftm_mul(r,i,r)}e.instance.exports[t.name+"_finalExponentiation"](r,r);const s=e.allocBuff(i),c=!!e.instance.exports.ftm_eq(r,s);return e.endSyncOp(),c},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,i);const n=this.tm.getBuff(i,this.prePSize);return this.tm.endSyncOp(),n},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,i);const n=this.tm.getBuff(i,this.preQSize);return this.tm.endSyncOp(),n},t.millerLoop=function(t,e){this.tm.startSyncOp();const i=this.tm.allocBuff(t),n=this.tm.allocBuff(e),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](i,n,a);const o=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),o},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,i);const n=this.tm.getBuff(i,this.Gt.n8);return this.tm.endSyncOp(),n}}(i),i.array2buffer=function(t,e){const i=new Uint8Array(e*t.length);for(let n=0;n<t.length;n++)i.set(t[n],n*e);return i},i.buffer2array=function(t,e){const i=t.byteLength/e,n=new Array(i);for(let a=0;a<i;a++)n[a]=t.slice(a*e,a*e+e);return n},i}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;const As=tr("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Is=tr("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function Cs(t,e,i){let n;if(Cr(t,Is))n=await async function(t,e){const i=new je;i.setMemory(25),$t(i),e&&e(i);const n={};if(n.code=i.build(),n.pq=i.modules.f1m.pq,n.pr=i.modules.frm.pq,n.pG1gen=i.modules.bn128.pG1gen,n.pG1zero=i.modules.bn128.pG1zero,n.pG1b=i.modules.bn128.pG1b,n.pG2gen=i.modules.bn128.pG2gen,n.pG2zero=i.modules.bn128.pG2zero,n.pG2b=i.modules.bn128.pG2b,n.pOneT=i.modules.bn128.pOneT,n.prePSize=i.modules.bn128.prePSize,n.preQSize=i.modules.bn128.preQSize,n.n8q=32,n.n8r=32,n.q=i.modules.bn128.q,n.r=i.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const a={name:"bn128",wasm:n,q:tr("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:tr("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:tr("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},o=await ys(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=o),o}(e,i);else{if(!Cr(t,As))throw new Error(`Curve not supported: ${Zo(t)}`);n=await async function(t,e){const i=new je;i.setMemory(25),Ht(i),e&&e(i);const n={};if(n.code=i.build(),n.pq=i.modules.f1m.pq,n.pr=i.modules.frm.pq,n.pG1gen=i.modules.bls12381.pG1gen,n.pG1zero=i.modules.bls12381.pG1zero,n.pG1b=i.modules.bls12381.pG1b,n.pG2gen=i.modules.bls12381.pG2gen,n.pG2zero=i.modules.bls12381.pG2zero,n.pG2b=i.modules.bls12381.pG2b,n.pOneT=i.modules.bls12381.pOneT,n.prePSize=i.modules.bls12381.prePSize,n.preQSize=i.modules.bls12381.preQSize,n.n8q=48,n.n8r=32,n.q=i.modules.bn128.q,n.r=i.modules.bn128.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const a={name:"bls12381",wasm:n,q:tr("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:tr("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:tr("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:tr("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},o=await ys(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=o),o}(e,i)}return n}tr("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),tr("21888242871839275222246405745257275088696311157297823662689037894645226208583");const vs=262144,Fs={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,i){return isNaN(e)?(t[e]=i,!0):t.setElement(e,i)}};class xs{constructor(t){this.length=t||0,this.arr=new Array(vs);for(let e=0;e<t;e+=vs)this.arr[e/vs]=new Array(Math.min(vs,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const i=new Array(e-t);for(let n=t;n<e;n++)i[n-t]=this.getElement(n);return i}getElement(t){t=parseInt(t);const e=Math.floor(t/vs),i=t%vs;return this.arr[e]?this.arr[e][i]:void 0}setElement(t,e){t=parseInt(t);const i=Math.floor(t/vs);this.arr[i]||(this.arr[i]=new Array(vs));const n=t%vs;return this.arr[i][n]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new Bs;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let i=0;i<this.arr[e].length;i++)void 0!==this.arr[e][i]&&t.push(e*vs+i);return t}}class Bs{constructor(t){const e=new xs(t);return new Proxy(e,Fs)}}async function Es(t,e,i){const n={};return await pi(t,e,1),n.n8=await t.readULE32(),n.prime=await Li(t,n.n8),n.curve=await Cs(n.prime,i),n.nVars=await t.readULE32(),n.nOutputs=await t.readULE32(),n.nPubInputs=await t.readULE32(),n.nPrvInputs=await t.readULE32(),n.nLabels=await t.readULE64(),n.nConstraints=await t.readULE32(),await _i(t),n}async function Ss(t,e,i,n,a,o){const{fd:r,sections:s}=await di(t,"r1cs",1),c=await Es(r,s,n);return e&&(c.constraints=await async function(t,e,i,n,a){const o=await bi(t,e,2);let r,s=0;r=i.nConstraints>1<<20?new Bs:[];for(let t=0;t<i.nConstraints;t++){n&&t%1e5==0&&n.info(`${a}: Loading constraints: ${t}/${i.nConstraints}`);const e=c();r.push(e)}return r;function c(){const t=[];return t[0]=l(),t[1]=l(),t[2]=l(),t}function l(){const t={},e=o.slice(s,s+4);s+=4;const n=new DataView(e.buffer).getUint32(0,!0),a=o.slice(s,s+(4+i.n8)*n);s+=(4+i.n8)*n;const r=new DataView(a.buffer);for(let e=0;e<n;e++){const n=r.getUint32(e*(4+i.n8),!0),o=i.curve.Fr.fromRprLE(a,e*(4+i.n8)+4);t[n]=o}return t}}(r,s,c,a,o)),i&&(c.map=await async function(t,e,i,n,a){const o=await bi(t,e,3);let r,s=0;r=i.nVars>1<<20?new Bs:[];for(let t=0;t<i.nVars;t++){n&&t%1e4==0&&n.info(`${a}: Loading map: ${t}/${i.nVars}`);const e=c();r.push(e)}return r;function c(){const t=o.slice(s,s+8);s+=8;const e=new DataView(t.buffer),i=e.getUint32(0,!0);return 4294967296*e.getUint32(4,!0)+i}}(r,s,c,a,o)),await r.close(),c}const Os=$e.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),qs=$e.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");function Gs(t,e){if(e instanceof Uint8Array)return t.toString(e);if(Array.isArray(e))return e.map(Gs.bind(null,t));if("object"==typeof e){const i={};return Object.keys(e).forEach((n=>{i[n]=Gs(t,e[n])})),i}return"bigint"==typeof e||void 0!==e.eq?e.toString(10):e}var Us=Object.freeze({__proto__:null,print:function(t,e,i){for(let e=0;e<t.constraints.length;e++)n(t.constraints[e]);function n(n){const a=i=>{let n="";return Object.keys(i).forEach((a=>{let o=e.varIdx2Name[a];"one"==o&&(o="");let r=t.curve.Fr.toString(i[a]);"1"==r&&(r=""),"-1"==r&&(r="-"),""!=n&&"-"!=r[0]&&(r="+"+r),""!=n&&(r=" "+r),n=n+r+o})),n},o=`[ ${a(n[0])} ] * [ ${a(n[1])} ] - [ ${a(n[2])} ] = 0`;i&&i.info(o)}},info:async function(t,e){const i=await Ss(t);return $e.eq(i.prime,qs)?e&&e.info("Curve: bn-128"):$e.eq(i.prime,Os)?e&&e.info("Curve: bls12-381"):e&&e.info(`Unknown Curve. Prime: ${$e.toString(i.prime)}`),e&&e.info(`# of Wires: ${i.nVars}`),e&&e.info(`# of Constraints: ${i.nConstraints}`),e&&e.info(`# of Private Inputs: ${i.nPrvInputs}`),e&&e.info(`# of Public Inputs: ${i.nPubInputs}`),e&&e.info(`# of Labels: ${i.nLabels}`),e&&e.info(`# of Outputs: ${i.nOutputs}`),i},exportJson:async function(t,e){const i=await Ss(t,!0,!0,!0,e),n=i.curve.Fr;return delete i.curve,Gs(n,i)}});async function zs(t){const e={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},i=await ui(t),n=await i.read(i.totalSize),a=new TextDecoder("utf-8").decode(n).split("\n");for(let t=0;t<a.length;t++){const i=a[t].split(",");4==i.length&&(e.varIdx2Name[i[1]]?e.varIdx2Name[i[1]]+="|"+i[3]:e.varIdx2Name[i[1]]=i[3],e.labelIdx2Name[i[0]]=i[3],e.componentIdx2Name[i[2]]||(e.componentIdx2Name[i[2]]=o(i[3])))}return await i.close(),e;function o(t){const e=t.split(".");return e.pop(),e.join(".")}}const{unstringifyBigInts:Ps}=He;var Ms=Object.freeze({__proto__:null,calculate:io,debug:async function(t,e,i,n,a,o){const r=Ps(t),s=await ui(e),c=await s.read(s.totalSize);await s.close();let l={sanityCheck:!0},u=await zs(n);a.set&&(u||(u=await zs(n)),l.logSetSignal=function(t,e){o&&o.info("SET "+u.labelIdx2Name[t]+" <-- "+e.toString())}),a.get&&(u||(u=await zs(n)),l.logGetSignal=function(t,e){o&&o.info("GET "+u.labelIdx2Name[t]+" --\x3e "+e.toString())}),a.trigger&&(u||(u=await zs(n)),l.logStartComponent=function(t){o&&o.info("START: "+u.componentIdx2Name[t])},l.logFinishComponent=function(t){o&&o.info("FINISH: "+u.componentIdx2Name[t])}),l.sym=u;const d=await Wa(c,l),f=await d.calculateWitness(r),h=await fi(i,"wtns",2,2);await async function(t,e,i){await hi(t,1);const n=8*(Math.floor(($e.bitLength(i)-1)/64)+1);await t.writeULE32(n),await mi(t,i,n),await t.writeULE32(e.length),await gi(t),await hi(t,2);for(let i=0;i<e.length;i++)await mi(t,e[i],n);await gi(t)}(h,f,d.prime),await h.close()},exportJson:async function(t){return await async function(t){const{fd:e,sections:i}=await di(t,"wtns",2),{n8:n,nWitness:a}=await In(e,i);await pi(e,i,2);const o=[];for(let t=0;t<a;t++){const t=await Li(e,n);o.push(t)}return await _i(e),await e.close(),o}(t)}});const Qs=262144,Ts={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,i){return isNaN(e)?(t[e]=i,!0):t.setElement(e,i)}};class Rs{constructor(t){this.length=t||0,this.arr=new Array(Qs);for(let e=0;e<t;e+=Qs)this.arr[e/Qs]=new Array(Math.min(Qs,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const i=new Array(e-t);for(let n=t;n<e;n++)i[n-t]=this.getElement(n);return i}getElement(t){t=parseInt(t);const e=Math.floor(t/Qs),i=t%Qs;return this.arr[e]?this.arr[e][i]:void 0}setElement(t,e){t=parseInt(t);const i=Math.floor(t/Qs);this.arr[i]||(this.arr[i]=new Array(Qs));const n=t%Qs;return this.arr[i][n]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new ks;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let i=0;i<this.arr[e].length;i++)void 0!==this.arr[e][i]&&t.push(e*Qs+i);return t}}class ks{constructor(t){const e=new Rs(t);return new Proxy(e,Ts)}}async function Ns(t,e,i,n){await tn.ready();const a=tn(64),{fd:o,sections:r}=await di(e,"ptau",1),{curve:s,power:c}=await go(o,r),{fd:l,sections:u}=await di(t,"r1cs",1),d=await Es(l,u,!1),f=await fi(i,"zkey",1,10,1<<22,1<<24),h=2*s.G1.F.n8,g=2*s.G2.F.n8;if(d.prime!=s.r)return n&&n.error("r1cs curve does not match powers of tau ceremony curve"),-1;const p=en(d.nConstraints+d.nPubInputs+d.nOutputs+1-1)+1;if(p>c)return n&&n.error(`circuit too big for this power of tau ceremony. ${d.nConstraints}*2 > 2**${c}`),-1;if(!r[12])return n&&n.error("Powers of tau is not prepared."),-1;const _=d.nOutputs+d.nPubInputs,m=2**p;await hi(f,1),await f.writeULE32(1),await gi(f),await hi(f,2);const L=s.q,w=8*(Math.floor(($e.bitLength(L)-1)/64)+1),b=s.r,y=8*(Math.floor(($e.bitLength(b)-1)/64)+1),A=$e.mod($e.shl(1,8*y),b),I=s.Fr.e($e.mod($e.mul(A,A),b));let C,v,F;await f.writeULE32(w),await mi(f,L,w),await f.writeULE32(y),await mi(f,b,y),await f.writeULE32(d.nVars),await f.writeULE32(_),await f.writeULE32(m),C=await o.read(h,r[4][0].p),await f.write(C),C=await s.G1.batchLEMtoU(C),a.update(C),v=await o.read(h,r[5][0].p),await f.write(v),v=await s.G1.batchLEMtoU(v),a.update(v),F=await o.read(g,r[6][0].p),await f.write(F),F=await s.G2.batchLEMtoU(F),a.update(F);const x=new Uint8Array(h);s.G1.toRprLEM(x,0,s.G1.g);const B=new Uint8Array(g);s.G2.toRprLEM(B,0,s.G2.g);const E=new Uint8Array(h);s.G1.toRprUncompressed(E,0,s.G1.g);const S=new Uint8Array(g);s.G2.toRprUncompressed(S,0,s.G2.g),await f.write(B),await f.write(x),await f.write(B),a.update(S),a.update(E),a.update(S),await gi(f),n&&n.info("Reading r1cs");let O=await bi(l,u,2);const q=new ks(d.nVars),G=new ks(d.nVars),U=new ks(d.nVars),z=new ks(d.nVars-_-1),P=new Array(_+1);n&&n.info("Reading tauG1");let M=await bi(o,r,12,(m-1)*h,m*h);n&&n.info("Reading tauG2");let Q=await bi(o,r,13,(m-1)*g,m*g);n&&n.info("Reading alphatauG1");let T=await bi(o,r,14,(m-1)*h,m*h);n&&n.info("Reading betatauG1");let R=await bi(o,r,15,(m-1)*h,m*h);await async function(){const t=new Uint8Array(12+s.Fr.n8),e=new DataView(t.buffer),i=new Uint8Array(s.Fr.n8);s.Fr.toRprLE(i,0,s.Fr.e(1));let a=0;function o(){const t=O.slice(a,a+4);a+=4;return new DataView(t.buffer).getUint32(0,!0)}const r=new ks;for(let t=0;t<d.nConstraints;t++){n&&t%1e4==0&&n.debug(`processing constraints: ${t}/${d.nConstraints}`);const e=o();for(let i=0;i<e;i++){const e=o(),i=a;a+=s.Fr.n8;const n=0,c=h*t,l=3,u=h*t;void 0===q[e]&&(q[e]=[]),q[e].push([n,c,i]),e<=_?(void 0===P[e]&&(P[e]=[]),P[e].push([l,u,i])):(void 0===z[e-_-1]&&(z[e-_-1]=[]),z[e-_-1].push([l,u,i])),r.push([0,t,e,i])}const i=o();for(let e=0;e<i;e++){const e=o(),i=a;a+=s.Fr.n8;const n=0,c=h*t,l=1,u=g*t,d=2,f=h*t;void 0===G[e]&&(G[e]=[]),G[e].push([n,c,i]),void 0===U[e]&&(U[e]=[]),U[e].push([l,u,i]),e<=_?(void 0===P[e]&&(P[e]=[]),P[e].push([d,f,i])):(void 0===z[e-_-1]&&(z[e-_-1]=[]),z[e-_-1].push([d,f,i])),r.push([1,t,e,i])}const c=o();for(let e=0;e<c;e++){const e=o(),i=a;a+=s.Fr.n8;const n=0,r=h*t;e<=_?(void 0===P[e]&&(P[e]=[]),P[e].push([n,r,i])):(void 0===z[e-_-1]&&(z[e-_-1]=[]),z[e-_-1].push([n,r,i]))}}for(let t=0;t<=_;t++){const e=0,i=h*(d.nConstraints+t),n=3,a=h*(d.nConstraints+t);void 0===q[t]&&(q[t]=[]),q[t].push([e,i,-1]),void 0===P[t]&&(P[t]=[]),P[t].push([n,a,-1]),r.push([0,d.nConstraints+t,t,-1])}await hi(f,4);const c=new pe(r.length*(12+s.Fr.n8)+4),l=new Uint8Array(4);new DataView(l.buffer).setUint32(0,r.length,!0),c.set(l);let u=4;for(let t=0;t<r.length;t++)n&&t%1e5==0&&n.debug(`writing coeffs: ${t}/${r.length}`),p(r[t]);function p(n){let a;e.setUint32(0,n[0],!0),e.setUint32(4,n[1],!0),e.setUint32(8,n[2],!0),a=n[3]>=0?s.Fr.fromRprLE(O.slice(n[3],n[3]+s.Fr.n8),0):s.Fr.fromRprLE(i,0);const o=s.Fr.mul(a,I);s.Fr.toRprLE(t,12,o),c.set(t,u),u+=t.length}await f.write(c),await gi(f)}(),await N(3,"G1",P,"IC"),await async function(){await hi(f,9);const t=new pe(m*h);if(p<s.Fr.s){let e=await bi(o,r,12,(2*m-1)*h,2*m*h);for(let i=0;i<m;i++){n&&i%1e4==0&&n.debug(`spliting buffer: ${i}/${m}`);const a=e.slice((2*i+1)*h,(2*i+1)*h+h);t.set(a,i*h)}}else{if(p!=s.Fr.s)throw n&&n.error("Circuit too big"),new Error("Circuit too big for this curve");{const e=r[12][0].p+(2**(p+1)-1)*h;await o.readToBuffer(t,0,m*h,e+m*h)}}await f.write(t),await gi(f)}(),await async function(){K(m-1);for(let t=0;t<m-1;t+=16384){n&&n.debug(`HashingHPoints: ${t}/${m}`);const e=Math.min(m-1,16384);await j(t,e)}}(),await N(8,"G1",z,"C"),await N(5,"G1",q,"A"),await N(6,"G1",G,"B1"),await N(7,"G2",U,"B2");const k=a.digest();return await hi(f,10),await f.write(k),await f.writeULE32(0),await gi(f),n&&n.info(nn(k,"Circuit hash: ")),await f.close(),await l.close(),await o.close(),k;async function N(t,e,i,o){const r=s[e];K(i.length),await hi(f,t);let c=[],l=0;for(;l<i.length;){let t=0;for(;l<i.length&&t<s.tm.concurrency;){n&&n.debug(`Writing points start ${o}: ${l}/${i.length}`);let a=1,r=i[l]?i[l].length:0;for(;l+a<i.length&&r+(i[l+a]?i[l+a].length:0)<32768&&a<32768;)r+=i[l+a]?i[l+a].length:0,a++;const s=i.slice(l,l+a),u=l;c.push(D(e,s,n,o).then((t=>(n&&n.debug(`Writing points end ${o}: ${u}/${i.length}`),t)))),l+=a,t++}const u=await Promise.all(c);for(let t=0;t<u.length;t++){await f.write(u[t][0]);const e=await r.batchLEMtoU(u[t][0]);a.update(e)}c=[]}await gi(f)}async function D(t,e,i,n){const a=s[t],o=2*a.F.n8,r=3*a.F.n8,c=2*a.F.n8;let l,u,d,f;if("G1"==t)l="g1m_timesScalarAffine",u="g1m_multiexpAffine",d="g1m_batchToAffine",f="g1m_zero";else{if("G2"!=t)throw new Error("Invalid group");l="g2m_timesScalarAffine",u="g2m_multiexpAffine",d="g2m_batchToAffine",f="g2m_zero"}let h,g,p=0;for(let t=0;t<e.length;t++)p+=e[t]?e[t].length:0;p>32768?(h=new pe(p*o),g=new pe(p*s.Fr.n8)):(h=new Uint8Array(p*o),g=new Uint8Array(p*s.Fr.n8));let _=0,m=0;const L=[M,Q,T,R],w=new Uint8Array(s.Fr.n8);s.Fr.toRprLE(w,0,s.Fr.e(1));let b=0;for(let t=0;t<e.length;t++)if(e[t])for(let a=0;a<e[t].length;a++)i&&a&&a%1e4==0&&i.debug(`Configuring big array ${n}: ${a}/${e[t].length}`),h.set(L[e[t][a][0]].slice(e[t][a][1],e[t][a][1]+o),b*o),e[t][a][2]>=0?g.set(O.slice(e[t][a][2],e[t][a][2]+s.Fr.n8),b*s.Fr.n8):g.set(w,b*s.Fr.n8),b++;if(e.length>1){const t=[];t.push({cmd:"ALLOCSET",var:0,buff:h}),t.push({cmd:"ALLOCSET",var:1,buff:g}),t.push({cmd:"ALLOC",var:2,len:e.length*r}),_=0,m=0;let i=0;for(let n=0;n<e.length;n++)e[n]?(1==e[n].length?t.push({cmd:"CALL",fnName:l,params:[{var:0,offset:_},{var:1,offset:m},{val:s.Fr.n8},{var:2,offset:i}]}):t.push({cmd:"CALL",fnName:u,params:[{var:0,offset:_},{var:1,offset:m},{val:s.Fr.n8},{val:e[n].length},{var:2,offset:i}]}),_+=o*e[n].length,m+=s.Fr.n8*e[n].length,i+=r):(t.push({cmd:"CALL",fnName:f,params:[{var:2,offset:i}]}),i+=r);t.push({cmd:"CALL",fnName:d,params:[{var:2},{val:e.length},{var:2}]}),t.push({cmd:"GET",out:0,var:2,len:e.length*c});return await s.tm.queueAction(t)}{let t=await a.multiExpAffine(h,g,i,n);return t=[a.toAffine(t)],t}}async function j(t,e){const i=await o.read(e*h,r[2][0].p+(t+m)*h),n=await o.read(e*h,r[2][0].p+t*h),c=s.tm.concurrency,l=Math.floor(e/c),u=[];for(let t=0;t<c;t++){let a;if(a=t<c-1?l:e-t*l,0==a)continue;const o=i.slice(t*l*h,(t*l+a)*h),r=n.slice(t*l*h,(t*l+a)*h);u.push(V(o,r))}const d=await Promise.all(u);for(let t=0;t<d.length;t++)a.update(d[t][0])}async function V(t,e){const i=t.byteLength/h,n=3*s.G1.F.n8,a=[];a.push({cmd:"ALLOCSET",var:0,buff:t}),a.push({cmd:"ALLOCSET",var:1,buff:e}),a.push({cmd:"ALLOC",var:2,len:i*n});for(let t=0;t<i;t++)a.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*h},{var:1,offset:t*h},{var:2,offset:t*n}]});a.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:i},{var:2}]}),a.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:i},{var:2}]}),a.push({cmd:"GET",out:0,var:2,len:i*h});return await s.tm.queueAction(a)}function K(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),a.update(e)}}const Ds=rn;async function js(t,e,i,n){let a;await tn.ready();const{fd:o,sections:r}=await di(i,"zkey",2),s=await _n(o,r,!1);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const c=await Ci(s.q),l=2*c.G1.F.n8,u=await Ln(o,c,r),d=tn(64);d.update(u.csHash);let f=c.G1.g;for(let t=0;t<u.contributions.length;t++){const e=u.contributions[t],i=on(d);if(yn(i,c,e.delta.g1_s),yn(i,c,e.delta.g1_sx),!an(i.digest(),e.transcript))return console.log(`INVALID(${t}): Inconsistent transcript `),!1;const n=co(c,e.transcript);if(a=await Ds(c,e.delta.g1_s,e.delta.g1_sx,n,e.delta.g2_spx),!0!==a)return console.log(`INVALID(${t}): public key G1 and G2 do not have the same ration `),!1;if(a=await Ds(c,f,e.deltaAfter,n,e.delta.g2_spx),!0!==a)return console.log(`INVALID(${t}): deltaAfter does not fillow the public key `),!1;if(1==e.type){const i=cn(e.beaconHash,e.numIterationsExp),n=c.Fr.fromRng(i),a=c.G1.toAffine(c.G1.fromRng(i)),o=c.G1.toAffine(c.G1.timesFr(a,n));if(!0!==c.G1.eq(a,e.delta.g1_s))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_s `),!1;if(!0!==c.G1.eq(o,e.delta.g1_sx))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_sx `),!1}An(d,c,e);const o=tn(64);An(o,c,e),e.contributionHash=o.digest(),f=e.deltaAfter}const{fd:h,sections:g}=await di(t,"zkey",2),p=await _n(h,g,!1);if("groth16"!=p.protocol)throw new Error("zkeyinit file is not groth16");if(!$e.eq(p.q,s.q)||!$e.eq(p.r,s.r)||p.n8q!=s.n8q||p.n8r!=s.n8r)return n&&n.error("INVALID:  Different curves"),!1;if(p.nVars!=s.nVars||p.nPublic!=s.nPublic||p.domainSize!=s.domainSize)return n&&n.error("INVALID:  Different circuit parameters"),!1;if(!c.G1.eq(s.vk_alpha_1,p.vk_alpha_1))return n&&n.error("INVALID:  Invalid alpha1"),!1;if(!c.G1.eq(s.vk_beta_1,p.vk_beta_1))return n&&n.error("INVALID:  Invalid beta1"),!1;if(!c.G2.eq(s.vk_beta_2,p.vk_beta_2))return n&&n.error("INVALID:  Invalid beta2"),!1;if(!c.G2.eq(s.vk_gamma_2,p.vk_gamma_2))return n&&n.error("INVALID:  Invalid gamma2"),!1;if(!c.G1.eq(s.vk_delta_1,f))return n&&n.error("INVALID:  Invalid delta1"),!1;if(a=await Ds(c,c.G1.g,f,c.G2.g,s.vk_delta_2),!0!==a)return n&&n.error("INVALID:  Invalid delta2"),!1;const _=await Ln(h,c,g);if(!an(u.csHash,_.csHash))return n&&n.error("INVALID:  Circuit does not match"),!1;if(r[8][0].size!=l*(s.nVars-s.nPublic-1))return n&&n.error("INVALID:  Invalid L section size"),!1;if(r[9][0].size!=l*s.domainSize)return n&&n.error("INVALID:  Invalid H section size"),!1;let m;if(m=await yi(o,r,h,g,3),!m)return n&&n.error("INVALID:  IC section is not identical"),!1;if(m=await yi(o,r,h,g,4),!m)return n&&n.error("Coeffs section is not identical"),!1;if(m=await yi(o,r,h,g,5),!m)return n&&n.error("A section is not identical"),!1;if(m=await yi(o,r,h,g,6),!m)return n&&n.error("B1 section is not identical"),!1;if(m=await yi(o,r,h,g,7),!m)return n&&n.error("B2 section is not identical"),!1;if(a=await async function(t,e,i,o,r,s,l,u,d){const f=1<<20,h=c[t],g=2*h.F.n8;await pi(e,i,s),await pi(o,r,s);let p=h.zero,_=h.zero;const m=i[s][0].size/g;for(let t=0;t<m;t+=f){n&&n.debug(`Same ratio check ${d}:  ${t}/${m}`);const i=Math.min(m-t,f),a=await e.read(i*g),r=await o.read(i*g),s=new Uint8Array(4*i);mt.randomFillSync(s);const c=await h.multiExpAffine(a,s),l=await h.multiExpAffine(r,s);p=h.add(p,c),_=h.add(_,l)}return await _i(e),await _i(o),0==m||(a=await Ds(c,p,_,l,u),!0===a)}("G1",h,g,o,r,8,s.vk_delta_2,p.vk_delta_2,"L section"),!0!==a)return n&&n.error("L section does not match"),!1;if(a=await async function(){const t=1<<20,i=c.G1,l=c.Fr,u=2*i.F.n8,{fd:d,sections:f}=await di(e,"ptau",1);let h=new pe(s.domainSize*s.n8r);const g=new Array(8);for(let t=0;t<8;t++)g[t]=mt.randomBytes(4).readUInt32BE(0,!0);const _=new _t(g);for(let t=0;t<s.domainSize-1;t++){const e=l.fromRng(_);l.toRprLE(h,t*s.n8r,e)}l.toRprLE(h,(s.domainSize-1)*s.n8r,l.zero);let m,w=i.zero;for(let e=0;e<s.domainSize;e+=t){n&&n.debug(`H Verificaition(tau):  ${e}/${s.domainSize}`);const a=Math.min(s.domainSize-e,t),o=await d.read(u*a,f[2][0].p+s.domainSize*u+e*u),r=await d.read(u*a,f[2][0].p+e*u),c=await L(o,r),l=h.slice(e*s.n8r,(e+a)*s.n8r),g=await i.multiExpAffine(c,l);w=i.add(w,g)}if(h=await l.batchToMontgomery(h),s.power<l.s)m=l.neg(l.e(2));else{const t=2**l.s,e=l.exp(l.shift,t);m=l.sub(e,l.one)}const b=s.power<l.s?l.w[s.power+1]:l.shift;h=await l.batchApplyKey(h,m,b),h=await l.fft(h),h=await l.batchFromMontgomery(h),await pi(o,r,9);let y=i.zero;for(let e=0;e<s.domainSize;e+=t){n&&n.debug(`H Verificaition(lagrange):  ${e}/${s.domainSize}`);const a=Math.min(s.domainSize-e,t),r=await o.read(u*a),c=h.slice(e*s.n8r,(e+a)*s.n8r),l=await i.multiExpAffine(r,c);y=i.add(y,l)}return await _i(o),a=await Ds(c,w,y,s.vk_delta_2,p.vk_delta_2),!0===a}(),!0!==a)return n&&n.error("H section does not match"),!1;n&&n.info(nn(u.csHash,"Circuit Hash: ")),await o.close(),await h.close();for(let t=u.contributions.length-1;t>=0;t--){const e=u.contributions[t];n&&n.info("-------------------------"),n&&n.info(nn(e.contributionHash,`contribution #${t+1} ${e.name?e.name:""}:`)),1==e.type&&(n&&n.info(`Beacon generator: ${un(e.beaconHash)}`),n&&n.info(`Beacon iterations Exp: ${e.numIterationsExp}`))}return n&&n.info("-------------------------"),n&&n.info("ZKey Ok!"),!0;async function L(t,e){const i=2*c.G1.F.n8,n=t.byteLength/i,a=c.tm.concurrency,o=Math.floor(n/a),r=[];for(let i=0;i<a;i++){let s;if(s=i<a-1?o:n-i*o,0==s)continue;const c=t.slice(i*o*l,(i*o+s)*l),u=e.slice(i*o*l,(i*o+s)*l);r.push(w(c,u))}const s=await Promise.all(r),u=new Uint8Array(n*i);let d=0;for(let t=0;t<s.length;t++)u.set(s[t][0],d),d+=s[t][0].byteLength;return u}async function w(t,e){const i=2*c.G1.F.n8,n=3*c.G1.F.n8,a=t.byteLength/i,o=[];o.push({cmd:"ALLOCSET",var:0,buff:t}),o.push({cmd:"ALLOCSET",var:1,buff:e}),o.push({cmd:"ALLOC",var:2,len:a*n});for(let t=0;t<a;t++)o.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*i},{var:1,offset:t*i},{var:2,offset:t*n}]});o.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"GET",out:0,var:2,len:a*i});return await c.tm.queueAction(o)}}const{stringifyBigInts:Vs}=He;async function Ks(t){const{fd:e,sections:i}=await di(t,"zkey",2),n=await _n(e,i);let a;if("groth16"==n.protocol)a=await async function(t,e,i){const n=await Ci(t.q),a=2*n.G1.F.n8,o=await n.pairing(t.vk_alpha_1,t.vk_beta_2);let r={protocol:t.protocol,curve:n.name,nPublic:t.nPublic,vk_alpha_1:n.G1.toObject(t.vk_alpha_1),vk_beta_2:n.G2.toObject(t.vk_beta_2),vk_gamma_2:n.G2.toObject(t.vk_gamma_2),vk_delta_2:n.G2.toObject(t.vk_delta_2),vk_alphabeta_12:n.Gt.toObject(o)};await pi(e,i,3),r.IC=[];for(let i=0;i<=t.nPublic;i++){const t=await e.read(a),i=n.G1.toObject(t);r.IC.push(i)}return await _i(e),r=Vs(r),r}(n,e,i);else{if("plonk"!=n.protocol)throw new Error("zkey file is not groth16");a=await async function(t){const e=await Ci(t.q);let i={protocol:t.protocol,curve:e.name,nPublic:t.nPublic,power:t.power,k1:e.Fr.toObject(t.k1),k2:e.Fr.toObject(t.k2),Qm:e.G1.toObject(t.Qm),Ql:e.G1.toObject(t.Ql),Qr:e.G1.toObject(t.Qr),Qo:e.G1.toObject(t.Qo),Qc:e.G1.toObject(t.Qc),S1:e.G1.toObject(t.S1),S2:e.G1.toObject(t.S2),S3:e.G1.toObject(t.S3),X_2:e.G2.toObject(t.X_2),w:e.Fr.toObject(e.Fr.w[t.power])};return i=Vs(i),i}(n)}return await e.close(),a}var $s={};var Hs=Object.freeze({__proto__:null,newZKey:Ns,exportBellman:async function(t,e,i){const{fd:n,sections:a}=await di(t,"zkey",2),o=await _n(n,a);if("groth16"!=o.protocol)throw new Error("zkey file is not groth16");const r=await Ci(o.q),s=2*r.G1.F.n8,c=2*r.G2.F.n8,l=await Ln(n,r,a),u=await li(e);let d;await L(o.vk_alpha_1),await L(o.vk_beta_1),await w(o.vk_beta_2),await w(o.vk_gamma_2),await L(o.vk_delta_1),await w(o.vk_delta_2),d=await bi(n,a,3),d=await r.G1.batchLEMtoU(d),await b("G1",d);const f=await bi(n,a,9);let h,g,p,_,m;h=await r.G1.fft(f,"affine","jacobian",i),h=await r.G1.batchApplyKey(h,r.Fr.neg(r.Fr.e(2)),r.Fr.w[o.power+1],"jacobian","affine",i),h=h.slice(0,h.byteLength-s),h=await r.G1.batchLEMtoU(h),await b("G1",h),g=await bi(n,a,8),g=await r.G1.batchLEMtoU(g),await b("G1",g),p=await bi(n,a,5),p=await r.G1.batchLEMtoU(p),await b("G1",p),_=await bi(n,a,6),_=await r.G1.batchLEMtoU(_),await b("G1",_),m=await bi(n,a,7),m=await r.G2.batchLEMtoU(m),await b("G2",m),await u.write(l.csHash),await async function(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),await u.write(e)}(l.contributions.length);for(let t=0;t<l.contributions.length;t++){const e=l.contributions[t];await L(e.deltaAfter),await L(e.delta.g1_s),await L(e.delta.g1_sx),await w(e.delta.g2_spx),await u.write(e.transcript)}async function L(t){const e=new Uint8Array(s);r.G1.toRprUncompressed(e,0,t),await u.write(e)}async function w(t){const e=new Uint8Array(c);r.G2.toRprUncompressed(e,0,t),await u.write(e)}async function b(t,e){let i;i="G1"==t?s:c;const n=new Uint8Array(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,e.byteLength/i,!1),await u.write(n),await u.write(e)}await n.close(),await u.close()},importBellman:async function(t,e,i,n,a){const{fd:o,sections:r}=await di(t,"zkey",2),s=await _n(o,r,!1);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const c=await Ci(s.q),l=2*c.G1.F.n8,u=2*c.G2.F.n8,d=await Ln(o,c,r),f={},h=await ui(e);h.pos=3*l+3*u+8+l*s.nVars+4+l*(s.domainSize-1)+4+l*s.nVars+4+l*s.nVars+4+u*s.nVars,f.csHash=await h.read(64);const g=await h.readUBE32();f.contributions=[];for(let t=0;t<g;t++){const e={delta:{}};e.deltaAfter=await A(h),e.delta.g1_s=await A(h),e.delta.g1_sx=await A(h),e.delta.g2_spx=await I(h),e.transcript=await h.read(64),t<d.contributions.length&&(e.type=d.contributions[t].type,1==e.type&&(e.beaconHash=d.contributions[t].beaconHash,e.numIterationsExp=d.contributions[t].numIterationsExp),d.contributions[t].name&&(e.name=d.contributions[t].name)),f.contributions.push(e)}if(!an(f.csHash,d.csHash))return a&&a.error("Hash of the original circuit does not match with the MPC one"),!1;if(d.contributions.length>f.contributions.length)return a&&a.error("The impoerted file does not include new contributions"),!1;for(let t=0;t<d.contributions.length;t++)if(!C(d.contributions[t],f.contributions[t]))return a&&a.error(`Previos contribution ${t} does not match`),!1;if(n)for(let t=d.contributions.length;t<f.contributions.length;t++)f.contributions[t].name=n;const p=await fi(i,"zkey",1,10);if(h.pos=0,h.pos+=l,h.pos+=l,h.pos+=u,h.pos+=u,s.vk_delta_1=await A(h),s.vk_delta_2=await I(h),await dn(p,s),await h.readUBE32()!=s.nPublic+1)return a&&a.error("Invalid number of points in IC"),await p.discard(),!1;if(h.pos+=l*(s.nPublic+1),await wi(o,r,p,3),await wi(o,r,p,4),await h.readUBE32()!=s.domainSize-1)return a&&a.error("Invalid number of points in H"),await p.discard(),!1;let _;const m=await h.read(l*(s.domainSize-1)),L=await c.G1.batchUtoLEM(m);_=new Uint8Array(s.domainSize*l),_.set(L),c.G1.toRprLEM(_,l*(s.domainSize-1),c.G1.zeroAffine);const w=c.Fr.neg(c.Fr.inv(c.Fr.e(2))),b=c.Fr.inv(c.Fr.w[s.power+1]);if(_=await c.G1.batchApplyKey(_,w,b,"affine","jacobian",a),_=await c.G1.ifft(_,"jacobian","affine",a),await hi(p,9),await p.write(_),await gi(p),await h.readUBE32()!=s.nVars-s.nPublic-1)return a&&a.error("Invalid number of points in L"),await p.discard(),!1;let y;return y=await h.read(l*(s.nVars-s.nPublic-1)),y=await c.G1.batchUtoLEM(y),await hi(p,8),await p.write(y),await gi(p),await h.readUBE32()!=s.nVars?(a&&a.error("Invalid number of points in A"),await p.discard(),!1):(h.pos+=l*s.nVars,await wi(o,r,p,5),await h.readUBE32()!=s.nVars?(a&&a.error("Invalid number of points in B1"),await p.discard(),!1):(h.pos+=l*s.nVars,await wi(o,r,p,6),await h.readUBE32()!=s.nVars?(a&&a.error("Invalid number of points in B2"),await p.discard(),!1):(h.pos+=u*s.nVars,await wi(o,r,p,7),await bn(p,c,f),await h.close(),await p.close(),await o.close(),!0)));async function A(t){const e=await t.read(2*c.G1.F.n8);return c.G1.fromRprUncompressed(e,0)}async function I(t){const e=await t.read(2*c.G2.F.n8);return c.G2.fromRprUncompressed(e,0)}function C(t,e){return!!c.G1.eq(t.deltaAfter,e.deltaAfter)&&(!!c.G1.eq(t.delta.g1_s,e.delta.g1_s)&&(!!c.G1.eq(t.delta.g1_sx,e.delta.g1_sx)&&(!!c.G2.eq(t.delta.g2_spx,e.delta.g2_spx)&&!!an(t.transcript,e.transcript))))}},verifyFromR1cs:async function(t,e,i,n){const a={type:"bigMem"};return await Ns(t,e,a,n),await js(a,e,i,n)},verifyFromInit:js,contribute:async function(t,e,i,n,a){await tn.ready();const{fd:o,sections:r}=await di(t,"zkey",2),s=await _n(o,r);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const c=await Ci(s.q),l=await Ln(o,c,r),u=await fi(e,"zkey",1,10),d=await sn(n),f=tn(64);f.update(l.csHash);for(let t=0;t<l.contributions.length;t++)An(f,c,l.contributions[t]);const h={delta:{}};h.delta.prvKey=c.Fr.fromRng(d),h.delta.g1_s=c.G1.toAffine(c.G1.fromRng(d)),h.delta.g1_sx=c.G1.toAffine(c.G1.timesFr(h.delta.g1_s,h.delta.prvKey)),yn(f,c,h.delta.g1_s),yn(f,c,h.delta.g1_sx),h.transcript=f.digest(),h.delta.g2_sp=co(c,h.transcript),h.delta.g2_spx=c.G2.toAffine(c.G2.timesFr(h.delta.g2_sp,h.delta.prvKey)),s.vk_delta_1=c.G1.timesFr(s.vk_delta_1,h.delta.prvKey),s.vk_delta_2=c.G2.timesFr(s.vk_delta_2,h.delta.prvKey),h.deltaAfter=s.vk_delta_1,h.type=0,i&&(h.name=i),l.contributions.push(h),await dn(u,s),await wi(o,r,u,3),await wi(o,r,u,4),await wi(o,r,u,5),await wi(o,r,u,6),await wi(o,r,u,7);const g=c.Fr.inv(h.delta.prvKey);await vo(o,r,u,8,c,"G1",g,c.Fr.e(1),"L Section",a),await vo(o,r,u,9,c,"G1",g,c.Fr.e(1),"H Section",a),await bn(u,c,l),await o.close(),await u.close();const p=tn(64);An(p,c,h);const _=p.digest();return a&&a.info(nn(l.csHash,"Circuit Hash: ")),a&&a.info(nn(_,"Contribution Hash: ")),_},beacon:async function(t,e,i,n,a,o){await tn.ready();const r=ln(n);if(0==r.byteLength||2*r.byteLength!=n.length)return o&&o.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(r.length>=256)return o&&o.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((a=parseInt(a))<10||a>63)return o&&o.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;const{fd:s,sections:c}=await di(t,"zkey",2),l=await _n(s,c);if("groth16"!=l.protocol)throw new Error("zkey file is not groth16");const u=await Ci(l.q),d=await Ln(s,u,c),f=await fi(e,"zkey",1,10),h=await cn(r,a),g=tn(64);g.update(d.csHash);for(let t=0;t<d.contributions.length;t++)An(g,u,d.contributions[t]);const p={delta:{}};p.delta.prvKey=u.Fr.fromRng(h),p.delta.g1_s=u.G1.toAffine(u.G1.fromRng(h)),p.delta.g1_sx=u.G1.toAffine(u.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),yn(g,u,p.delta.g1_s),yn(g,u,p.delta.g1_sx),p.transcript=g.digest(),p.delta.g2_sp=co(u,p.transcript),p.delta.g2_spx=u.G2.toAffine(u.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),l.vk_delta_1=u.G1.timesFr(l.vk_delta_1,p.delta.prvKey),l.vk_delta_2=u.G2.timesFr(l.vk_delta_2,p.delta.prvKey),p.deltaAfter=l.vk_delta_1,p.type=1,p.numIterationsExp=a,p.beaconHash=r,i&&(p.name=i),d.contributions.push(p),await dn(f,l),await wi(s,c,f,3),await wi(s,c,f,4),await wi(s,c,f,5),await wi(s,c,f,6),await wi(s,c,f,7);const _=u.Fr.inv(p.delta.prvKey);await vo(s,c,f,8,u,"G1",_,u.Fr.e(1),"L Section",o),await vo(s,c,f,9,u,"G1",_,u.Fr.e(1),"H Section",o),await bn(f,u,d),await s.close(),await f.close();const m=tn(64);An(m,u,p);const L=m.digest();return o&&o.info(nn(L,"Contribution Hash: ")),L},exportJson:async function(t){const e=await async function(t,e){const{fd:i,sections:n}=await di(t,"zkey",1),a=await _n(i,n,"groth16"),o=new Et(a.r),r=$e.mod($e.shl(1,8*a.n8r),a.r),s=o.inv(r),c=o.mul(s,s);let l=await Ci(a.q);await pi(i,n,3),a.IC=[];for(let t=0;t<=a.nPublic;t++){const t=await gn(i,l,e);a.IC.push(t)}await _i(i),await pi(i,n,4);const u=await i.readULE32();a.ccoefs=[];for(let t=0;t<u;t++){const t=await i.readULE32(),e=await i.readULE32(),n=await i.readULE32(),o=await d();a.ccoefs.push({matrix:t,constraint:e,signal:n,value:o})}await _i(i),await pi(i,n,5),a.A=[];for(let t=0;t<a.nVars;t++){const n=await gn(i,l,e);a.A[t]=n}await _i(i),await pi(i,n,6),a.B1=[];for(let t=0;t<a.nVars;t++){const n=await gn(i,l,e);a.B1[t]=n}await _i(i),await pi(i,n,7),a.B2=[];for(let t=0;t<a.nVars;t++){const n=await pn(i,l,e);a.B2[t]=n}await _i(i),await pi(i,n,8),a.C=[];for(let t=a.nPublic+1;t<a.nVars;t++){const n=await gn(i,l,e);a.C[t]=n}await _i(i),await pi(i,n,9),a.hExps=[];for(let t=0;t<a.domainSize;t++){const t=await gn(i,l,e);a.hExps.push(t)}return await _i(i),await i.close(),a;async function d(){const t=await Li(i,a.n8r);return o.mul(t,c)}}(t,!0);return e},bellmanContribute:async function(t,e,i,n,a){await tn.ready();const o=await sn(n),r=t.Fr.fromRng(o),s=t.Fr.inv(r),c=2*t.G1.F.n8,l=2*t.G2.F.n8,u=await ui(e),d=await li(i);await B(c),await B(c),await B(l),await B(l);const f=await E(),h=t.G1.timesFr(f,r);await O(h);const g=await S(),p=t.G2.timesFr(g,r);await q(p);const _=await u.readUBE32();await d.writeUBE32(_),await B(_*c);const m=await u.readUBE32();await d.writeUBE32(m),await Fo(u,d,null,t,"G1",m,s,t.Fr.e(1),"UNCOMPRESSED","H",a);const L=await u.readUBE32();await d.writeUBE32(L),await Fo(u,d,null,t,"G1",L,s,t.Fr.e(1),"UNCOMPRESSED","L",a);const w=await u.readUBE32();await d.writeUBE32(w),await B(w*c);const b=await u.readUBE32();await d.writeUBE32(b),await B(b*c);const y=await u.readUBE32();await d.writeUBE32(y),await B(y*l);const A=tn(64),I={};I.csHash=await u.read(64),A.update(I.csHash);const C=await u.readUBE32();I.contributions=[];for(let e=0;e<C;e++){const e={delta:{}};e.deltaAfter=await E(),e.delta.g1_s=await E(),e.delta.g1_sx=await E(),e.delta.g2_spx=await S(),e.transcript=await u.read(64),I.contributions.push(e),An(A,t,e)}const v={delta:{}};v.delta.prvKey=r,v.delta.g1_s=t.G1.toAffine(t.G1.fromRng(o)),v.delta.g1_sx=t.G1.toAffine(t.G1.timesFr(v.delta.g1_s,r)),yn(A,t,v.delta.g1_s),yn(A,t,v.delta.g1_sx),v.transcript=A.digest(),v.delta.g2_sp=co(t,v.transcript),v.delta.g2_spx=t.G2.toAffine(t.G2.timesFr(v.delta.g2_sp,r)),v.deltaAfter=h,v.type=0,I.contributions.push(v),await d.write(I.csHash),await d.writeUBE32(I.contributions.length);for(let t=0;t<I.contributions.length;t++){const e=I.contributions[t];await O(e.deltaAfter),await O(e.delta.g1_s),await O(e.delta.g1_sx),await q(e.delta.g2_spx),await d.write(e.transcript)}const F=tn(64);An(F,t,v);const x=F.digest();return a&&a.info(nn(x,"Contribution Hash: ")),await d.close(),await u.close(),x;async function B(t){const e=2*u.pageSize;for(let i=0;i<t;i+=e){const n=Math.min(t-i,e),a=await u.read(n);await d.write(a)}}async function E(){const e=await u.read(2*t.G1.F.n8);return t.G1.fromRprUncompressed(e,0)}async function S(){const e=await u.read(2*t.G2.F.n8);return t.G2.fromRprUncompressed(e,0)}async function O(e){const i=new Uint8Array(c);t.G1.toRprUncompressed(i,0,e),await d.write(i)}async function q(e){const i=new Uint8Array(l);t.G2.toRprUncompressed(i,0,e),await d.write(i)}},exportVerificationKey:Ks,exportSolidityVerifier:async function(t,e,i){const n=await Ks(t);let a=e[n.protocol];return $s.render(a,n)}});
/**
     * [js-sha3]{@link https://github.com/emn178/js-sha3}
     *
     * @version 0.8.0
     * @author Chen, Yi-Cyuan [emn178@gmail.com]
     * @copyright Chen, Yi-Cyuan 2015-2018
     * @license MIT
     */
var Zs=u((function(t){!function(){var e="input is invalid type",i="object"==typeof window,n=i?window:{};n.JS_SHA3_NO_WINDOW&&(i=!1);var a=!i&&"object"==typeof self;!n.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?n=l:a&&(n=self);var o=!n.JS_SHA3_NO_COMMON_JS&&t.exports,r=!n.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,s="0123456789abcdef".split(""),c=[4,1024,262144,67108864],u=[0,8,16,24],d=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],f=[224,256,384,512],h=[128,256],g=["hex","buffer","arrayBuffer","array","digest"],p={128:168,256:136};!n.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!r||!n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var _=function(t,e,i){return function(n){return new O(t,e,t).update(n)[i]()}},m=function(t,e,i){return function(n,a){return new O(t,e,a).update(n)[i]()}},L=function(t,e,i){return function(e,n,a,o){return I["cshake"+t].update(e,n,a,o)[i]()}},w=function(t,e,i){return function(e,n,a,o){return I["kmac"+t].update(e,n,a,o)[i]()}},b=function(t,e,i,n){for(var a=0;a<g.length;++a){var o=g[a];t[o]=e(i,n,o)}return t},y=function(t,e){var i=_(t,e,"hex");return i.create=function(){return new O(t,e,t)},i.update=function(t){return i.create().update(t)},b(i,_,t,e)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:f,createMethod:y},{name:"sha3",padding:[6,1536,393216,100663296],bits:f,createMethod:y},{name:"shake",padding:[31,7936,2031616,520093696],bits:h,createMethod:function(t,e){var i=m(t,e,"hex");return i.create=function(i){return new O(t,e,i)},i.update=function(t,e){return i.create(e).update(t)},b(i,m,t,e)}},{name:"cshake",padding:c,bits:h,createMethod:function(t,e){var i=p[t],n=L(t,0,"hex");return n.create=function(n,a,o){return a||o?new O(t,e,n).bytepad([a,o],i):I["shake"+t].create(n)},n.update=function(t,e,i,a){return n.create(e,i,a).update(t)},b(n,L,t,e)}},{name:"kmac",padding:c,bits:h,createMethod:function(t,e){var i=p[t],n=w(t,0,"hex");return n.create=function(n,a,o){return new q(t,e,a).bytepad(["KMAC",o],i).bytepad([n],i)},n.update=function(t,e,i,a){return n.create(t,i,a).update(e)},b(n,w,t,e)}}],I={},C=[],v=0;v<A.length;++v)for(var F=A[v],x=F.bits,B=0;B<x.length;++B){var E=F.name+"_"+x[B];if(C.push(E),I[E]=F.createMethod(x[B],F.padding),"sha3"!==F.name){var S=F.name+x[B];C.push(S),I[S]=I[E]}}function O(t,e,i){this.blocks=[],this.s=[],this.padding=e,this.outputBits=i,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=i>>5,this.extraBytes=(31&i)>>3;for(var n=0;n<50;++n)this.s[n]=0}function q(t,e,i){O.call(this,t,e,i)}O.prototype.update=function(t){if(this.finalized)throw new Error("finalize already called");var i,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(e);if(null===t)throw new Error(e);if(r&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||r&&ArrayBuffer.isView(t)))throw new Error(e);i=!0}for(var a,o,s=this.blocks,c=this.byteCount,l=t.length,d=this.blockCount,f=0,h=this.s;f<l;){if(this.reset)for(this.reset=!1,s[0]=this.block,a=1;a<d+1;++a)s[a]=0;if(i)for(a=this.start;f<l&&a<c;++f)s[a>>2]|=t[f]<<u[3&a++];else for(a=this.start;f<l&&a<c;++f)(o=t.charCodeAt(f))<128?s[a>>2]|=o<<u[3&a++]:o<2048?(s[a>>2]|=(192|o>>6)<<u[3&a++],s[a>>2]|=(128|63&o)<<u[3&a++]):o<55296||o>=57344?(s[a>>2]|=(224|o>>12)<<u[3&a++],s[a>>2]|=(128|o>>6&63)<<u[3&a++],s[a>>2]|=(128|63&o)<<u[3&a++]):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++f)),s[a>>2]|=(240|o>>18)<<u[3&a++],s[a>>2]|=(128|o>>12&63)<<u[3&a++],s[a>>2]|=(128|o>>6&63)<<u[3&a++],s[a>>2]|=(128|63&o)<<u[3&a++]);if(this.lastByteIndex=a,a>=c){for(this.start=a-c,this.block=s[d],a=0;a<d;++a)h[a]^=s[a];G(h),this.reset=!0}else this.start=a}return this},O.prototype.encode=function(t,e){var i=255&t,n=1,a=[i];for(i=255&(t>>=8);i>0;)a.unshift(i),i=255&(t>>=8),++n;return e?a.push(n):a.unshift(n),this.update(a),a.length},O.prototype.encodeString=function(t){var i,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(e);if(null===t)throw new Error(e);if(r&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||r&&ArrayBuffer.isView(t)))throw new Error(e);i=!0}var a=0,o=t.length;if(i)a=o;else for(var s=0;s<t.length;++s){var c=t.charCodeAt(s);c<128?a+=1:c<2048?a+=2:c<55296||c>=57344?a+=3:(c=65536+((1023&c)<<10|1023&t.charCodeAt(++s)),a+=4)}return a+=this.encode(8*a),this.update(t),a},O.prototype.bytepad=function(t,e){for(var i=this.encode(e),n=0;n<t.length;++n)i+=this.encodeString(t[n]);var a=e-i%e,o=[];return o.length=a,this.update(o),this},O.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,i=this.blockCount,n=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[i],e=1;e<i+1;++e)t[e]=0;for(t[i-1]|=2147483648,e=0;e<i;++e)n[e]^=t[e];G(n)}},O.prototype.toString=O.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,i=this.s,n=this.outputBlocks,a=this.extraBytes,o=0,r=0,c="";r<n;){for(o=0;o<e&&r<n;++o,++r)t=i[o],c+=s[t>>4&15]+s[15&t]+s[t>>12&15]+s[t>>8&15]+s[t>>20&15]+s[t>>16&15]+s[t>>28&15]+s[t>>24&15];r%e==0&&(G(i),o=0)}return a&&(t=i[o],c+=s[t>>4&15]+s[15&t],a>1&&(c+=s[t>>12&15]+s[t>>8&15]),a>2&&(c+=s[t>>20&15]+s[t>>16&15])),c},O.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,i=this.s,n=this.outputBlocks,a=this.extraBytes,o=0,r=0,s=this.outputBits>>3;t=a?new ArrayBuffer(n+1<<2):new ArrayBuffer(s);for(var c=new Uint32Array(t);r<n;){for(o=0;o<e&&r<n;++o,++r)c[r]=i[o];r%e==0&&G(i)}return a&&(c[o]=i[o],t=t.slice(0,s)),t},O.prototype.buffer=O.prototype.arrayBuffer,O.prototype.digest=O.prototype.array=function(){this.finalize();for(var t,e,i=this.blockCount,n=this.s,a=this.outputBlocks,o=this.extraBytes,r=0,s=0,c=[];s<a;){for(r=0;r<i&&s<a;++r,++s)t=s<<2,e=n[r],c[t]=255&e,c[t+1]=e>>8&255,c[t+2]=e>>16&255,c[t+3]=e>>24&255;s%i==0&&G(n)}return o&&(t=s<<2,e=n[r],c[t]=255&e,o>1&&(c[t+1]=e>>8&255),o>2&&(c[t+2]=e>>16&255)),c},q.prototype=new O,q.prototype.finalize=function(){return this.encode(this.outputBits,!0),O.prototype.finalize.call(this)};var G=function(t){var e,i,n,a,o,r,s,c,l,u,f,h,g,p,_,m,L,w,b,y,A,I,C,v,F,x,B,E,S,O,q,G,U,z,P,M,Q,T,R,k,N,D,j,V,K,$,H,Z,J,Y,W,X,tt,et,it,nt,at,ot,rt,st,ct,lt,ut;for(n=0;n<48;n+=2)a=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],r=t[2]^t[12]^t[22]^t[32]^t[42],s=t[3]^t[13]^t[23]^t[33]^t[43],c=t[4]^t[14]^t[24]^t[34]^t[44],l=t[5]^t[15]^t[25]^t[35]^t[45],u=t[6]^t[16]^t[26]^t[36]^t[46],f=t[7]^t[17]^t[27]^t[37]^t[47],e=(h=t[8]^t[18]^t[28]^t[38]^t[48])^(r<<1|s>>>31),i=(g=t[9]^t[19]^t[29]^t[39]^t[49])^(s<<1|r>>>31),t[0]^=e,t[1]^=i,t[10]^=e,t[11]^=i,t[20]^=e,t[21]^=i,t[30]^=e,t[31]^=i,t[40]^=e,t[41]^=i,e=a^(c<<1|l>>>31),i=o^(l<<1|c>>>31),t[2]^=e,t[3]^=i,t[12]^=e,t[13]^=i,t[22]^=e,t[23]^=i,t[32]^=e,t[33]^=i,t[42]^=e,t[43]^=i,e=r^(u<<1|f>>>31),i=s^(f<<1|u>>>31),t[4]^=e,t[5]^=i,t[14]^=e,t[15]^=i,t[24]^=e,t[25]^=i,t[34]^=e,t[35]^=i,t[44]^=e,t[45]^=i,e=c^(h<<1|g>>>31),i=l^(g<<1|h>>>31),t[6]^=e,t[7]^=i,t[16]^=e,t[17]^=i,t[26]^=e,t[27]^=i,t[36]^=e,t[37]^=i,t[46]^=e,t[47]^=i,e=u^(a<<1|o>>>31),i=f^(o<<1|a>>>31),t[8]^=e,t[9]^=i,t[18]^=e,t[19]^=i,t[28]^=e,t[29]^=i,t[38]^=e,t[39]^=i,t[48]^=e,t[49]^=i,p=t[0],_=t[1],$=t[11]<<4|t[10]>>>28,H=t[10]<<4|t[11]>>>28,E=t[20]<<3|t[21]>>>29,S=t[21]<<3|t[20]>>>29,st=t[31]<<9|t[30]>>>23,ct=t[30]<<9|t[31]>>>23,D=t[40]<<18|t[41]>>>14,j=t[41]<<18|t[40]>>>14,z=t[2]<<1|t[3]>>>31,P=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,L=t[12]<<12|t[13]>>>20,Z=t[22]<<10|t[23]>>>22,J=t[23]<<10|t[22]>>>22,O=t[33]<<13|t[32]>>>19,q=t[32]<<13|t[33]>>>19,lt=t[42]<<2|t[43]>>>30,ut=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,it=t[4]<<30|t[5]>>>2,M=t[14]<<6|t[15]>>>26,Q=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,b=t[24]<<11|t[25]>>>21,Y=t[34]<<15|t[35]>>>17,W=t[35]<<15|t[34]>>>17,G=t[45]<<29|t[44]>>>3,U=t[44]<<29|t[45]>>>3,v=t[6]<<28|t[7]>>>4,F=t[7]<<28|t[6]>>>4,nt=t[17]<<23|t[16]>>>9,at=t[16]<<23|t[17]>>>9,T=t[26]<<25|t[27]>>>7,R=t[27]<<25|t[26]>>>7,y=t[36]<<21|t[37]>>>11,A=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,V=t[8]<<27|t[9]>>>5,K=t[9]<<27|t[8]>>>5,x=t[18]<<20|t[19]>>>12,B=t[19]<<20|t[18]>>>12,ot=t[29]<<7|t[28]>>>25,rt=t[28]<<7|t[29]>>>25,k=t[38]<<8|t[39]>>>24,N=t[39]<<8|t[38]>>>24,I=t[48]<<14|t[49]>>>18,C=t[49]<<14|t[48]>>>18,t[0]=p^~m&w,t[1]=_^~L&b,t[10]=v^~x&E,t[11]=F^~B&S,t[20]=z^~M&T,t[21]=P^~Q&R,t[30]=V^~$&Z,t[31]=K^~H&J,t[40]=et^~nt&ot,t[41]=it^~at&rt,t[2]=m^~w&y,t[3]=L^~b&A,t[12]=x^~E&O,t[13]=B^~S&q,t[22]=M^~T&k,t[23]=Q^~R&N,t[32]=$^~Z&Y,t[33]=H^~J&W,t[42]=nt^~ot&st,t[43]=at^~rt&ct,t[4]=w^~y&I,t[5]=b^~A&C,t[14]=E^~O&G,t[15]=S^~q&U,t[24]=T^~k&D,t[25]=R^~N&j,t[34]=Z^~Y&X,t[35]=J^~W&tt,t[44]=ot^~st&lt,t[45]=rt^~ct&ut,t[6]=y^~I&p,t[7]=A^~C&_,t[16]=O^~G&v,t[17]=q^~U&F,t[26]=k^~D&z,t[27]=N^~j&P,t[36]=Y^~X&V,t[37]=W^~tt&K,t[46]=st^~lt&et,t[47]=ct^~ut&it,t[8]=I^~p&m,t[9]=C^~_&L,t[18]=G^~v&x,t[19]=U^~F&B,t[28]=D^~z&M,t[29]=j^~P&Q,t[38]=X^~V&$,t[39]=tt^~K&H,t[48]=lt^~et&nt,t[49]=ut^~it&at,t[0]^=d[n],t[1]^=d[n+1]};if(o)t.exports=I;else for(v=0;v<C.length;++v)n[C[v]]=I[C[v]]}()}));const{stringifyBigInts:Js}=He,{keccak256:Ys}=Zs;async function Ws(t,e,i){const{fd:n,sections:a}=await di(e,"wtns",2),o=await In(n,a),{fd:r,sections:s}=await di(t,"zkey",2),c=await _n(r,s);if("plonk"!=c.protocol)throw new Error("zkey file is not plonk");if(!$e.eq(c.r,o.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(o.nWitness!=c.nVars-c.nAdditions)throw new Error(`Invalid witness length. Circuit: ${c.nVars}, witness: ${o.nWitness}, ${c.nAdditions}`);const l=await Ci(c.q),u=l.Fr,d=l.G1,f=l.Fr.n8;i&&i.debug("Reading Wtns");const h=await bi(n,a,2);h.set(u.zero,0);const g=new pe(f*c.nAdditions);let p,_,m,L,w,b,y,A,I,C,v,F,x,B;await async function(){const t=await bi(r,s,3),e=8+2*l.Fr.n8;for(let i=0;i<c.nAdditions;i++){const n=M(t,i*e),a=M(t,i*e+4),o=t.slice(i*e+8,i*e+8+f),r=t.slice(i*e+8+f,i*e+8+2*f),s=Q(n),c=Q(a),u=l.Fr.add(l.Fr.mul(o,s),l.Fr.mul(r,c));g.set(u,f*i)}}();let E={};const S=new pe(c.domainSize*f*4*3);let O=s[12][0].p+c.domainSize*f;await r.readToBuffer(S,0,c.domainSize*f*4,O),O+=c.domainSize*f*5,await r.readToBuffer(S,c.domainSize*f*4,c.domainSize*f*4,O),O+=c.domainSize*f*5,await r.readToBuffer(S,c.domainSize*f*8,c.domainSize*f*4,O);const q=new pe(c.domainSize*f);await r.readToBuffer(q,0,c.domainSize*f,s[12][0].p);const G=new pe(c.domainSize*f);await r.readToBuffer(G,0,c.domainSize*f,s[12][0].p+5*c.domainSize*f);const U=await bi(r,s,14),z={};await async function(){z.b=[];for(let t=1;t<=9;t++)z.b[t]=l.Fr.random();[p,_,m]=await async function(){let t=new pe(c.domainSize*f),e=new pe(c.domainSize*f),i=new pe(c.domainSize*f);const n=await bi(r,s,4),a=await bi(r,s,5),o=await bi(r,s,6);for(let r=0;r<c.nConstrains;r++){const s=M(n,4*r);t.set(Q(s),r*f);const c=M(a,4*r);e.set(Q(c),r*f);const l=M(o,4*r);i.set(Q(l),r*f)}return t=await u.batchToMontgomery(t),e=await u.batchToMontgomery(e),i=await u.batchToMontgomery(i),[t,e,i]}(),[I,w]=await D(p,[z.b[2],z.b[1]]),[C,b]=await D(_,[z.b[4],z.b[3]]),[v,y]=await D(m,[z.b[6],z.b[5]]),E.A=await N(I,"multiexp A"),E.B=await N(C,"multiexp B"),E.C=await N(v,"multiexp C")}(),await async function(){const t=new Uint8Array(c.nPublic*f+2*d.F.n8*3);for(let e=0;e<c.nPublic;e++)u.toRprBE(t,e*f,p.slice(e*f,(e+1)*f));d.toRprUncompressed(t,c.nPublic*f+0,E.A),d.toRprUncompressed(t,c.nPublic*f+2*d.F.n8,E.B),d.toRprUncompressed(t,c.nPublic*f+4*d.F.n8,E.C),z.beta=T(t),i&&i.debug("beta: "+u.toString(z.beta));const e=new Uint8Array(f);u.toRprBE(e,0,z.beta),z.gamma=T(e),i&&i.debug("gamma: "+u.toString(z.gamma));let n=new pe(u.n8*c.domainSize),a=new pe(u.n8*c.domainSize);n.set(u.one,0),a.set(u.one,0);let o=u.one;for(let t=0;t<c.domainSize;t++){let e=p.slice(t*f,(t+1)*f);e=u.add(e,u.mul(z.beta,o)),e=u.add(e,z.gamma);let i=_.slice(t*f,(t+1)*f);i=u.add(i,u.mul(c.k1,u.mul(z.beta,o))),i=u.add(i,z.gamma);let r=m.slice(t*f,(t+1)*f);r=u.add(r,u.mul(c.k2,u.mul(z.beta,o))),r=u.add(r,z.gamma);const s=u.mul(e,u.mul(i,r));let l=p.slice(t*f,(t+1)*f);l=u.add(l,u.mul(S.slice(t*f*4,t*f*4+f),z.beta)),l=u.add(l,z.gamma);let d=_.slice(t*f,(t+1)*f);d=u.add(d,u.mul(S.slice(4*(c.domainSize+t)*f,4*(c.domainSize+t)*f+f),z.beta)),d=u.add(d,z.gamma);let h=m.slice(t*f,(t+1)*f);h=u.add(h,u.mul(S.slice(4*(2*c.domainSize+t)*f,4*(2*c.domainSize+t)*f+f),z.beta)),h=u.add(h,z.gamma);const g=u.mul(l,u.mul(d,h));n.set(u.mul(n.slice(t*f,(t+1)*f),s),(t+1)%c.domainSize*f),a.set(u.mul(a.slice(t*f,(t+1)*f),g),(t+1)%c.domainSize*f),o=u.mul(o,u.w[c.power])}a=await u.batchInverse(a);for(let t=0;t<c.domainSize;t++)n.set(u.mul(n.slice(t*f,(t+1)*f),a.slice(t*f,(t+1)*f)),t*f);if(!u.eq(n.slice(0,f),u.one))throw new Error("Copy constraints does not match");L=n,[F,A]=await D(L,[z.b[9],z.b[8],z.b[7]]),E.Z=await N(F,"multiexp Z")}(),await async function(){i&&i.debug("phse3: Reading QM4");const t=new pe(4*c.domainSize*f);await r.readToBuffer(t,0,c.domainSize*f*4,s[7][0].p+c.domainSize*f),i&&i.debug("phse3: Reading QL4");const e=new pe(4*c.domainSize*f);await r.readToBuffer(e,0,c.domainSize*f*4,s[8][0].p+c.domainSize*f),i&&i.debug("phse3: Reading QR4");const n=new pe(4*c.domainSize*f);await r.readToBuffer(n,0,c.domainSize*f*4,s[9][0].p+c.domainSize*f),i&&i.debug("phse3: Reading QO4");const a=new pe(4*c.domainSize*f);await r.readToBuffer(a,0,c.domainSize*f*4,s[10][0].p+c.domainSize*f),i&&i.debug("phse3: Reading QC4");const o=new pe(4*c.domainSize*f);await r.readToBuffer(o,0,c.domainSize*f*4,s[11][0].p+c.domainSize*f);const l=await bi(r,s,13),h=new Uint8Array(2*d.F.n8);d.toRprUncompressed(h,0,E.Z),z.alpha=T(h),i&&i.debug("alpha: "+u.toString(z.alpha));const g=[u.zero,u.add(u.e(-1),u.w[2]),u.e(-2),u.sub(u.e(-1),u.w[2])],_=[u.zero,u.add(u.zero,u.mul(u.e(-2),u.w[2])),u.e(4),u.sub(u.zero,u.mul(u.e(-2),u.w[2]))],m=[u.zero,u.add(u.e(2),u.mul(u.e(2),u.w[2])),u.e(-8),u.sub(u.e(2),u.mul(u.e(2),u.w[2]))],L=new pe(4*c.domainSize*f),I=new pe(4*c.domainSize*f);let C=u.one;for(let r=0;r<4*c.domainSize;r++){r%4096==0&&i&&i.debug(`calculating t ${r}/${4*c.domainSize}`);const s=w.slice(r*f,r*f+f),d=b.slice(r*f,r*f+f),h=y.slice(r*f,r*f+f),g=A.slice(r*f,r*f+f),_=A.slice((r+4*c.domainSize+4)%(4*c.domainSize)*f,(r+4*c.domainSize+4)%(4*c.domainSize)*f+f),m=t.slice(r*f,r*f+f),v=e.slice(r*f,r*f+f),F=n.slice(r*f,r*f+f),x=a.slice(r*f,r*f+f),E=o.slice(r*f,r*f+f),q=S.slice(r*f,r*f+f),G=S.slice((r+4*c.domainSize)*f,(r+4*c.domainSize)*f+f),U=S.slice((r+8*c.domainSize)*f,(r+8*c.domainSize)*f+f),P=u.add(z.b[2],u.mul(z.b[1],C)),M=u.add(z.b[4],u.mul(z.b[3],C)),Q=u.add(z.b[6],u.mul(z.b[5],C)),T=u.square(C),R=u.add(u.add(u.mul(z.b[7],T),u.mul(z.b[8],C)),z.b[9]),k=u.mul(C,u.w[c.power]),N=u.square(k),D=u.add(u.add(u.mul(z.b[7],N),u.mul(z.b[8],k)),z.b[9]);let j=u.zero;for(let t=0;t<c.nPublic;t++)j=u.sub(j,u.mul(l.slice((5*t*c.domainSize+c.domainSize+r)*f,(5*t*c.domainSize+c.domainSize+r+1)*f),p.slice(t*f,(t+1)*f)));let[V,K]=B(s,d,P,M,r%4);V=u.mul(V,m),K=u.mul(K,m),V=u.add(V,u.mul(s,v)),K=u.add(K,u.mul(P,v)),V=u.add(V,u.mul(d,F)),K=u.add(K,u.mul(M,F)),V=u.add(V,u.mul(h,x)),K=u.add(K,u.mul(Q,x)),V=u.add(V,j),V=u.add(V,E);const $=u.mul(z.beta,C);let H=s;H=u.add(H,$),H=u.add(H,z.gamma);let Z=d;Z=u.add(Z,u.mul($,c.k1)),Z=u.add(Z,z.gamma);let J=h;J=u.add(J,u.mul($,c.k2)),J=u.add(J,z.gamma);let Y=g,[W,X]=O(H,Z,J,Y,P,M,Q,R,r%4);W=u.mul(W,z.alpha),X=u.mul(X,z.alpha);let tt=s;tt=u.add(tt,u.mul(z.beta,q)),tt=u.add(tt,z.gamma);let et=d;et=u.add(et,u.mul(z.beta,G)),et=u.add(et,z.gamma);let it=h;it=u.add(it,u.mul(z.beta,U)),it=u.add(it,z.gamma);let nt=_,[at,ot]=O(tt,et,it,nt,P,M,Q,D,r%4);at=u.mul(at,z.alpha),ot=u.mul(ot,z.alpha);let rt=u.sub(g,u.one);rt=u.mul(rt,l.slice((c.domainSize+r)*f,(c.domainSize+r+1)*f)),rt=u.mul(rt,u.mul(z.alpha,z.alpha));let st=u.mul(R,l.slice((c.domainSize+r)*f,(c.domainSize+r+1)*f));st=u.mul(st,u.mul(z.alpha,z.alpha));let ct=u.add(u.sub(u.add(V,W),at),rt),lt=u.add(u.sub(u.add(K,X),ot),st);L.set(ct,r*f),I.set(lt,r*f),C=u.mul(C,u.w[c.power+2])}i&&i.debug("ifft T");let v=await u.ifft(L);i&&i.debug("dividing T/Z");for(let t=0;t<c.domainSize;t++)v.set(u.neg(v.slice(t*f,t*f+f)),t*f);for(let t=c.domainSize;t<4*c.domainSize;t++){const e=u.sub(v.slice((t-c.domainSize)*f,(t-c.domainSize)*f+f),v.slice(t*f,t*f+f));if(v.set(e,t*f),t>3*c.domainSize-4&&!u.isZero(e))throw new Error("T Polynomial is not divisible")}i&&i.debug("ifft Tz");const F=await u.ifft(I);for(let t=0;t<4*c.domainSize;t++){const e=F.slice(t*f,(t+1)*f);if(t>3*c.domainSize+5){if(!u.isZero(e))throw new Error("Tz Polynomial is not well calculated")}else v.set(u.add(v.slice(t*f,(t+1)*f),e),t*f)}function B(t,e,i,n,a){let o,r;const s=u.mul(t,e),c=u.mul(t,n),l=u.mul(i,e);o=s;let d=u.mul(i,n);return r=u.add(c,l),a&&(r=u.add(r,u.mul(g[a],d))),[o,r]}function O(t,e,i,n,a,o,r,s,c){let l,d;const f=u.mul(t,e),h=u.mul(t,o),p=u.mul(a,e),L=u.mul(a,o),w=u.mul(i,n),b=u.mul(i,s),y=u.mul(r,n),A=u.mul(r,s);l=u.mul(f,w);let I=u.mul(p,w);I=u.add(I,u.mul(h,w)),I=u.add(I,u.mul(f,y)),I=u.add(I,u.mul(f,b));let C=u.mul(L,w);C=u.add(C,u.mul(p,y)),C=u.add(C,u.mul(p,b)),C=u.add(C,u.mul(h,y)),C=u.add(C,u.mul(h,b)),C=u.add(C,u.mul(f,A));let v=u.mul(h,A);v=u.add(v,u.mul(p,A)),v=u.add(v,u.mul(L,b)),v=u.add(v,u.mul(L,y));let F=u.mul(L,A);return d=I,c&&(d=u.add(d,u.mul(g[c],C)),d=u.add(d,u.mul(_[c],v)),d=u.add(d,u.mul(m[c],F))),[l,d]}x=v.slice(0,(3*c.domainSize+6)*f),E.T1=await N(v.slice(0,c.domainSize*f),"multiexp T1"),E.T2=await N(v.slice(c.domainSize*f,2*c.domainSize*f),"multiexp T2"),E.T3=await N(v.slice(2*c.domainSize*f,(3*c.domainSize+6)*f),"multiexp T3")}(),await async function(){const t=new pe(c.domainSize*f);await r.readToBuffer(t,0,c.domainSize*f,s[7][0].p);const e=new pe(c.domainSize*f);await r.readToBuffer(e,0,c.domainSize*f,s[8][0].p);const n=new pe(c.domainSize*f);await r.readToBuffer(n,0,c.domainSize*f,s[9][0].p);const a=new pe(c.domainSize*f);await r.readToBuffer(a,0,c.domainSize*f,s[10][0].p);const o=new pe(c.domainSize*f);await r.readToBuffer(o,0,c.domainSize*f,s[11][0].p);const l=new pe(c.domainSize*f);await r.readToBuffer(l,0,c.domainSize*f,s[12][0].p+10*c.domainSize*f);const h=new Uint8Array(2*d.F.n8*3);d.toRprUncompressed(h,0,E.T1),d.toRprUncompressed(h,2*d.F.n8,E.T2),d.toRprUncompressed(h,4*d.F.n8,E.T3),z.xi=T(h),i&&i.debug("xi: "+u.toString(z.xi));E.eval_a=R(I,z.xi),E.eval_b=R(C,z.xi),E.eval_c=R(v,z.xi),E.eval_s1=R(q,z.xi),E.eval_s2=R(G,z.xi),E.eval_t=R(x,z.xi),E.eval_zw=R(F,u.mul(z.xi,u.w[c.power]));const g=u.mul(E.eval_a,E.eval_b);let p=E.eval_a;const _=u.mul(z.beta,z.xi);p=u.add(p,_),p=u.add(p,z.gamma);let m=E.eval_b;m=u.add(m,u.mul(_,c.k1)),m=u.add(m,z.gamma);let L=E.eval_c;L=u.add(L,u.mul(_,c.k2)),L=u.add(L,z.gamma);const w=u.mul(u.mul(u.mul(p,m),L),z.alpha);let b=E.eval_a;b=u.add(b,u.mul(z.beta,E.eval_s1)),b=u.add(b,z.gamma);let y=E.eval_b;y=u.add(y,u.mul(z.beta,E.eval_s2)),y=u.add(y,z.gamma);let A=u.mul(b,y);A=u.mul(A,z.beta),A=u.mul(A,E.eval_zw),A=u.mul(A,z.alpha),z.xim=z.xi;for(let t=0;t<c.power;t++)z.xim=u.mul(z.xim,z.xim);const S=u.div(u.sub(z.xim,u.one),u.mul(u.sub(z.xi,u.one),u.e(c.domainSize))),O=u.mul(S,u.mul(z.alpha,z.alpha)),U=A,P=u.add(w,O);B=new pe((c.domainSize+3)*f);for(let i=0;i<c.domainSize+3;i++){let r=u.mul(P,F.slice(i*f,(i+1)*f));i<c.domainSize&&(r=u.add(r,u.mul(g,t.slice(i*f,(i+1)*f))),r=u.add(r,u.mul(E.eval_a,e.slice(i*f,(i+1)*f))),r=u.add(r,u.mul(E.eval_b,n.slice(i*f,(i+1)*f))),r=u.add(r,u.mul(E.eval_c,a.slice(i*f,(i+1)*f))),r=u.add(r,o.slice(i*f,(i+1)*f)),r=u.sub(r,u.mul(U,l.slice(i*f,(i+1)*f)))),B.set(r,i*f)}E.eval_r=R(B,z.xi)}(),await async function(){const t=new Uint8Array(7*f);u.toRprBE(t,0,E.eval_a),u.toRprBE(t,f,E.eval_b),u.toRprBE(t,2*f,E.eval_c),u.toRprBE(t,3*f,E.eval_s1),u.toRprBE(t,4*f,E.eval_s2),u.toRprBE(t,5*f,E.eval_zw),u.toRprBE(t,6*f,E.eval_r),z.v=[],z.v[1]=T(t),i&&i.debug("v: "+u.toString(z.v[1]));for(let t=2;t<=6;t++)z.v[t]=u.mul(z.v[t-1],z.v[1]);let e=new pe((c.domainSize+6)*f);const n=u.mul(z.xim,z.xim);for(let t=0;t<c.domainSize+6;t++){let i=u.zero;i=u.add(i,u.mul(n,x.slice((2*c.domainSize+t)*f,(2*c.domainSize+t+1)*f))),t<c.domainSize+3&&(i=u.add(i,u.mul(z.v[1],B.slice(t*f,(t+1)*f)))),t<c.domainSize+2&&(i=u.add(i,u.mul(z.v[2],I.slice(t*f,(t+1)*f))),i=u.add(i,u.mul(z.v[3],C.slice(t*f,(t+1)*f))),i=u.add(i,u.mul(z.v[4],v.slice(t*f,(t+1)*f)))),t<c.domainSize&&(i=u.add(i,x.slice(t*f,(t+1)*f)),i=u.add(i,u.mul(z.xim,x.slice((c.domainSize+t)*f,(c.domainSize+t+1)*f))),i=u.add(i,u.mul(z.v[5],q.slice(t*f,(t+1)*f))),i=u.add(i,u.mul(z.v[6],G.slice(t*f,(t+1)*f)))),e.set(i,t*f)}let a=e.slice(0,f);a=u.sub(a,E.eval_t),a=u.sub(a,u.mul(z.v[1],E.eval_r)),a=u.sub(a,u.mul(z.v[2],E.eval_a)),a=u.sub(a,u.mul(z.v[3],E.eval_b)),a=u.sub(a,u.mul(z.v[4],E.eval_c)),a=u.sub(a,u.mul(z.v[5],E.eval_s1)),a=u.sub(a,u.mul(z.v[6],E.eval_s2)),e.set(a,0),e=k(e,z.xi),E.Wxi=await N(e,"multiexp Wxi");let o=new pe((c.domainSize+3)*f);for(let t=0;t<c.domainSize+3;t++){const e=F.slice(t*f,(t+1)*f);o.set(e,t*f)}a=o.slice(0,f),a=u.sub(a,E.eval_zw),o.set(a,0),o=k(o,u.mul(z.xi,u.w[c.power])),E.Wxiw=await N(o,"multiexp Wxiw")}(),E.protocol="plonk",E.curve=l.name,await r.close(),await n.close();let P=[];for(let t=1;t<=c.nPublic;t++){const e=h.slice(t*u.n8,t*u.n8+u.n8);P.push($e.fromRprLE(e))}return E.A=d.toObject(E.A),E.B=d.toObject(E.B),E.C=d.toObject(E.C),E.Z=d.toObject(E.Z),E.T1=d.toObject(E.T1),E.T2=d.toObject(E.T2),E.T3=d.toObject(E.T3),E.eval_a=u.toObject(E.eval_a),E.eval_b=u.toObject(E.eval_b),E.eval_c=u.toObject(E.eval_c),E.eval_s1=u.toObject(E.eval_s1),E.eval_s2=u.toObject(E.eval_s2),E.eval_zw=u.toObject(E.eval_zw),E.eval_t=u.toObject(E.eval_t),E.eval_r=u.toObject(E.eval_r),E.Wxi=d.toObject(E.Wxi),E.Wxiw=d.toObject(E.Wxiw),delete E.eval_t,E=Js(E),P=Js(P),{proof:E,publicSignals:P};function M(t,e){const i=t.slice(e,e+4);return new DataView(i.buffer,i.byteOffset,i.byteLength).getUint32(0,!0)}function Q(t){return t<c.nVars-c.nAdditions?h.slice(t*f,t*f+f):t<c.nVars?g.slice((t-(c.nVars-c.nAdditions))*f,(t-(c.nVars-c.nAdditions))*f+f):l.Fr.zero}function T(t){const e=$e.fromRprBE(new Uint8Array(Ys.arrayBuffer(t)));return u.e(e)}function R(t,e){const i=t.byteLength/f;if(0==i)return u.zero;let n=t.slice((i-1)*f,i*f);for(let a=i-2;a>=0;a--)n=u.add(u.mul(n,e),t.slice(a*f,(a+1)*f));return n}function k(t,e){const i=t.byteLength/f,n=new pe(i*f);n.set(u.zero,(i-1)*f),n.set(t.slice((i-1)*f,i*f),(i-2)*f);for(let a=i-3;a>=0;a--)n.set(u.add(t.slice((a+1)*f,(a+2)*f),u.mul(e,n.slice((a+1)*f,(a+2)*f))),a*f);if(!u.eq(t.slice(0,f),u.mul(u.neg(e),n.slice(0,f))))throw new Error("Polinomial does not divide");return n}async function N(t,e){const n=t.byteLength/f,a=U.slice(0,n*l.G1.F.n8*2),o=await l.Fr.batchFromMontgomery(t);let r=await l.G1.multiExpAffine(a,o,i,e);return r=l.G1.toAffine(r),r}async function D(t,e){e=e||[];let i=await u.ifft(t);const n=new pe(f*c.domainSize*4);n.set(i,0);const a=new pe(f*(c.domainSize+e.length));a.set(i,0);for(let t=0;t<e.length;t++)a.set(u.add(a.slice((c.domainSize+t)*f,(c.domainSize+t+1)*f),e[t]),(c.domainSize+t)*f),a.set(u.sub(a.slice(t*f,(t+1)*f),e[t]),t*f);return[a,await u.fft(n)]}}const{unstringifyBigInts:Xs}=He;const{unstringifyBigInts:tc}=He,{keccak256:ec}=Zs;function ic(t,e){const i=$e.fromRprBE(new Uint8Array(ec.arrayBuffer(e)));return t.Fr.e(i)}const{unstringifyBigInts:nc}=He;function ac(t){return("0"+t.toString(16)).slice(-2)}function oc(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var rc=Object.freeze({__proto__:null,setup:async function(t,e,i,n){globalThis.gc&&globalThis.gc(),await tn.ready();const{fd:a,sections:o}=await di(e,"ptau",1),{curve:r,power:s}=await go(a,o),{fd:c,sections:l}=await di(t,"r1cs",1),u=await Es(c,l,!1),d=2*r.G1.F.n8,f=r.G1,h=2*r.G2.F.n8,g=r.Fr,p=r.Fr.n8;n&&n.info("Reading r1cs");let _=await bi(c,l,2);const m=new ks,L=new ks;let w=u.nVars;const b=u.nOutputs+u.nPubInputs;await async function(){let t=0;function e(){const e=_.slice(t,t+4);t+=4;return new DataView(e.buffer).getUint32(0,!0)}function i(){const e=g.fromRprLE(_.slice(t,t+r.Fr.n8));return t+=r.Fr.n8,e}function a(){const t=[],n={k:r.Fr.zero},a=e();for(let o=0;o<a;o++){const a=e(),o=i();0==a?n.k=o:t.push([a,o])}const s=o(t);return n.s=s[0],n.coef=s[1],n}function o(t){if(0==t.length)return[0,r.Fr.zero];if(1==t.length)return t[0];const e=t.slice(0,t.length>>1),i=t.slice(t.length>>1),n=o(e),a=o(i),s=n[0],c=a[0],l=w++,u=r.Fr.zero,d=g.neg(n[1]),f=g.neg(a[1]),h=r.Fr.one,p=r.Fr.zero;return m.push([s,c,l,u,d,f,h,p]),L.push([s,c,n[1],a[1]]),[l,r.Fr.one]}for(let t=1;t<=b;t++){const e=t,i=0,n=0,a=r.Fr.zero,o=r.Fr.one,s=r.Fr.zero,c=r.Fr.zero,l=r.Fr.zero;m.push([e,i,n,a,o,s,c,l])}for(let t=0;t<u.nConstraints;t++){n&&t%1e4==0&&n.debug(`processing constraints: ${t}/${u.nConstraints}`);const e=a(),i=a(),o=a(),s=e.s,c=i.s,l=o.s,d=r.Fr.mul(e.coef,i.coef),f=r.Fr.mul(e.coef,i.k),h=r.Fr.mul(e.k,i.coef),g=r.Fr.neg(o.coef),p=r.Fr.sub(r.Fr.mul(e.k,i.k),o.k);m.push([s,c,l,d,f,h,g,p])}}(),globalThis.gc&&globalThis.gc();const y=await fi(i,"zkey",1,14,1<<22,1<<24);if(u.prime!=r.r)return n&&n.error("r1cs curve does not match powers of tau ceremony curve"),-1;let A=en(m.length-1)+1;A<3&&(A=3);const I=2**A;if(n&&n.info("Plonk constraints: "+m.length),A>s)return n&&n.error(`circuit too big for this power of tau ceremony. ${m.length} > 2**${s}`),-1;if(!o[12])return n&&n.error("Powers of tau is not prepared."),-1;const C=new pe(I*d),v=o[12][0].p+(2**A-1)*d;await a.readToBuffer(C,0,I*d,v);const[F,x]=function(){let t=g.two;for(;i(t,[],A);)g.add(t,g.one);let e=g.add(t,g.one);for(;i(e,[t],A);)g.add(e,g.one);return[t,e];function i(t,e,i){const n=2**i;let a=g.one;for(let o=0;o<n;o++){if(g.eq(t,a))return!0;for(let i=0;i<e.length;i++)if(g.eq(t,g.mul(e[i],a)))return!0;a=g.mul(a,g.w[i])}return!1}}(),B={};await async function(t,e){await hi(y,t);const i=new Uint8Array(8+2*p),a=new DataView(i.buffer);for(let t=0;t<L.length;t++){const o=L[t];let r=0;a.setUint32(r,o[0],!0),r+=4,a.setUint32(r,o[1],!0),r+=4,i.set(o[2],r),r+=p,i.set(o[3],r),r+=p,await y.write(i),n&&t%1e6==0&&n.debug(`writing ${e}: ${t}/${L.length}`)}await gi(y)}(3,"Additions"),globalThis.gc&&globalThis.gc(),await S(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await S(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await S(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await O(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await O(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await O(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await O(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await O(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await async function(t,e){const i=new pe(p*I*3),a=new ks(w),o=new ks(w);let s=g.one;for(let t=0;t<I;t++)t<m.length?(d(m[t][0],t),d(m[t][1],I+t),d(m[t][2],2*I+t)):(d(0,t),d(0,I+t),d(0,2*I+t)),s=g.mul(s,g.w[A]),n&&t%1e6==0&&n.debug(`writing ${e} phase1: ${t}/${m.length}`);for(let t=0;t<w;t++)void 0!==o[t]?i.set(a[t],o[t]*p):console.log("Variable not used"),n&&t%1e6==0&&n.debug(`writing ${e} phase2: ${t}/${w}`);globalThis.gc&&globalThis.gc();await hi(y,t);let c=i.slice(0,I*p);await q(c),globalThis.gc&&globalThis.gc();let l=i.slice(I*p,I*p*2);await q(l),globalThis.gc&&globalThis.gc();let u=i.slice(I*p*2,I*p*3);await q(u),globalThis.gc&&globalThis.gc();await gi(y),c=await g.batchFromMontgomery(c),l=await g.batchFromMontgomery(l),u=await g.batchFromMontgomery(u),B.S1=await r.G1.multiExpAffine(C,c,n,"multiexp S1"),globalThis.gc&&globalThis.gc();B.S2=await r.G1.multiExpAffine(C,l,n,"multiexp S2"),globalThis.gc&&globalThis.gc();B.S3=await r.G1.multiExpAffine(C,u,n,"multiexp S3"),globalThis.gc&&globalThis.gc();function d(t,e){let n;void 0===a[t]?o[t]=e:i.set(a[t],e*p),n=e<I?s:e<2*I?g.mul(s,F):g.mul(s,x),a[t]=n}}(12,"sigma"),globalThis.gc&&globalThis.gc(),await async function(t,e){await hi(y,t);const i=Math.max(b,1);for(let t=0;t<i;t++){let a=new pe(I*p);a.set(g.one,t*p),await q(a),n&&n.debug(`writing ${e} ${t}/${i}`)}await gi(y)}(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await hi(y,14);const E=new pe((I+6)*d);return await a.readToBuffer(E,0,(I+6)*d,o[2][0].p),await y.write(E),await gi(y),globalThis.gc&&globalThis.gc(),await async function(){await hi(y,1),await y.writeULE32(2),await gi(y),await hi(y,2);const t=r.q,e=8*(Math.floor(($e.bitLength(t)-1)/64)+1),i=r.r,n=8*(Math.floor(($e.bitLength(i)-1)/64)+1);let s;await y.writeULE32(e),await mi(y,t,e),await y.writeULE32(n),await mi(y,i,n),await y.writeULE32(w),await y.writeULE32(b),await y.writeULE32(I),await y.writeULE32(L.length),await y.writeULE32(m.length),await y.write(F),await y.write(x),await y.write(f.toAffine(B.Qm)),await y.write(f.toAffine(B.Ql)),await y.write(f.toAffine(B.Qr)),await y.write(f.toAffine(B.Qo)),await y.write(f.toAffine(B.Qc)),await y.write(f.toAffine(B.S1)),await y.write(f.toAffine(B.S2)),await y.write(f.toAffine(B.S3)),s=await a.read(h,o[3][0].p+h),await y.write(s),await gi(y)}(),await y.close(),await c.close(),await a.close(),void(n&&n.info("Setup Finished"));async function S(t,e,i){await hi(y,t);for(let t=0;t<m.length;t++)await y.writeULE32(m[t][e]),n&&t%1e6==0&&n.debug(`writing ${i}: ${t}/${m.length}`);await gi(y)}async function O(t,e,i){let a=new pe(I*p);for(let t=0;t<m.length;t++)a.set(m[t][e],t*p),n&&t%1e6==0&&n.debug(`writing ${i}: ${t}/${m.length}`);await hi(y,t),await q(a),await gi(y),a=await g.batchFromMontgomery(a),B[i]=await r.G1.multiExpAffine(C,a,n,"multiexp "+i)}async function q(t){const e=await g.ifft(t),i=new pe(I*p*4);i.set(e,0);const n=await g.fft(i);await y.write(e),await y.write(n)}},fullProve:async function(t,e,i,n){const a=Xs(t),o={type:"mem"};return await io(a,e,o),await Ws(i,o,n)},prove:Ws,verify:async function(t,e,i,n){let a=tc(t),o=tc(i),r=tc(e);const s=await vi(a.curve),c=s.Fr,l=s.G1;if(o=function(t,e){const i=t.G1,n=t.Fr,a={};return a.A=i.fromObject(e.A),a.B=i.fromObject(e.B),a.C=i.fromObject(e.C),a.Z=i.fromObject(e.Z),a.T1=i.fromObject(e.T1),a.T2=i.fromObject(e.T2),a.T3=i.fromObject(e.T3),a.eval_a=n.fromObject(e.eval_a),a.eval_b=n.fromObject(e.eval_b),a.eval_c=n.fromObject(e.eval_c),a.eval_zw=n.fromObject(e.eval_zw),a.eval_s1=n.fromObject(e.eval_s1),a.eval_s2=n.fromObject(e.eval_s2),a.eval_r=n.fromObject(e.eval_r),a.Wxi=i.fromObject(e.Wxi),a.Wxiw=i.fromObject(e.Wxiw),a}(s,o),a=function(t,e){const i=t.G1,n=t.G2,a=t.Fr,o=e;return o.Qm=i.fromObject(e.Qm),o.Ql=i.fromObject(e.Ql),o.Qr=i.fromObject(e.Qr),o.Qo=i.fromObject(e.Qo),o.Qc=i.fromObject(e.Qc),o.S1=i.fromObject(e.S1),o.S2=i.fromObject(e.S2),o.S3=i.fromObject(e.S3),o.k1=a.fromObject(e.k1),o.k2=a.fromObject(e.k2),o.X_2=n.fromObject(e.X_2),o}(s,a),!function(t,e){const i=t.G1;return!!i.isValid(e.A)&&(!!i.isValid(e.B)&&(!!i.isValid(e.C)&&(!!i.isValid(e.Z)&&(!!i.isValid(e.T1)&&(!!i.isValid(e.T2)&&(!!i.isValid(e.T3)&&(!!i.isValid(e.Wxi)&&!!i.isValid(e.Wxiw))))))))}(s,o))return n.error("Proof is not well constructed"),!1;if(r.length!=a.nPublic)return n.error("Invalid number of public inputs"),!1;const u=function(t,e,i){const n=t.G1,a=t.Fr,o=t.Fr.n8,r={},s=new Uint8Array(i.length*o+2*n.F.n8*3);for(let t=0;t<i.length;t++)a.toRprBE(s,t*o,a.e(i[t]));n.toRprUncompressed(s,i.length*o+0,e.A),n.toRprUncompressed(s,i.length*o+2*n.F.n8,e.B),n.toRprUncompressed(s,i.length*o+4*n.F.n8,e.C),r.beta=ic(t,s);const c=new Uint8Array(o);a.toRprBE(c,0,r.beta),r.gamma=ic(t,c);const l=new Uint8Array(2*n.F.n8);n.toRprUncompressed(l,0,e.Z),r.alpha=ic(t,l);const u=new Uint8Array(2*n.F.n8*3);n.toRprUncompressed(u,0,e.T1),n.toRprUncompressed(u,2*n.F.n8,e.T2),n.toRprUncompressed(u,4*n.F.n8,e.T3),r.xi=ic(t,u);const d=new Uint8Array(7*o);a.toRprBE(d,0,e.eval_a),a.toRprBE(d,o,e.eval_b),a.toRprBE(d,2*o,e.eval_c),a.toRprBE(d,3*o,e.eval_s1),a.toRprBE(d,4*o,e.eval_s2),a.toRprBE(d,5*o,e.eval_zw),a.toRprBE(d,6*o,e.eval_r),r.v=[],r.v[1]=ic(t,d);for(let t=2;t<=6;t++)r.v[t]=a.mul(r.v[t-1],r.v[1]);const f=new Uint8Array(2*n.F.n8*2);return n.toRprUncompressed(f,0,e.Wxi),n.toRprUncompressed(f,2*n.F.n8,e.Wxiw),r.u=ic(t,f),r}(s,o,r);n&&(n.debug("beta: "+c.toString(u.beta,16)),n.debug("gamma: "+c.toString(u.gamma,16)),n.debug("alpha: "+c.toString(u.alpha,16)),n.debug("xi: "+c.toString(u.xi,16)),n.debug("v1: "+c.toString(u.v[1],16)),n.debug("v6: "+c.toString(u.v[6],16)),n.debug("u: "+c.toString(u.u,16)));const d=function(t,e,i){const n=t.Fr;let a=e.xi,o=1;for(let t=0;t<i.power;t++)a=n.square(a),o*=2;e.xin=a,e.zh=n.sub(a,n.one);const r=[],s=n.e(o);let c=n.one;for(let t=1;t<=Math.max(1,i.nPublic);t++)r[t]=n.div(n.mul(c,e.zh),n.mul(s,n.sub(e.xi,c))),c=n.mul(c,n.w[i.power]);return r}(s,u,a);if(n){n.debug("Lagrange Evaluations: ");for(let t=1;t<d.length;t++)n.debug(`L${t}(xi)=`+c.toString(d[t],16))}if(r.length!=a.nPublic)return n.error("Number of public signals does not match with vk"),!1;const f=function(t,e,i){const n=t.Fr;let a=n.zero;for(let t=0;t<e.length;t++){const o=n.e(e[t]);a=n.sub(a,n.mul(o,i[t+1]))}return a}(s,r,d);n&&n.debug("Pl: "+c.toString(f,16));const h=function(t,e,i,n,a){const o=t.Fr;let r=e.eval_r;r=o.add(r,n);let s=e.eval_a;s=o.add(s,o.mul(i.beta,e.eval_s1)),s=o.add(s,i.gamma);let c=e.eval_b;c=o.add(c,o.mul(i.beta,e.eval_s2)),c=o.add(c,i.gamma);let l=e.eval_c;l=o.add(l,i.gamma);let u=o.mul(o.mul(s,c),l);u=o.mul(u,e.eval_zw),u=o.mul(u,i.alpha),r=o.sub(r,u),r=o.sub(r,o.mul(a,o.square(i.alpha)));return o.div(r,i.zh)}(s,o,u,f,d[1]);n&&n.debug("t: "+c.toString(h,16));const g=function(t,e,i,n,a){const o=t.G1,r=t.Fr;let s=r.mul(r.mul(e.eval_a,e.eval_b),i.v[1]),c=o.timesFr(n.Qm,s),l=r.mul(e.eval_a,i.v[1]);c=o.add(c,o.timesFr(n.Ql,l));let u=r.mul(e.eval_b,i.v[1]);c=o.add(c,o.timesFr(n.Qr,u));let d=r.mul(e.eval_c,i.v[1]);c=o.add(c,o.timesFr(n.Qo,d)),c=o.add(c,o.timesFr(n.Qc,i.v[1]));const f=r.mul(i.beta,i.xi);let h=e.eval_a;h=r.add(h,f),h=r.add(h,i.gamma);let g=e.eval_b;g=r.add(g,r.mul(f,n.k1)),g=r.add(g,i.gamma);let p=e.eval_c;p=r.add(p,r.mul(f,n.k2)),p=r.add(p,i.gamma);let _=r.mul(r.mul(h,g),p);_=r.mul(_,r.mul(i.alpha,i.v[1]));let m=r.mul(r.mul(a,r.square(i.alpha)),i.v[1]);_=r.add(_,m),_=r.add(_,i.u),c=o.add(c,o.timesFr(e.Z,_));let L=e.eval_a;L=r.add(L,r.mul(i.beta,e.eval_s1)),L=r.add(L,i.gamma);let w=e.eval_b;w=r.add(w,r.mul(i.beta,e.eval_s2)),w=r.add(w,i.gamma);let b=r.mul(L,w);return b=r.mul(b,i.alpha),b=r.mul(b,i.v[1]),b=r.mul(b,i.beta),b=r.mul(b,e.eval_zw),c=o.sub(c,o.timesFr(n.S3,b)),c}(s,o,u,a,d[1]);n&&n.debug("D: "+l.toString(l.toAffine(g),16));const p=function(t,e,i,n,a){const o=t.G1,r=t.Fr;let s=e.T1;return s=o.add(s,o.timesFr(e.T2,i.xin)),s=o.add(s,o.timesFr(e.T3,r.square(i.xin))),s=o.add(s,a),s=o.add(s,o.timesFr(e.A,i.v[2])),s=o.add(s,o.timesFr(e.B,i.v[3])),s=o.add(s,o.timesFr(e.C,i.v[4])),s=o.add(s,o.timesFr(n.S1,i.v[5])),s=o.add(s,o.timesFr(n.S2,i.v[6])),s}(s,o,u,a,g);n&&n.debug("F: "+l.toString(l.toAffine(p),16));const _=function(t,e,i,n,a){const o=t.G1,r=t.Fr;let s=a;s=r.add(s,r.mul(i.v[1],e.eval_r)),s=r.add(s,r.mul(i.v[2],e.eval_a)),s=r.add(s,r.mul(i.v[3],e.eval_b)),s=r.add(s,r.mul(i.v[4],e.eval_c)),s=r.add(s,r.mul(i.v[5],e.eval_s1)),s=r.add(s,r.mul(i.v[6],e.eval_s2)),s=r.add(s,r.mul(i.u,e.eval_zw));return o.timesFr(o.one,s)}(s,o,u,0,h);n&&n.debug("E: "+l.toString(l.toAffine(_),16));const m=await async function(t,e,i,n,a,o){const r=t.G1,s=t.Fr;let c=e.Wxi;c=r.add(c,r.timesFr(e.Wxiw,i.u));let l=r.timesFr(e.Wxi,i.xi);const u=s.mul(s.mul(i.u,i.xi),s.w[n.power]);l=r.add(l,r.timesFr(e.Wxiw,u)),l=r.add(l,o),l=r.sub(l,a);return await t.pairingEq(r.neg(c),n.X_2,l,t.G2.one)}(s,o,u,a,_,p);return n&&(m?n.info("OK!"):n.warn("Invalid Proof")),m},exportSolidityCallData:async function(t,e){const i=nc(t),n=nc(e),a=await vi(i.curve),o=a.G1,r=a.Fr;let s="";for(let t=0;t<n.length;t++)""!=s&&(s+=","),s+=oc(n[t]);const c=new Uint8Array(2*o.F.n8*9+7*r.n8);return o.toRprUncompressed(c,0,o.e(i.A)),o.toRprUncompressed(c,2*o.F.n8,o.e(i.B)),o.toRprUncompressed(c,4*o.F.n8,o.e(i.C)),o.toRprUncompressed(c,6*o.F.n8,o.e(i.Z)),o.toRprUncompressed(c,8*o.F.n8,o.e(i.T1)),o.toRprUncompressed(c,10*o.F.n8,o.e(i.T2)),o.toRprUncompressed(c,12*o.F.n8,o.e(i.T3)),o.toRprUncompressed(c,14*o.F.n8,o.e(i.Wxi)),o.toRprUncompressed(c,16*o.F.n8,o.e(i.Wxiw)),r.toRprBE(c,18*o.F.n8,r.e(i.eval_a)),r.toRprBE(c,18*o.F.n8+r.n8,r.e(i.eval_b)),r.toRprBE(c,18*o.F.n8+2*r.n8,r.e(i.eval_c)),r.toRprBE(c,18*o.F.n8+3*r.n8,r.e(i.eval_s1)),r.toRprBE(c,18*o.F.n8+4*r.n8,r.e(i.eval_s2)),r.toRprBE(c,18*o.F.n8+5*r.n8,r.e(i.eval_zw)),r.toRprBE(c,18*o.F.n8+6*r.n8,r.e(i.eval_r)),"0x"+Array.from(c).map(ac).join("")+",["+s+"]"}});return t.groth16=so,t.plonk=rc,t.powersOfTau=xo,t.r1cs=Us,t.wtns=Ms,t.zKey=Hs,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
